var CardRenderHelper=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty;function r(t,e){return i.call(t,e)}function s(t){return!(t>=55296&&t<=57343)&&(!(t>=64976&&t<=65007)&&(65535!=(65535&t)&&65534!=(65535&t)&&(!(t>=0&&t<=8)&&(11!==t&&(!(t>=14&&t<=31)&&(!(t>=127&&t<=159)&&!(t>1114111)))))))}function a(t){if(t>65535){var e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}var o=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,l=new RegExp(o.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),c=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,u=n(5);var p=/[&<>"]/,h=/[&<>"]/g,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function g(t){return d[t]}var f=/[.?*+^$[\]\\(){}|-]/g;var m=n(1);e.lib={},e.lib.mdurl=n(6),e.lib.ucmicro=n(22),e.assign=function(t){return Array.prototype.slice.call(arguments,1).forEach((function(e){if(e){if("object"!=typeof e)throw new TypeError(e+"must be object");Object.keys(e).forEach((function(n){t[n]=e[n]}))}})),t},e.isString=function(t){return"[object String]"===function(t){return Object.prototype.toString.call(t)}(t)},e.has=r,e.unescapeMd=function(t){return t.indexOf("\\")<0?t:t.replace(o,"$1")},e.unescapeAll=function(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(l,(function(t,e,n){return e||function(t,e){var n=0;return r(u,e)?u[e]:35===e.charCodeAt(0)&&c.test(e)&&s(n="x"===e[1].toLowerCase()?parseInt(e.slice(2),16):parseInt(e.slice(1),10))?a(n):t}(t,n)}))},e.isValidEntityCode=s,e.fromCodePoint=a,e.escapeHtml=function(t){return p.test(t)?t.replace(h,g):t},e.arrayReplaceAt=function(t,e,n){return[].concat(t.slice(0,e),n,t.slice(e+1))},e.isSpace=function(t){switch(t){case 9:case 32:return!0}return!1},e.isWhiteSpace=function(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},e.isMdAsciiPunct=function(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},e.isPunctChar=function(t){return m.test(t)},e.escapeRE=function(t){return t.replace(f,"\\$&")},e.normalizeReference=function(t){return t.trim().replace(/\s+/g," ").toUpperCase()}},function(t,e){t.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},function(t,e,n){"use strict";function i(){this.__rules__=[],this.__cache__=null}i.prototype.__find__=function(t){for(var e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1},i.prototype.__compile__=function(){var t=this,e=[""];t.__rules__.forEach((function(t){t.enabled&&t.alt.forEach((function(t){e.indexOf(t)<0&&e.push(t)}))})),t.__cache__={},e.forEach((function(e){t.__cache__[e]=[],t.__rules__.forEach((function(n){n.enabled&&(e&&n.alt.indexOf(e)<0||t.__cache__[e].push(n.fn))}))}))},i.prototype.at=function(t,e,n){var i=this.__find__(t),r=n||{};if(-1===i)throw new Error("Parser rule not found: "+t);this.__rules__[i].fn=e,this.__rules__[i].alt=r.alt||[],this.__cache__=null},i.prototype.before=function(t,e,n,i){var r=this.__find__(t),s=i||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null},i.prototype.after=function(t,e,n,i){var r=this.__find__(t),s=i||{};if(-1===r)throw new Error("Parser rule not found: "+t);this.__rules__.splice(r+1,0,{name:e,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null},i.prototype.push=function(t,e,n){var i=n||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:i.alt||[]}),this.__cache__=null},i.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);var n=[];return t.forEach((function(t){var i=this.__find__(t);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[i].enabled=!0,n.push(t)}),this),this.__cache__=null,n},i.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach((function(t){t.enabled=!1})),this.enable(t,e)},i.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);var n=[];return t.forEach((function(t){var i=this.__find__(t);if(i<0){if(e)return;throw new Error("Rules manager: invalid rule name "+t)}this.__rules__[i].enabled=!1,n.push(t)}),this),this.__cache__=null,n},i.prototype.getRules=function(t){return null===this.__cache__&&this.__compile__(),this.__cache__[t]||[]},t.exports=i},function(t,e,n){"use strict";function i(t,e,n){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}i.prototype.attrIndex=function(t){var e,n,i;if(!this.attrs)return-1;for(n=0,i=(e=this.attrs).length;n<i;n++)if(e[n][0]===t)return n;return-1},i.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]},i.prototype.attrSet=function(t,e){var n=this.attrIndex(t),i=[t,e];n<0?this.attrPush(i):this.attrs[n]=i},i.prototype.attrGet=function(t){var e=this.attrIndex(t),n=null;return e>=0&&(n=this.attrs[e][1]),n},i.prototype.attrJoin=function(t,e){var n=this.attrIndex(t);n<0?this.attrPush([t,e]):this.attrs[n][1]=this.attrs[n][1]+" "+e},t.exports=i},function(t,e,n){window,t.exports=function(){return n={},t.m=e={"./src/adaptivecards.ts":function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n("./src/card-elements.ts")),i(n("./src/enums.ts")),i(n("./src/host-config.ts")),i(n("./src/shared.ts")),i(n("./src/utils.ts"))},"./src/card-elements.ts":function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n("./src/enums.ts"),a=n("./src/shared.ts"),o=n("./src/utils.ts"),l=n("./src/host-config.ts"),c=n("./src/text-formatters.ts");function u(t,e){t&&t.setCollection(e)}function p(t,e){if(e)for(var n=0;n<e.length;n++)if(t.getJsonTypeName()===e[n])return;return 1}function h(t,e,n,i,r){var s,a,o,l=null;return e&&"object"==typeof e&&(s=!1,(l=n(a=e.type))?(l.setParent(t),l.parse(e,r),s=l.shouldFallback()):(s=!0,ne(i(a),r)),s&&((o=e.fallback)||t.setShouldFallback(!0),"string"==typeof o&&"drop"===o.toLowerCase()?l=null:"object"==typeof o&&(l=h(t,o,n,i,r)))),l}function d(t,e,n){return h(t,e,(function(t){return fe.actionTypeRegistry.createInstance(t)}),(function(t){return{error:s.ValidationError.UnknownActionType,message:"Unknown action type: "+t+". Attempting to fall back."}}),n)}function g(t,e,n){return h(t,e,(function(t){return fe.elementTypeRegistry.createInstance(t)}),(function(t){return{error:s.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Attempting to fall back."}}),n)}e.createActionInstance=d,e.createElementInstance=g;var f=(m.prototype.internalRenderSeparator=function(){return o.renderSeparation({spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:null,lineColor:this.separator?this.hostConfig.separator.lineColor:null},this.separatorOrientation)},m.prototype.updateRenderedElementVisibility=function(){this._renderedElement&&(this._renderedElement.style.display=this._isVisible?this._defaultRenderedElementDisplayMode:"none"),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":this._separatorElement.style.display=this._isVisible?this._defaultRenderedElementDisplayMode:"none")},m.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this._isVisible&&(this._renderedElement.style.visibility="hidden",this._isVisible=!1,ee(this,!1))},m.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this._isVisible&&(this._renderedElement.style.visibility=null,this._isVisible=!0,ee(this,!1))},m.prototype.handleOverflow=function(t){var e;(this.isVisible||this.isHiddenDueToOverflow())&&(e=this.truncateOverflow(t),this._truncatedDueToOverflow=e||this._truncatedDueToOverflow,e?e&&!this._isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow())},m.prototype.resetOverflow=function(){var t=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),t=!(this._truncatedDueToOverflow=!1)),this.isHiddenDueToOverflow&&this.showElementHiddenDueToOverflow(),t},m.prototype.createPlaceholderElement=function(){var t=document.createElement("div");return t.style.border="1px dashed #DDDDDD",t.style.padding="4px",t.style.minHeight="32px",t.style.fontSize="10px",t.innerText="Empty "+this.getJsonTypeName(),t},m.prototype.adjustRenderedElementSize=function(t){"auto"===this.height?t.style.flex="0 0 auto":t.style.flex="1 1 auto",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},m.prototype.applyPadding=function(){var t,e;this.separatorElement&&(fe.alwaysBleedSeparators&&this.separatorOrientation==s.Orientation.Horizontal&&!this.isBleeding()?(t=new a.PaddingDefinition,this.getImmediateSurroundingPadding(t),e=this.hostConfig.paddingDefinitionToSpacingDefinition(t),this.separatorElement.style.marginLeft="-"+e.left+"px",this.separatorElement.style.marginRight="-"+e.right+"px"):(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"))},m.prototype.truncateOverflow=function(t){return!1},m.prototype.undoOverflowTruncation=function(){},m.prototype.isDesignMode=function(){var t=this.getRootElement();return t instanceof fe&&t.designMode},m.prototype.getDefaultPadding=function(){return new a.PaddingDefinition},m.prototype.getHasBackground=function(){return!1},Object.defineProperty(m.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"separatorOrientation",{get:function(){return s.Orientation.Horizontal},enumerable:!0,configurable:!0}),m.prototype.getPadding=function(){return this._padding},m.prototype.setPadding=function(t){this._padding=t},m.prototype.isBleeding=function(){return!1},m.prototype.toJSON=function(){var t={};return o.setProperty(t,"type",this.getJsonTypeName()),o.setProperty(t,"id",this.id),null!==this.horizontalAlignment&&o.setEnumProperty(s.HorizontalAlignment,t,"horizontalAlignment",this.horizontalAlignment),o.setEnumProperty(s.Spacing,t,"spacing",this.spacing,s.Spacing.Default),o.setProperty(t,"separator",this.separator,!1),o.setProperty(t,"height",this.height,"auto"),this.minPixelHeight&&o.setProperty(t,"minHeight",this.minPixelHeight+"px"),t},m.prototype.setParent=function(t){this._parent=t},m.prototype.getForbiddenElementTypes=function(){return null},m.prototype.getForbiddenActionTypes=function(){return null},m.prototype.getImmediateSurroundingPadding=function(t,e,n,i,r){var s,a,o,l,c;void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),this.parent&&(s=e&&this.parent.isFirstElement(this),a=n&&this.parent.isRightMostElement(this),o=i&&this.parent.isLastElement(this),l=r&&this.parent.isLeftMostElement(this),(c=this.parent.getEffectivePadding())&&(s&&(t.top=c.top),a&&(t.right=c.right),o&&(t.bottom=c.bottom),l&&(t.left=c.left)),(s||a||o||l)&&this.parent.getImmediateSurroundingPadding(t,s,a,o,l))},m.prototype.parse=function(t,e){var n,i,r,l,c;i=t,r=e,null!=(c=(l=(n=this).getRootElement())&&l.onParseElement?l.onParseElement:fe.onParseElement)&&c(n,i,r),this.requires.parse(t.requires,e),this.id=t.id,this.isVisible=o.parseBoolProperty(t.isVisible,this.isVisible),this.speak=t.speak,this.horizontalAlignment=o.getEnumValueOrDefault(s.HorizontalAlignment,t.horizontalAlignment,null),this.spacing=o.getEnumValueOrDefault(s.Spacing,t.spacing,s.Spacing.Default),this.separator=o.parseBoolProperty(t.separator,this.separator);var u=t.separation;void 0!==u&&("none"===u?(this.spacing=s.Spacing.None,this.separator=!1):"strong"===u?(this.spacing=s.Spacing.Large,this.separator=!0):"default"===u&&(this.spacing=s.Spacing.Default,this.separator=!1),ne({error:s.ValidationError.Deprecated,message:'The "separation" property is deprecated and will be removed. Use the "spacing" and "separator" properties instead.'},e));var p=t.height;"auto"!==p&&"stretch"!==p||(this.height=p);var h=t.minHeight;if(h&&"string"==typeof h){var d=!1;try{var g=a.SizeAndUnit.parse(h,!0);g.unit==s.SizeUnit.Pixel&&(this.minPixelHeight=g.physicalSize,d=!0)}catch(t){}d||ne({error:s.ValidationError.InvalidPropertyValue,message:'Invalid "minHeight" value: '+h},e)}},m.prototype.getActionCount=function(){return 0},m.prototype.getActionAt=function(t){throw new Error("Index out of range.")},m.prototype.validate=function(){return[]},m.prototype.remove=function(){return!!(this.parent&&this.parent instanceof M)&&this.parent.removeItem(this)},m.prototype.render=function(){return this._renderedElement=this.internalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},m.prototype.updateLayout=function(t){void 0===t&&(t=!0),this.updateRenderedElementVisibility(),this.applyPadding()},m.prototype.indexOf=function(t){return-1},m.prototype.isRendered=function(){return this._renderedElement&&0<this._renderedElement.offsetHeight},m.prototype.isFirstElement=function(t){return!0},m.prototype.isLastElement=function(t){return!0},m.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},m.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},m.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},m.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},m.prototype.isBleedingAtTop=function(){return!1},m.prototype.isBleedingAtBottom=function(){return!1},m.prototype.isLeftMostElement=function(t){return!0},m.prototype.isRightMostElement=function(t){return!0},m.prototype.isHiddenDueToOverflow=function(){return this._renderedElement&&"hidden"==this._renderedElement.style.visibility},m.prototype.getRootElement=function(){for(var t=this;t.parent;)t=t.parent;return t},m.prototype.getParentContainer=function(){for(var t=this.parent;t;){if(t instanceof jt)return t;t=t.parent}return null},m.prototype.getAllInputs=function(){return[]},m.prototype.getResourceInformation=function(){return[]},m.prototype.getElementById=function(t){return this.id===t?this:null},m.prototype.getActionById=function(t){return null},m.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},m.prototype.setShouldFallback=function(t){this._shouldFallback=t},m.prototype.getEffectivePadding=function(){var t=this.getPadding();return t&&this.allowCustomPadding?t:this.getDefaultPadding()},Object.defineProperty(m.prototype,"lang",{get:function(){return this._lang?this._lang:this.parent?this.parent.lang:void 0},set:function(t){if(t&&""!=t&&!/^[a-z]{2,3}$/gi.exec(t))throw new Error("Invalid language identifier: "+t);this._lang=t},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:Ae},set:function(t){this._hostConfig=t},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"isInteractive",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"isStandalone",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){fe.useAdvancedCardBottomTruncation&&!t&&this.undoOverflowTruncation(),this._isVisible!=t&&(this._isVisible=t,this.updateRenderedElementVisibility(),this._renderedElement&&ee(this))},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"hasVisibleSeparator",{get:function(){var t=this.getParentContainer();return!!t&&this.separatorElement&&!t.isFirstElement(this)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!0,configurable:!0}),m);function m(){this._shouldFallback=!1,this._lang=void 0,this._hostConfig=null,this._parent=null,this._renderedElement=null,this._separatorElement=null,this._isVisible=!0,this._truncatedDueToOverflow=!1,this._defaultRenderedElementDisplayMode=null,this._padding=null,this.requires=new l.HostCapabilities,this.horizontalAlignment=null,this.spacing=s.Spacing.Default,this.separator=!1,this.customCssSelector=null,this.height="auto",this.minPixelHeight=null}e.CardElement=f;var y,C=(r(v,y=f),v.prototype.restoreOriginalContent=function(){var t=this.maxLines?this._computedLineHeight*this.maxLines+"px":null;this.renderedElement.style.maxHeight=t,this.renderedElement.innerHTML=this._originalInnerHtml},v.prototype.truncateIfSupported=function(t){var e=this.renderedElement.children,n=!e.length;if(n||1==e.length&&"p"==e[0].tagName.toLowerCase()){var i=n?this.renderedElement:e[0];return o.truncate(i,t,this._computedLineHeight),!0}return!1},v.prototype.getEffectiveStyleDefinition=function(){if(!this._effectiveStyleDefinition){this._effectiveStyleDefinition=this.hostConfig.containerStyles.default;for(var t=this.getParentContainer();t;){if(t.style){this._effectiveStyleDefinition=this.hostConfig.containerStyles.getStyleByName(t.style);break}t=t.getParentContainer()}}return this._effectiveStyleDefinition},v.prototype.getRenderedDomElementType=function(){return"div"},v.prototype.internalRender=function(){var t=this;if(this._effectiveStyleDefinition=null,this._processedText=null,o.isNullOrEmpty(this.text))return null;var e,n,i,r,s,a=this.hostConfig,l=document.createElement(this.getRenderedDomElementType());l.classList.add(a.makeCssClassName("ac-textBlock")),l.style.overflow="hidden",this.applyStylesTo(l),this.selectAction&&(l.onclick=function(e){t.selectAction.execute(),e.cancelBubble=!0}),this._processedText||(this._treatAsPlainText=!0,e=c.formatText(this.lang,this.text),this.useMarkdown?(fe.allowMarkForTextHighlighting&&(e=e.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/")),(n=fe.applyMarkdown(e)).didProcess&&n.outputHtml?(this._processedText=n.outputHtml,this._treatAsPlainText=!1,fe.allowMarkForTextHighlighting&&(i="",(r=this.getEffectiveStyleDefinition()).highlightBackgroundColor&&(i+="background-color: "+r.highlightBackgroundColor+";"),r.highlightForegroundColor&&(i+="color: "+r.highlightForegroundColor+";"),o.isNullOrEmpty(i)||(i='style="'+i+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+i+">").replace(/\/==\//g,"</mark>"))):(this._processedText=e,this._treatAsPlainText=!0)):(this._processedText=e,this._treatAsPlainText=!0)),this._treatAsPlainText?l.innerText=this._processedText:l.innerHTML=this._processedText,l.firstElementChild instanceof HTMLElement&&((s=l.firstElementChild).style.marginTop="0px",s.style.width="100%",this.wrap||(s.style.overflow="hidden",s.style.textOverflow="ellipsis")),l.lastElementChild instanceof HTMLElement&&(l.lastElementChild.style.marginBottom="0px");for(var u=l.getElementsByTagName("a"),p=0;p<u.length;p++){var h=u[p];h.classList.add(this.hostConfig.makeCssClassName("ac-anchor")),h.target="_blank",h.onclick=function(e){var n,i,r,s;n=t,i=e.target,null!=(s=(r=n.getRootElement())&&r.onAnchorClicked?r.onAnchorClicked:fe.onAnchorClicked)&&s(n,i)&&e.preventDefault()}}return this.wrap?(l.style.wordWrap="break-word",0<this.maxLines&&(l.style.maxHeight=this._computedLineHeight*this.maxLines+"px",l.style.overflow="hidden")):(l.style.whiteSpace="nowrap",l.style.textOverflow="ellipsis"),(fe.useAdvancedTextBlockTruncation||fe.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=l.innerHTML),null!=this.selectAction&&a.supportsInteractivity&&(l.tabIndex=0,l.setAttribute("role","button"),l.setAttribute("aria-label",this.selectAction.title),l.classList.add(a.makeCssClassName("ac-selectable"))),l},v.prototype.truncateOverflow=function(t){return t>=this._computedLineHeight&&this.truncateIfSupported(t)},v.prototype.undoOverflowTruncation=function(){var t;this.restoreOriginalContent(),fe.useAdvancedTextBlockTruncation&&this.maxLines&&(t=this._computedLineHeight*this.maxLines,this.truncateIfSupported(t))},v.prototype.toJSON=function(){var t=y.prototype.toJSON.call(this);return o.setEnumProperty(s.TextSize,t,"size",this.size,s.TextSize.Default),o.setEnumProperty(s.TextWeight,t,"weight",this.weight,s.TextWeight.Default),o.setEnumProperty(s.TextColor,t,"color",this.color,s.TextColor.Default),o.setProperty(t,"text",this.text),o.setProperty(t,"isSubtle",this.isSubtle,!1),o.setProperty(t,"wrap",this.wrap,!1),o.setProperty(t,"maxLines",this.maxLines,0),t},v.prototype.applyStylesTo=function(t){this.hostConfig.fontFamily&&(t.style.fontFamily=this.hostConfig.fontFamily);var e,n=this.getParentContainer(),i=!!n&&n.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.textAlign="center";break;case s.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left"}switch(this.size){case s.TextSize.Small:e=this.hostConfig.fontSizes.small;break;case s.TextSize.Medium:e=this.hostConfig.fontSizes.medium;break;case s.TextSize.Large:e=this.hostConfig.fontSizes.large;break;case s.TextSize.ExtraLarge:e=this.hostConfig.fontSizes.extraLarge;break;default:e=this.hostConfig.fontSizes.default}if(this.hostConfig.lineHeights)switch(this.size){case s.TextSize.Small:this._computedLineHeight=this.hostConfig.lineHeights.small;break;case s.TextSize.Medium:this._computedLineHeight=this.hostConfig.lineHeights.medium;break;case s.TextSize.Large:this._computedLineHeight=this.hostConfig.lineHeights.large;break;case s.TextSize.ExtraLarge:this._computedLineHeight=this.hostConfig.lineHeights.extraLarge;break;default:this._computedLineHeight=this.hostConfig.lineHeights.default}else this._computedLineHeight=1.33*e;t.style.fontSize=e+"px",t.style.lineHeight=this._computedLineHeight+"px";var r,a,l=this.getEffectiveStyleDefinition();switch(this.color?this.color:s.TextColor.Default){case s.TextColor.Accent:r=l.foregroundColors.accent;break;case s.TextColor.Dark:r=l.foregroundColors.dark;break;case s.TextColor.Light:r=l.foregroundColors.light;break;case s.TextColor.Good:r=l.foregroundColors.good;break;case s.TextColor.Warning:r=l.foregroundColors.warning;break;case s.TextColor.Attention:r=l.foregroundColors.attention;break;default:r=l.foregroundColors.default}switch(t.style.color=o.stringToCssColor(this.isSubtle?r.subtle:r.default),this.weight){case s.TextWeight.Lighter:a=this.hostConfig.fontWeights.lighter;break;case s.TextWeight.Bolder:a=this.hostConfig.fontWeights.bolder;break;default:a=this.hostConfig.fontWeights.default}t.style.fontWeight=a.toString()},v.prototype.parse=function(t,e){y.prototype.parse.call(this,t,e),this.text=t.text;var n=t.size;n&&"string"==typeof n&&"normal"===n.toLowerCase()?(this.size=s.TextSize.Default,ne({error:s.ValidationError.Deprecated,message:'The TextBlock.size value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.size=o.getEnumValueOrDefault(s.TextSize,n,this.size);var i=t.weight;i&&"string"==typeof i&&"normal"===i.toLowerCase()?(this.weight=s.TextWeight.Default,ne({error:s.ValidationError.Deprecated,message:'The TextBlock.weight value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.weight=o.getEnumValueOrDefault(s.TextWeight,i,this.weight),this.color=o.getEnumValueOrDefault(s.TextColor,t.color,this.color),this.isSubtle=o.parseBoolProperty(t.isSubtle,this.isSubtle),this.wrap=o.parseBoolProperty(t.wrap,this.wrap),"number"==typeof t.maxLines&&(this.maxLines=t.maxLines)},v.prototype.getJsonTypeName=function(){return"TextBlock"},v.prototype.renderSpeech=function(){return null!=this.speak?this.speak+"\n":this.text?"<s>"+this.text+"</s>\n":null},v.prototype.updateLayout=function(t){var e;void 0===t&&(t=!1),y.prototype.updateLayout.call(this,t),fe.useAdvancedTextBlockTruncation&&this.maxLines&&this.isRendered()&&(this.restoreOriginalContent(),e=this._computedLineHeight*this.maxLines,this.truncateIfSupported(e))},Object.defineProperty(v.prototype,"text",{get:function(){return this._text},set:function(t){this._text!=t&&(this._text=t,this._processedText=null)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),v);function v(){var t=null!==y&&y.apply(this,arguments)||this;return t._processedText=null,t._treatAsPlainText=!0,t._selectAction=null,t._effectiveStyleDefinition=null,t.size=s.TextSize.Default,t.weight=s.TextWeight.Default,t.color=s.TextColor.Default,t.isSubtle=!1,t.wrap=!1,t.useMarkdown=!0,t}e.TextBlock=C;var A,b=(r(x,A=C),x.prototype.getRenderedDomElementType=function(){return"label"},x.prototype.internalRender=function(){var t=A.prototype.internalRender.call(this);return o.isNullOrEmpty(this.forElementId)||(t.htmlFor=this.forElementId),t},x);function x(){return null!==A&&A.apply(this,arguments)||this}var I=(S.prototype.toJSON=function(){return{title:this.name,value:this.value}},S.prototype.renderSpeech=function(){return null!=this.speak?this.speak+"\n":"<s>"+this.name+" "+this.value+"</s>\n"},S);function S(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.name=t,this.value=e}e.Fact=I;var k,_=(r(E,k=f),Object.defineProperty(E.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),E.prototype.internalRender=function(){var t=null,e=this.hostConfig;if(0<this.facts.length){(t=document.createElement("table")).style.borderWidth="0px",t.style.borderSpacing="0px",t.style.borderStyle="none",t.style.borderCollapse="collapse",t.style.display="block",t.style.overflow="hidden",t.classList.add(e.makeCssClassName("ac-factset"));for(var n=0;n<this.facts.length;n++){var i=document.createElement("tr");0<n&&(i.style.marginTop=this.hostConfig.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(e.makeCssClassName("ac-fact-title")),this.hostConfig.factSet.title.maxWidth&&(r.style.maxWidth=this.hostConfig.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var a=new C;a.setParent(this),a.text=o.isNullOrEmpty(this.facts[n].name)?"Title":this.facts[n].name,a.size=this.hostConfig.factSet.title.size,a.color=this.hostConfig.factSet.title.color,a.isSubtle=this.hostConfig.factSet.title.isSubtle,a.weight=this.hostConfig.factSet.title.weight,a.wrap=this.hostConfig.factSet.title.wrap,a.spacing=s.Spacing.None,o.appendChild(r,a.render()),o.appendChild(i,r),(r=document.createElement("td")).style.width="10px",o.appendChild(i,r),(r=document.createElement("td")).style.verticalAlign="top",r.classList.add(e.makeCssClassName("ac-fact-value")),(a=new C).setParent(this),a.text=o.isNullOrEmpty(this.facts[n].value)?"Value":this.facts[n].value,a.size=this.hostConfig.factSet.value.size,a.color=this.hostConfig.factSet.value.color,a.isSubtle=this.hostConfig.factSet.value.isSubtle,a.weight=this.hostConfig.factSet.value.weight,a.wrap=this.hostConfig.factSet.value.wrap,a.spacing=s.Spacing.None,o.appendChild(r,a.render()),o.appendChild(i,r),o.appendChild(t,i)}}return t},E.prototype.getJsonTypeName=function(){return"FactSet"},E.prototype.toJSON=function(){for(var t=k.prototype.toJSON.call(this),e=[],n=0,i=this.facts;n<i.length;n++){var r=i[n];e.push(r.toJSON())}return o.setProperty(t,"facts",e),t},E.prototype.parse=function(t,e){if(k.prototype.parse.call(this,t,e),this.facts=[],null!=t.facts){var n=t.facts;this.facts=[];for(var i=0;i<n.length;i++){var r=new I;r.name=n[i].title,r.value=n[i].value,r.speak=n[i].speak,this.facts.push(r)}}},E.prototype.renderSpeech=function(){if(null!=this.speak)return this.speak+"\n";var t=null;if(0<this.facts.length){t="";for(var e=0;e<this.facts.length;e++){var n=this.facts[e].renderSpeech();n&&(t+=n)}}return"<p>"+t+"\n</p>\n"},E);function E(){var t=null!==k&&k.apply(this,arguments)||this;return t.facts=[],t}e.FactSet=_;var w,P=(r(T,w=f),T.prototype.parseDimension=function(t,e,n){if(e){if("string"==typeof e)try{var i=a.SizeAndUnit.parse(e);if(i.unit==s.SizeUnit.Pixel)return i.physicalSize}catch(t){}ne({error:s.ValidationError.InvalidPropertyValue,message:"Invalid image "+t+": "+e},n)}return 0},T.prototype.applySize=function(t){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(t.style.width=this.pixelWidth+"px"),this.pixelHeight&&(t.style.height=this.pixelHeight+"px");else switch(this.size){case s.Size.Stretch:t.style.width="100%";break;case s.Size.Auto:t.style.maxWidth="100%";break;case s.Size.Small:t.style.width=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:t.style.width=this.hostConfig.imageSizes.large+"px";break;case s.Size.Medium:t.style.width=this.hostConfig.imageSizes.medium+"px"}},Object.defineProperty(T.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),T.prototype.internalRender=function(){var t=this,e=null;if(!o.isNullOrEmpty(this.url)){switch((e=document.createElement("div")).style.display="flex",e.style.alignItems="flex-start",e.onkeypress=function(e){t.selectAction&&(13!=e.keyCode&&32!=e.keyCode||t.selectAction.execute())},e.onclick=function(e){t.selectAction&&(t.selectAction.execute(),e.cancelBubble=!0)},this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.justifyContent="center";break;case s.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}var n=this.hostConfig,i=document.createElement("img");i.onload=function(e){$t(t)},i.onerror=function(e){var n,i=t.getRootElement();t.renderedElement.innerHTML="",i&&i.designMode&&((n=document.createElement("div")).style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.backgroundColor="#EEEEEE",n.style.color="black",n.innerText=":-(",n.style.padding="10px",t.applySize(n),t.renderedElement.appendChild(n)),$t(t)},i.style.maxHeight="100%",i.style.minWidth="0",i.classList.add(n.makeCssClassName("ac-image")),null!=this.selectAction&&n.supportsInteractivity&&(i.tabIndex=0,i.setAttribute("role","button"),i.setAttribute("aria-label",this.selectAction.title),i.classList.add(n.makeCssClassName("ac-selectable"))),this.applySize(i),this.style===s.ImageStyle.Person&&(i.style.borderRadius="50%",i.style.backgroundPosition="50% 50%",i.style.backgroundRepeat="no-repeat"),o.isNullOrEmpty(this.backgroundColor)||(i.style.backgroundColor=o.stringToCssColor(this.backgroundColor)),i.src=this.url,i.alt=this.altText,e.appendChild(i)}return e},T.prototype.toJSON=function(){var t=w.prototype.toJSON.call(this);return this._selectAction&&o.setProperty(t,"selectAction",this._selectAction.toJSON()),o.setEnumProperty(s.ImageStyle,t,"style",this.style,s.ImageStyle.Default),o.setProperty(t,"backgroundColor",this.backgroundColor),o.setProperty(t,"url",this.url),o.setEnumProperty(s.Size,t,"size",this.size,s.Size.Auto),this.pixelWidth&&o.setProperty(t,"width",this.pixelWidth+"px"),this.pixelHeight&&o.setProperty(t,"height",this.pixelHeight+"px"),o.setProperty(t,"altText",this.altText),t},T.prototype.getJsonTypeName=function(){return"Image"},T.prototype.getActionById=function(t){var e=w.prototype.getActionById.call(this,t);return!e&&this.selectAction&&(e=this.selectAction.getActionById(t)),e},T.prototype.parse=function(t,e){w.prototype.parse.call(this,t,e),this.url=t.url,this.backgroundColor=t.backgroundColor;var n=t.style;n&&"string"==typeof n&&"normal"===n.toLowerCase()?(this.style=s.ImageStyle.Default,ne({error:s.ValidationError.Deprecated,message:'The Image.style value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.style=o.getEnumValueOrDefault(s.ImageStyle,n,this.style),this.size=o.getEnumValueOrDefault(s.Size,t.size,this.size),this.altText=t.altText,t.pixelWidth&&"number"==typeof t.pixelWidth&&(this.pixelWidth=t.pixelWidth,ne({error:s.ValidationError.Deprecated,message:"The pixelWidth property is deprecated and will be removed. Use the width property instead."},e)),t.pixelHeight&&"number"==typeof t.pixelHeight&&(this.pixelHeight=t.pixelHeight,ne({error:s.ValidationError.Deprecated,message:"The pixelHeight property is deprecated and will be removed. Use the height property instead."},e));var i=this.parseDimension("width",t.width,e);0<i&&(this.pixelWidth=i),0<(i=this.parseDimension("height",t.height,e))&&(this.pixelHeight=i),this.selectAction=d(this,t.selectAction,e)},T.prototype.getResourceInformation=function(){return o.isNullOrEmpty(this.url)?[]:[{url:this.url,mimeType:"image"}]},T.prototype.renderSpeech=function(){return null!=this.speak?this.speak+"\n":null},Object.defineProperty(T.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),T);function T(){var t=null!==w&&w.apply(this,arguments)||this;return t.style=s.ImageStyle.Default,t.size=s.Size.Auto,t.pixelWidth=null,t.pixelHeight=null,t.altText="",t}e.Image=P;var D,M=(r(O,D=f),O.prototype.applyPadding=function(){var t;D.prototype.applyPadding.call(this),this.renderedElement&&(t=new a.SpacingDefinition,this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0")},O.prototype.getSelectAction=function(){return this._selectAction},O.prototype.setSelectAction=function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},Object.defineProperty(O.prototype,"isSelectable",{get:function(){return!1},enumerable:!0,configurable:!0}),O.prototype.parse=function(t,e){D.prototype.parse.call(this,t,e),this.isSelectable&&(this._selectAction=d(this,t.selectAction,e))},O.prototype.toJSON=function(){var t=D.prototype.toJSON.call(this);return this._selectAction&&this.isSelectable&&o.setProperty(t,"selectAction",this._selectAction.toJSON()),t},O.prototype.validate=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).validate());return this._selectAction&&(t=t.concat(this._selectAction.validate())),t},O.prototype.render=function(){var t=this,e=D.prototype.render.call(this),n=this.hostConfig;return this.isSelectable&&this._selectAction&&n.supportsInteractivity&&(e.classList.add(n.makeCssClassName("ac-selectable")),e.tabIndex=0,e.setAttribute("role","button"),e.setAttribute("aria-label",this._selectAction.title),e.onclick=function(e){null!=t._selectAction&&(t._selectAction.execute(),e.cancelBubble=!0)},e.onkeypress=function(e){null!=t._selectAction&&(13!=e.keyCode&&32!=e.keyCode||t._selectAction.execute())}),e},O.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),D.prototype.updateLayout.call(this,t),t)for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).updateLayout()},O.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getAllInputs());return t},O.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getResourceInformation());return t},O.prototype.getElementById=function(t){var e=D.prototype.getElementById.call(this,t);if(!e)for(var n=0;n<this.getItemCount()&&!(e=this.getItemAt(n).getElementById(t));n++);return e},O);function O(){var t=null!==D&&D.apply(this,arguments)||this;return t._selectAction=null,t}e.CardElementContainer=M;var F,N=(r(R,F=M),R.prototype.internalRender=function(){var t=null;if(0<this._images.length){(t=document.createElement("div")).style.display="flex",t.style.flexWrap="wrap";for(var e=0;e<this._images.length;e++){this._images[e].size=this.imageSize;var n=this._images[e].render();n.style.display="inline-flex",n.style.margin="0px",n.style.marginRight="10px",n.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px",o.appendChild(t,n)}}return t},R.prototype.getItemCount=function(){return this._images.length},R.prototype.getItemAt=function(t){return this._images[t]},R.prototype.getFirstVisibleRenderedItem=function(){return this._images&&0<this._images.length?this._images[0]:null},R.prototype.getLastVisibleRenderedItem=function(){return this._images&&0<this._images.length?this._images[this._images.length-1]:null},R.prototype.removeItem=function(t){if(t instanceof P){var e=this._images.indexOf(t);if(0<=e)return this._images.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},R.prototype.getJsonTypeName=function(){return"ImageSet"},R.prototype.toJSON=function(){var t=F.prototype.toJSON.call(this);if(o.setEnumProperty(s.Size,t,"imageSize",this.imageSize,s.Size.Medium),0<this._images.length){for(var e=[],n=0,i=this._images;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,"images",e)}return t},R.prototype.parse=function(t,e){if(F.prototype.parse.call(this,t,e),this.imageSize=o.getEnumValueOrDefault(s.Size,t.imageSize,s.Size.Medium),null!=t.images){var n=t.images;this._images=[];for(var i=0;i<n.length;i++){var r=new P;r.parse(n[i],e),this.addImage(r)}}},R.prototype.addImage=function(t){if(t.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(t),t.setParent(this)},R.prototype.indexOf=function(t){return t instanceof P?this._images.indexOf(t):-1},R.prototype.renderSpeech=function(){if(null!=this.speak)return this.speak;var t=null;if(0<this._images.length){t="";for(var e=0;e<this._images.length;e++)t+=this._images[e].renderSpeech()}return t},R);function R(){var t=null!==F&&F.apply(this,arguments)||this;return t._images=[],t.imageSize=s.Size.Medium,t}e.ImageSet=N;var z=(L.prototype.parse=function(t,e){this.mimeType=t.mimeType,this.url=t.url},L.prototype.toJSON=function(){return{mimeType:this.mimeType,url:this.url}},L);function L(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.url=t,this.mimeType=e}e.MediaSource=z;var B,V=(r(H,B=f),H.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},H.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var t=0,e=this.sources;t<e.length;t++){var n,i=e[t],r=i.mimeType.split("/");2==r.length&&(this._selectedMediaType||0<=(n=H.supportedMediaTypes.indexOf(r[0]))&&(this._selectedMediaType=H.supportedMediaTypes[n]),r[0]==this._selectedMediaType&&this._selectedSources.push(i))}},H.prototype.renderPoster=function(){var t=this,e=document.createElement("div");e.className="ac-media-poster",e.setAttribute("role","contentinfo"),e.setAttribute("aria-label",this.altText?this.altText:"Media content"),e.style.position="relative",e.style.display="flex";var n,i,r,s,a=this.getPosterUrl();return a?((n=document.createElement("img")).style.width="100%",n.style.height="100%",n.onerror=function(t){n.parentNode.removeChild(n),e.classList.add("empty"),e.style.minHeight="150px"},n.src=a,e.appendChild(n)):(e.classList.add("empty"),e.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&0<this._selectedSources.length&&((i=document.createElement("div")).setAttribute("role","button"),i.setAttribute("aria-label","Play media"),i.className="ac-media-playButton",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.onclick=function(e){var n;t.hostConfig.media.allowInlinePlayback?(n=t.renderMediaPlayer(),t.renderedElement.innerHTML="",t.renderedElement.appendChild(n),n.play()):H.onPlay&&H.onPlay(t)},(r=document.createElement("div")).className="ac-media-playButton-arrow",r.style.width="12px",r.style.height="15px",r.style.borderTopWidth="7.5px",r.style.borderBottomWidth="7.5px",r.style.borderLeftWidth="12px",r.style.borderRightWidth="0",r.style.borderStyle="solid",r.style.borderTopColor="transparent",r.style.borderRightColor="transparent",r.style.borderBottomColor="transparent",r.style.transform="translate(1.2px,0px)",i.appendChild(r),(s=document.createElement("div")).style.position="absolute",s.style.left="0",s.style.top="0",s.style.width="100%",s.style.height="100%",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.appendChild(i),e.appendChild(s)),e},H.prototype.renderMediaPlayer=function(){var t,e,n="video"==this._selectedMediaType?(t=document.createElement("video"),(e=this.getPosterUrl())&&(t.poster=e),t):document.createElement("audio");n.controls=!0,n.preload="none",n.style.width="100%";for(var i=0,r=this.sources;i<r.length;i++){var s=r[i],a=document.createElement("source");a.src=s.url,a.type=s.mimeType,n.appendChild(a)}return n},H.prototype.internalRender=function(){var t=document.createElement("div");return t.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),t.appendChild(this.renderPoster()),t},H.prototype.parse=function(t,e){if(B.prototype.parse.call(this,t,e),this.poster=t.poster,this.altText=t.altText,null!=t.sources){var n=t.sources;this.sources=[];for(var i=0;i<n.length;i++){var r=new z;r.parse(n[i],e),this.sources.push(r)}}},H.prototype.toJSON=function(){var t=B.prototype.toJSON.call(this);if(o.setProperty(t,"poster",this.poster),o.setProperty(t,"altText",this.altText),0<this.sources.length){for(var e=[],n=0,i=this.sources;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,"sources",e)}return t},H.prototype.getJsonTypeName=function(){return"Media"},H.prototype.getResourceInformation=function(){var t=[],e=this.getPosterUrl();o.isNullOrEmpty(e)||t.push({url:e,mimeType:"image"});for(var n=0,i=this.sources;n<i.length;n++){var r=i[n];o.isNullOrEmpty(r.url)||t.push({url:r.url,mimeType:r.mimeType})}return t},H.prototype.renderSpeech=function(){return this.altText},Object.defineProperty(H.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!0,configurable:!0}),H.supportedMediaTypes=["audio","video"],H);function H(){var t=null!==B&&B.apply(this,arguments)||this;return t.sources=[],t}e.Media=V;var U,q=(r(J,U=f),J.prototype.valueChanged=function(){this.onValueChanged&&this.onValueChanged(this)},J.prototype.toJSON=function(){var t=U.prototype.toJSON.call(this);return o.setProperty(t,"title",this.title),o.setProperty(t,"value",this.renderedElement?this.value:this.defaultValue),t},J.prototype.validate=function(){return this.id?[]:[{error:s.ValidationError.PropertyCantBeNull,message:"All inputs must have a unique Id"}]},J.prototype.parse=function(t,e){U.prototype.parse.call(this,t,e),this.id=t.id,this.defaultValue=t.value},J.prototype.renderSpeech=function(){return null!=this.speak?this.speak:this.title?"<s>"+this.title+"</s>\n":null},J.prototype.getAllInputs=function(){return[this]},Object.defineProperty(J.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),J);function J(){return null!==U&&U.apply(this,arguments)||this}e.Input=q;var j,W=(r(G,j=q),G.prototype.internalRender=function(){var t=this;return this.isMultiline?(this._textareaElement=document.createElement("textarea"),this._textareaElement.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),this._textareaElement.style.width="100%",this._textareaElement.tabIndex=0,o.isNullOrEmpty(this.placeholder)||(this._textareaElement.placeholder=this.placeholder,this._textareaElement.setAttribute("aria-label",this.placeholder)),o.isNullOrEmpty(this.defaultValue)||(this._textareaElement.value=this.defaultValue),0<this.maxLength&&(this._textareaElement.maxLength=this.maxLength),this._textareaElement.oninput=function(){t.valueChanged()},this._textareaElement):(this._inputElement=document.createElement("input"),this._inputElement.type=s.InputTextStyle[this.style].toLowerCase(),this._inputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),this._inputElement.style.width="100%",this._inputElement.tabIndex=0,o.isNullOrEmpty(this.placeholder)||(this._inputElement.placeholder=this.placeholder,this._inputElement.setAttribute("aria-label",this.placeholder)),o.isNullOrEmpty(this.defaultValue)||(this._inputElement.value=this.defaultValue),0<this.maxLength&&(this._inputElement.maxLength=this.maxLength),this._inputElement.oninput=function(){t.valueChanged()},this._inputElement)},G.prototype.getJsonTypeName=function(){return"Input.Text"},G.prototype.toJSON=function(){var t=j.prototype.toJSON.call(this);return o.setProperty(t,"placeholder",this.placeholder),o.setProperty(t,"maxLength",this.maxLength,0),o.setProperty(t,"isMultiline",this.isMultiline,!1),o.setEnumProperty(s.InputTextStyle,t,"style",this.style,s.InputTextStyle.Text),t},G.prototype.parse=function(t,e){j.prototype.parse.call(this,t,e),this.maxLength=t.maxLength,this.isMultiline=o.parseBoolProperty(t.isMultiline,this.isMultiline),this.placeholder=t.placeholder,this.style=o.getEnumValueOrDefault(s.InputTextStyle,t.style,this.style)},Object.defineProperty(G.prototype,"value",{get:function(){return this.isMultiline?this._textareaElement?this._textareaElement.value:null:this._inputElement?this._inputElement.value:null},enumerable:!0,configurable:!0}),G);function G(){var t=null!==j&&j.apply(this,arguments)||this;return t.isMultiline=!1,t.style=s.InputTextStyle.Text,t}e.TextInput=W;var Z,Y=(r(K,Z=q),K.prototype.internalRender=function(){var t,e,n,i=this,r=document.createElement("div");return r.className=this.hostConfig.makeCssClassName("ac-input"),r.style.width="100%",r.style.display="flex",r.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=o.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this._checkboxInputElement.setAttribute("aria-label",this.title),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){i.valueChanged()},o.appendChild(r,this._checkboxInputElement),o.isNullOrEmpty(this.title)&&!this.isDesignMode()||((t=new b).setParent(this),t.forElementId=this._checkboxInputElement.id,t.hostConfig=this.hostConfig,t.text=o.isNullOrEmpty(this.title)?this.getJsonTypeName():this.title,t.useMarkdown=fe.useMarkdownInRadioButtonAndCheckbox,t.wrap=this.wrap,(e=t.render()).style.display="inline-block",e.style.flex="1 1 auto",e.style.marginLeft="6px",e.style.verticalAlign="middle",(n=document.createElement("div")).style.width="6px",o.appendChild(r,n),o.appendChild(r,e)),r},K.prototype.getJsonTypeName=function(){return"Input.Toggle"},K.prototype.toJSON=function(){var t=Z.prototype.toJSON.call(this);return o.setProperty(t,"valueOn",this.valueOn,"true"),o.setProperty(t,"valueOff",this.valueOff,"false"),o.setProperty(t,"wrap",this.wrap),t},K.prototype.parse=function(t,e){Z.prototype.parse.call(this,t,e),this.title=t.title,this.valueOn=o.getValueOrDefault(t.valueOn,this.valueOn),this.valueOff=o.getValueOrDefault(t.valueOff,this.valueOff),this.wrap=o.parseBoolProperty(t.wrap,this.wrap)},Object.defineProperty(K.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),K);function K(){var t=null!==Z&&Z.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}e.ToggleInput=Y;var Q=(X.prototype.toJSON=function(){return{title:this.title,value:this.value}},X);function X(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.title=t,this.value=e}e.Choice=Q;var $,tt=(r(et,$=q),et.getUniqueCategoryName=function(){var t="__ac-category"+et.uniqueCategoryCounter;return et.uniqueCategoryCounter++,t},et.prototype.internalRender=function(){var t=this;if(this.isMultiSelect){var e=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;(l=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input"),l.style.width="100%",this._toggleInputs=[];for(var n=0;n<this.choices.length;n++){var i=document.createElement("input");i.id=o.generateUniqueId(),i.type="checkbox",i.style.margin="0",i.style.display="inline-block",i.style.verticalAlign="middle",i.value=this.choices[n].value,i.style.flex="0 0 auto",i.setAttribute("aria-label",this.choices[n].title),e&&0<=e.indexOf(this.choices[n].value)&&(i.checked=!0),i.onchange=function(){t.valueChanged()},this._toggleInputs.push(i),(p=new b).setParent(this),p.forElementId=i.id,p.hostConfig=this.hostConfig,p.text=o.isNullOrEmpty(this.choices[n].title)?"Choice "+n:this.choices[n].title,p.useMarkdown=fe.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap,(h=p.render()).style.display="inline-block",h.style.flex="1 1 auto",h.style.marginLeft="6px",h.style.verticalAlign="middle",(d=document.createElement("div")).style.width="6px",(g=document.createElement("div")).style.display="flex",g.style.alignItems="center",o.appendChild(g,i),o.appendChild(g,d),o.appendChild(g,h),o.appendChild(l,g)}return l}if(this.isCompact){this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput"),this._selectElement.style.width="100%";var r=document.createElement("option");r.selected=!0,r.disabled=!0,r.hidden=!0,r.value="",this.placeholder&&(r.text=this.placeholder),o.appendChild(this._selectElement,r);for(var s=0;s<this.choices.length;s++){var a=document.createElement("option");a.value=this.choices[s].value,a.text=this.choices[s].title,a.setAttribute("aria-label",this.choices[s].title),this.choices[s].value==this.defaultValue&&(a.selected=!0),o.appendChild(this._selectElement,a)}return this._selectElement.onchange=function(){t.valueChanged()},this._selectElement}var l,c=et.getUniqueCategoryName();(l=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input"),l.style.width="100%",this._toggleInputs=[];for(var u=0;u<this.choices.length;u++){var p,h,d,g,f=document.createElement("input");f.id=o.generateUniqueId(),f.type="radio",f.style.margin="0",f.style.display="inline-block",f.style.verticalAlign="middle",f.name=o.isNullOrEmpty(this.id)?c:this.id,f.value=this.choices[u].value,f.style.flex="0 0 auto",f.setAttribute("aria-label",this.choices[u].title),this.choices[u].value==this.defaultValue&&(f.checked=!0),f.onchange=function(){t.valueChanged()},this._toggleInputs.push(f),(p=new b).setParent(this),p.forElementId=f.id,p.hostConfig=this.hostConfig,p.text=o.isNullOrEmpty(this.choices[u].title)?"Choice "+u:this.choices[u].title,p.useMarkdown=fe.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap,(h=p.render()).style.display="inline-block",h.style.flex="1 1 auto",h.style.marginLeft="6px",h.style.verticalAlign="middle",(d=document.createElement("div")).style.width="6px",(g=document.createElement("div")).style.display="flex",o.appendChild(g,f),o.appendChild(g,d),o.appendChild(g,h),o.appendChild(l,g)}return l},et.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},et.prototype.toJSON=function(){var t=$.prototype.toJSON.call(this);if(o.setProperty(t,"placeholder",this.placeholder),0<this.choices.length){for(var e=[],n=0,i=this.choices;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,"choices",e)}return this.isCompact||o.setProperty(t,"style","expanded",!1),o.setProperty(t,"isMultiSelect",this.isMultiSelect,!1),o.setProperty(t,"wrap",this.wrap,!1),t},et.prototype.validate=function(){var t=[];0==this.choices.length&&(t=[{error:s.ValidationError.CollectionCantBeEmpty,message:"An Input.ChoiceSet must have at least one choice defined."}]);for(var e=0;e<this.choices.length;e++)if(!this.choices[e].title||!this.choices[e].value){t=t.concat([{error:s.ValidationError.PropertyCantBeNull,message:"All choices in an Input.ChoiceSet must have their title and value properties set."}]);break}return t},et.prototype.parse=function(t,e){if($.prototype.parse.call(this,t,e),this.isCompact=!("expanded"===t.style),this.isMultiSelect=o.parseBoolProperty(t.isMultiSelect,this.isMultiSelect),this.placeholder=t.placeholder,this.choices=[],null!=t.choices)for(var n=t.choices,i=0;i<n.length;i++){var r=new Q;r.title=n[i].title,r.value=n[i].value,this.choices.push(r)}this.wrap=o.parseBoolProperty(t.wrap,this.wrap)},Object.defineProperty(et.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var t="",e=0;e<this._toggleInputs.length;e++)this._toggleInputs[e].checked&&(""!=t&&(t+=this.hostConfig.choiceSetInputValueSeparator),t+=this._toggleInputs[e].value);return""==t?null:t}if(this.isCompact)return this._selectElement?this._selectElement.value:null;if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(e=0;e<this._toggleInputs.length;e++)if(this._toggleInputs[e].checked)return this._toggleInputs[e].value;return null},enumerable:!0,configurable:!0}),et.uniqueCategoryCounter=0,et);function et(){var t=null!==$&&$.apply(this,arguments)||this;return t.choices=[],t.isCompact=!1,t.isMultiSelect=!1,t.wrap=!1,t}e.ChoiceSetInput=tt;var nt,it=(r(rt,nt=q),rt.prototype.internalRender=function(){var t=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.setAttribute("min",this.min),this._numberInputElement.setAttribute("max",this.max),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,o.isNullOrEmpty(this.defaultValue)||(this._numberInputElement.value=this.defaultValue),o.isNullOrEmpty(this.placeholder)||(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){t.valueChanged()},this._numberInputElement},rt.prototype.getJsonTypeName=function(){return"Input.Number"},rt.prototype.toJSON=function(){var t=nt.prototype.toJSON.call(this);return o.setProperty(t,"placeholder",this.placeholder),o.setProperty(t,"min",this.min),o.setProperty(t,"max",this.max),t},rt.prototype.parse=function(t,e){nt.prototype.parse.call(this,t,e),this.placeholder=t.placeholder,this.min=t.min,this.max=t.max},Object.defineProperty(rt.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.value:null},enumerable:!0,configurable:!0}),rt);function rt(){return null!==nt&&nt.apply(this,arguments)||this}e.NumberInput=it;var st,at=(r(ot,st=q),ot.prototype.internalRender=function(){return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",o.isNullOrEmpty(this.defaultValue)||(this._dateInputElement.value=this.defaultValue),this._dateInputElement},ot.prototype.getJsonTypeName=function(){return"Input.Date"},Object.defineProperty(ot.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:null},enumerable:!0,configurable:!0}),ot);function ot(){return null!==st&&st.apply(this,arguments)||this}e.DateInput=at;var lt,ct,ut,pt=(r(ht,lt=q),ht.prototype.internalRender=function(){return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",o.isNullOrEmpty(this.defaultValue)||(this._timeInputElement.value=this.defaultValue),this._timeInputElement},ht.prototype.getJsonTypeName=function(){return"Input.Time"},Object.defineProperty(ht.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:null},enumerable:!0,configurable:!0}),ht);function ht(){return null!==lt&&lt.apply(this,arguments)||this}e.TimeInput=pt,(ut=ct=ct||{})[ut.Normal=0]="Normal",ut[ut.Expanded=1]="Expanded",ut[ut.Subdued=2]="Subdued";var dt=(gt.prototype.updateCssStyle=function(){var t=this.action.parent.hostConfig;switch(this.action.renderedElement.className=t.makeCssClassName("ac-pushButton"),o.isNullOrEmpty(this._parentContainerStyle)||this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action instanceof Mt&&this.action.renderedElement.classList.add(t.makeCssClassName("expandable")),this.action.renderedElement.classList.remove(t.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(t.makeCssClassName("subdued")),this._state){case ct.Expanded:this.action.renderedElement.classList.add(t.makeCssClassName("expanded"));break;case ct.Subdued:this.action.renderedElement.classList.add(t.makeCssClassName("subdued"))}this.action.isPrimary&&this.action.renderedElement.classList.add(t.makeCssClassName("primary"))},gt.prototype.render=function(t){var e=this;this.action.render(),this.action.renderedElement.style.flex=t===s.ActionAlignment.Stretch?"0 1 100%":"0 1 auto",this.action.renderedElement.onclick=function(t){e.click()},this.updateCssStyle()},gt.prototype.click=function(){null!=this.onClick&&this.onClick(this)},Object.defineProperty(gt.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.updateCssStyle()},enumerable:!0,configurable:!0}),gt);function gt(t,e){this._state=ct.Normal,this.onClick=null,this.action=t,this._parentContainerStyle=e}var ft=(mt.prototype.setCollection=function(t){this._actionCollection=t},mt.prototype.addCssClasses=function(t){},mt.prototype.toJSON=function(){var t={};return o.setProperty(t,"type",this.getJsonTypeName()),o.setProperty(t,"id",this.id),o.setProperty(t,"title",this.title),o.setProperty(t,"iconUrl",this.iconUrl),t},mt.prototype.render=function(){var t=this.parent.hostConfig,e=document.createElement("button");e.className=t.makeCssClassName("ac-pushButton"),this.addCssClasses(e),e.setAttribute("aria-label",this.title),e.type="button",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center";var n,i=!o.isNullOrEmpty(this.title),r=document.createElement("div");r.style.overflow="hidden",r.style.textOverflow="ellipsis",t.actions.iconPlacement==s.ActionIconPlacement.AboveTitle||t.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),i&&(r.innerText=this.title),o.isNullOrEmpty(this.iconUrl)?e.classList.add("noIcon"):((n=document.createElement("img")).src=this.iconUrl,n.style.width=t.actions.iconSize+"px",n.style.height=t.actions.iconSize+"px",n.style.flex="0 0 auto",t.actions.iconPlacement==s.ActionIconPlacement.AboveTitle?(e.classList.add("iconAbove"),e.style.flexDirection="column",i&&(n.style.marginBottom="4px")):(e.classList.add("iconLeft"),i&&(n.style.marginRight="4px")),e.appendChild(n)),e.appendChild(r),this._renderedElement=e},mt.prototype.setParent=function(t){this._parent=t},mt.prototype.execute=function(){var t,e,n;this.onExecute&&this.onExecute(this),(n=(e=(t=this).parent.getRootElement())&&e.onExecuteAction?e.onExecuteAction:fe.onExecuteAction)&&(t.prepare(t.parent.getRootElement().getAllInputs()),n(t))},mt.prototype.setStatus=function(t){var e;null!=this._actionCollection&&(t?((e=new Ce).parse(t),this._actionCollection.showStatusCard(e)):this._actionCollection.hideStatusCard())},mt.prototype.validate=function(){return[]},mt.prototype.prepare=function(t){},mt.prototype.parse=function(t,e){var n,i,r,a;n=t,i=e,null!=(a=(r=this.parent?this.parent.getRootElement():null)&&r.onParseAction?r.onParseAction:fe.onParseAction)&&a(this,n,i),this.requires.parse(t.requires,e),this.id=t.id,t.title||""===t.title||ne({error:s.ValidationError.PropertyCantBeNull,message:"Actions should always have a title."},e),this.title=t.title,this.iconUrl=t.iconUrl},mt.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},mt.prototype.getAllInputs=function(){return[]},mt.prototype.getResourceInformation=function(){return o.isNullOrEmpty(this.iconUrl)?[]:[{url:this.iconUrl,mimeType:"image"}]},mt.prototype.getActionById=function(t){if(this.id==t)return this},Object.defineProperty(mt.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),mt.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.parent.hostConfig.hostCapabilities)},mt);function mt(){this._shouldFallback=!1,this._parent=null,this._actionCollection=null,this._renderedElement=null,this.requires=new l.HostCapabilities}e.Action=ft;var yt,Ct=(r(vt,yt=ft),vt.prototype.getJsonTypeName=function(){return"Action.Submit"},vt.prototype.toJSON=function(){var t=yt.prototype.toJSON.call(this);return o.setProperty(t,"data",this._originalData),t},vt.prototype.prepare=function(t){this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={};for(var e=0;e<t.length;e++)null!=t[e].value&&(this._processedData[t[e].id]=t[e].value);this._isPrepared=!0},vt.prototype.parse=function(t,e){yt.prototype.parse.call(this,t,e),this.data=t.data},Object.defineProperty(vt.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(t){this._originalData=t,this._isPrepared=!1},enumerable:!0,configurable:!0}),vt);function vt(){var t=null!==yt&&yt.apply(this,arguments)||this;return t._isPrepared=!1,t}e.SubmitAction=Ct;var At,bt=(r(xt,At=ft),xt.prototype.getJsonTypeName=function(){return"Action.OpenUrl"},xt.prototype.toJSON=function(){var t=At.prototype.toJSON.call(this);return o.setProperty(t,"url",this.url),t},xt.prototype.validate=function(){return this.url?[]:[{error:s.ValidationError.PropertyCantBeNull,message:"An Action.OpenUrl must have its url property set."}]},xt.prototype.parse=function(t,e){At.prototype.parse.call(this,t,e),this.url=t.url},xt);function xt(){return null!==At&&At.apply(this,arguments)||this}e.OpenUrlAction=bt;var It,St=(r(kt,It=ft),kt.prototype.getJsonTypeName=function(){return"Action.ToggleVisibility"},kt.prototype.execute=function(){for(var t=0,e=Object.keys(this.targetElements);t<e.length;t++){var n=e[t],i=this.parent.getRootElement().getElementById(n);i&&("boolean"==typeof this.targetElements[n]?i.isVisible=this.targetElements[n]:i.isVisible=!i.isVisible)}},kt.prototype.parse=function(t){It.prototype.parse.call(this,t),this.targetElements={};var e=t.targetElements;if(e&&Array.isArray(e))for(var n=0,i=e;n<i.length;n++){var r,s=i[n];"string"==typeof s?this.targetElements[s]=void 0:"object"!=typeof s||(r=s.elementId)&&"string"==typeof r&&(this.targetElements[r]=o.parseBoolProperty(s.isVisible,void 0))}},kt.prototype.addTargetElement=function(t,e){void 0===e&&(e=void 0),this.targetElements[t]=e},kt.prototype.removeTargetElement=function(t){delete this.targetElements[t]},kt);function kt(){var t=null!==It&&It.apply(this,arguments)||this;return t.targetElements={},t}e.ToggleVisibilityAction=St;var _t=(Et.prototype.toJSON=function(){return{name:this.name,value:this._value.getOriginal()}},Et.prototype.prepare=function(t){this._value.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(Et.prototype,"value",{get:function(){return this._value.get()},set:function(t){this._value.set(t)},enumerable:!0,configurable:!0}),Et);function Et(t,e){void 0===t&&(t=""),void 0===e&&(e=""),this._value=new a.StringWithSubstitutions,this.name=t,this.value=e}e.HttpHeader=_t;var wt,Pt=(r(Tt,wt=ft),Tt.prototype.getJsonTypeName=function(){return"Action.Http"},Tt.prototype.toJSON=function(){var t=wt.prototype.toJSON.call(this);if(o.setProperty(t,"method",this.method),o.setProperty(t,"url",this._url.getOriginal()),o.setProperty(t,"body",this._body.getOriginal()),0<this._headers.length){for(var e=[],n=0,i=this._headers;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,"headers",e)}return t},Tt.prototype.validate=function(){var t=[];if(this.url||(t=[{error:s.ValidationError.PropertyCantBeNull,message:"An Action.Http must have its url property set."}]),0<this.headers.length)for(var e=0;e<this.headers.length;e++)if(!this.headers[e].name||!this.headers[e].value){t=t.concat([{error:s.ValidationError.PropertyCantBeNull,message:"All headers of an Action.Http must have their name and value properties set."}]);break}return t},Tt.prototype.prepare=function(t){this._url.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded);for(var e=a.ContentTypes.applicationJson,n=0;n<this._headers.length;n++)this._headers[n].prepare(t),this._headers[n].name&&"content-type"==this._headers[n].name.toLowerCase()&&(e=this._headers[n].value);this._body.substituteInputValues(t,e)},Tt.prototype.parse=function(t,e){if(wt.prototype.parse.call(this,t,e),this.url=t.url,this.method=t.method,this.body=t.body,this._headers=[],null!=t.headers)for(var n=t.headers,i=0;i<n.length;i++){var r=new _t;r.name=n[i].name,r.value=n[i].value,this.headers.push(r)}},Object.defineProperty(Tt.prototype,"url",{get:function(){return this._url.get()},set:function(t){this._url.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Tt.prototype,"body",{get:function(){return this._body.get()},set:function(t){this._body.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Tt.prototype,"headers",{get:function(){return this._headers?this._headers:[]},set:function(t){this._headers=t},enumerable:!0,configurable:!0}),Tt);function Tt(){var t=null!==wt&&wt.apply(this,arguments)||this;return t._url=new a.StringWithSubstitutions,t._body=new a.StringWithSubstitutions,t._headers=[],t}e.HttpAction=Pt;var Dt,Mt=(r(Ot,Dt=ft),Ot.prototype.addCssClasses=function(t){Dt.prototype.addCssClasses.call(this,t),t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},Ot.prototype.getJsonTypeName=function(){return"Action.ShowCard"},Ot.prototype.toJSON=function(){var t=Dt.prototype.toJSON.call(this);return this.card&&o.setProperty(t,"card",this.card.toJSON()),t},Ot.prototype.validate=function(){return this.card.validate()},Ot.prototype.parse=function(t,e){Dt.prototype.parse.call(this,t,e);var n=t.card;n?this.card.parse(n,e):ne({error:s.ValidationError.PropertyCantBeNull,message:'An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},e)},Ot.prototype.setParent=function(t){Dt.prototype.setParent.call(this,t),this.card.setParent(t)},Ot.prototype.getAllInputs=function(){return this.card.getAllInputs()},Ot.prototype.getResourceInformation=function(){return Dt.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},Ot.prototype.getActionById=function(t){return Dt.prototype.getActionById.call(this,t)||this.card.getActionById(t)},Ot);function Ot(){var t=null!==Dt&&Dt.apply(this,arguments)||this;return t.card=new Ce,t}e.ShowCardAction=Mt;var Ft=(Nt.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",null===this._actionCard&&null===this._statusCard)return this._actionCardContainer.style.padding="0px",void(this._actionCardContainer.style.marginTop="0px");this._actionCardContainer.style.marginTop=0<this._renderedActionCount?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var t=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(t);var e=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(t);null!==this._actionCard&&(this._actionCard.style.paddingLeft=e.left+"px",this._actionCard.style.paddingRight=e.right+"px",this._actionCard.style.marginLeft="-"+e.left+"px",this._actionCard.style.marginRight="-"+e.right+"px",o.appendChild(this._actionCardContainer,this._actionCard)),null!==this._statusCard&&(this._statusCard.style.paddingLeft=e.left+"px",this._statusCard.style.paddingRight=e.right+"px",this._statusCard.style.marginLeft="-"+e.left+"px",this._statusCard.style.marginRight="-"+e.right+"px",o.appendChild(this._actionCardContainer,this._statusCard))},Nt.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},Nt.prototype.hideActionCard=function(){var t=this._expandedAction;this._expandedAction=null,this._actionCard=null,this.refreshContainer(),t&&(this.layoutChanged(),te(t,!1))},Nt.prototype.showActionCard=function(t,e,n){var i;void 0===e&&(e=!1),void 0===n&&(n=!0),null!=t.card&&(t.card.suppressStyle=e,i=t.card.render(),this._actionCard=i,this._expandedAction=t,this.refreshContainer(),n&&(this.layoutChanged(),te(t,!0)))},Nt.prototype.collapseExpandedAction=function(){for(var t=0;t<this.buttons.length;t++)this.buttons[t].state=ct.Normal;this.hideActionCard()},Nt.prototype.expandShowCardAction=function(t,e){for(var n=0;n<this.buttons.length;n++)this.buttons[n].action!==t?this.buttons[n].state=ct.Subdued:this.buttons[n].state=ct.Expanded;this.showActionCard(t,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),e)},Nt.prototype.actionClicked=function(t){if(t.action instanceof Mt)this.hideStatusCard(),this._owner.hostConfig.actions.showCard.actionMode===s.ShowCardActionMode.Popup?t.action.execute():t.action===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(t.action,!0);else{for(var e=0;e<this.buttons.length;e++)this.buttons[e].state=ct.Normal;this.hideStatusCard(),this.hideActionCard(),t.action.execute()}},Nt.prototype.getParentContainer=function(){return this._owner instanceof jt?this._owner:this._owner.getParentContainer()},Nt.prototype.findActionButton=function(t){for(var e=0,n=this.buttons;e<n.length;e++){var i=n[e];if(i.action==t)return i}return null},Nt.prototype.parse=function(t,e){if(this.clear(),t&&t instanceof Array)for(var n=0,i=t;n<i.length;n++){var r=i[n],s=d(this._owner,r,e);s&&this.addAction(s)}},Nt.prototype.toJSON=function(){if(0<this.items.length){for(var t=[],e=0,n=this.items;e<n.length;e++){var i=n[e];t.push(i.toJSON())}return t}return null},Nt.prototype.showStatusCard=function(t){t.setParent(this._owner),this._statusCard=t.render(),this.refreshContainer()},Nt.prototype.hideStatusCard=function(){this._statusCard=null,this.refreshContainer()},Nt.prototype.getActionById=function(t){for(var e=null,n=0;n<this.items.length&&!(e=this.items[n].getActionById(t));n++);return e},Nt.prototype.validate=function(){var t=[];this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&t.push({error:s.ValidationError.TooManyActions,message:"A maximum of "+this._owner.hostConfig.actions.maxActions+" actions are allowed."}),0<this.items.length&&!this._owner.hostConfig.supportsInteractivity&&t.push({error:s.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."});for(var e=0;e<this.items.length;e++)p(this.items[e],this._owner.getForbiddenActionTypes())||t.push({error:s.ValidationError.ActionTypeNotAllowed,message:"Actions of type "+this.items[e].getJsonTypeName()+" are not allowe."});for(e=0;e<this.items.length;e++)t=t.concat(this.items[e].validate());return t},Nt.prototype.render=function(t,e){var n=this;if(!this._owner.hostConfig.supportsInteractivity)return null;var i=document.createElement("div"),r=this._owner.hostConfig.actions.maxActions?Math.min(this._owner.hostConfig.actions.maxActions,this.items.length):this.items.length,a=this._owner.getForbiddenActionTypes();if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,this._owner.hostConfig.actions.preExpandSingleShowCardAction&&1==r&&this.items[0]instanceof Mt&&p(this.items[0],a))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var l=document.createElement("div");if(l.className=this._owner.hostConfig.makeCssClassName("ac-actionSet"),l.style.display="flex",t==s.Orientation.Horizontal)if(l.style.flexDirection="row",this._owner.horizontalAlignment&&this._owner.hostConfig.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:l.style.justifyContent="center";break;case s.HorizontalAlignment.Right:l.style.justifyContent="flex-end";break;default:l.style.justifyContent="flex-start"}else switch(this._owner.hostConfig.actions.actionAlignment){case s.ActionAlignment.Center:l.style.justifyContent="center";break;case s.ActionAlignment.Right:l.style.justifyContent="flex-end";break;default:l.style.justifyContent="flex-start"}else if(l.style.flexDirection="column",this._owner.horizontalAlignment&&this._owner.hostConfig.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:l.style.alignItems="center";break;case s.HorizontalAlignment.Right:l.style.alignItems="flex-end";break;default:l.style.alignItems="flex-start"}else switch(this._owner.hostConfig.actions.actionAlignment){case s.ActionAlignment.Center:l.style.alignItems="center";break;case s.ActionAlignment.Right:l.style.alignItems="flex-end";break;case s.ActionAlignment.Stretch:l.style.alignItems="stretch";break;default:l.style.alignItems="flex-start"}for(var c=this.getParentContainer().style,u=0;u<this.items.length;u++)if(p(this.items[u],a)){var h,d=this.findActionButton(this.items[u]);if(d||((d=new dt(this.items[u],c)).onClick=function(t){n.actionClicked(t)},this.buttons.push(d)),d.render(this._owner.hostConfig.actions.actionAlignment),l.appendChild(d.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=this._owner.hostConfig.actions.maxActions||u==this.items.length-1)break;0<this._owner.hostConfig.actions.buttonSpacing&&(h=document.createElement("div"),t===s.Orientation.Horizontal?(h.style.flex="0 0 auto",h.style.width=this._owner.hostConfig.actions.buttonSpacing+"px"):h.style.height=this._owner.hostConfig.actions.buttonSpacing+"px",o.appendChild(l,h))}var g=document.createElement("div");g.style.overflow="hidden",g.appendChild(l),o.appendChild(i,g)}for(o.appendChild(i,this._actionCardContainer),u=0;u<this.buttons.length;u++)if(this.buttons[u].state==ct.Expanded){this.expandShowCardAction(this.buttons[u].action,!1);break}return 0<this._renderedActionCount?i:null},Nt.prototype.addAction=function(t){if(!t)throw new Error("The action parameter cannot be null.");if(t.parent&&t.parent!==this._owner||!(this.items.indexOf(t)<0))throw new Error("The action already belongs to another element.");this.items.push(t),t.parent||t.setParent(this._owner),u(t,this)},Nt.prototype.removeAction=function(t){this.expandedAction&&this._expandedAction==t&&this.collapseExpandedAction();var e=this.items.indexOf(t);if(0<=e){this.items.splice(e,1),t.setParent(null),u(t,null);for(var n=0;n<this.buttons.length;n++)if(this.buttons[n].action==t){this.buttons.splice(n,1);break}return!0}return!1},Nt.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=null,this._renderedActionCount=0},Nt.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.items.length;e++){var n=this.items[e];t=t.concat(n.getAllInputs())}return t},Nt.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.items.length;e++)t=t.concat(this.items[e].getResourceInformation());return t},Object.defineProperty(Nt.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(Nt.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!0,configurable:!0}),Nt);function Nt(t){this._expandedAction=null,this._renderedActionCount=0,this._statusCard=null,this._actionCard=null,this.items=[],this.buttons=[],this._owner=t}var Rt,zt=(r(Lt,Rt=f),Lt.prototype.internalRender=function(){return this._actionCollection.render(this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},Lt.prototype.toJSON=function(){var t=Rt.prototype.toJSON.call(this);return o.setEnumProperty(s.Orientation,t,"orientation",this.orientation),o.setProperty(t,"actions",this._actionCollection.toJSON()),t},Lt.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?Rt.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},Lt.prototype.getJsonTypeName=function(){return"ActionSet"},Lt.prototype.getActionCount=function(){return this._actionCollection.items.length},Lt.prototype.getActionAt=function(t){if(0<=t&&t<this.getActionCount())return this._actionCollection.items[t];Rt.prototype.getActionAt.call(this,t)},Lt.prototype.validate=function(){return this._actionCollection.validate()},Lt.prototype.parse=function(t,e){Rt.prototype.parse.call(this,t,e);var n=t.orientation;n&&(this.orientation=o.getEnumValueOrDefault(s.Orientation,n,s.Orientation.Horizontal)),this._actionCollection.parse(t.actions,e)},Lt.prototype.addAction=function(t){this._actionCollection.addAction(t)},Lt.prototype.getAllInputs=function(){return this._actionCollection.getAllInputs()},Lt.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},Lt.prototype.renderSpeech=function(){return""},Object.defineProperty(Lt.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),Lt);function Lt(){var t=Rt.call(this)||this;return t.orientation=null,t._actionCollection=new Ft(t),t}e.ActionSet=zt;var Bt,Vt=(r(Ht,Bt=M),Ht.prototype.applyBackground=function(){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));o.isNullOrEmpty(t.backgroundColor)||(this.renderedElement.style.backgroundColor=o.stringToCssColor(t.backgroundColor))},Ht.prototype.applyPadding=function(){var t,e,n;Bt.prototype.applyPadding.call(this),this.renderedElement&&(this.isBleeding()&&(t=new a.PaddingDefinition,this.getImmediateSurroundingPadding(t),e=this.hostConfig.paddingDefinitionToSpacingDefinition(t),this.renderedElement.style.marginRight="-"+e.right+"px",this.renderedElement.style.marginLeft="-"+e.left+"px",this.separatorElement&&this.separatorOrientation==s.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+e.left+"px",this.separatorElement.style.marginRight="-"+e.right+"px")),this.isDesignMode()||((n=this.getFirstVisibleRenderedItem())&&n.isBleedingAtTop()&&(this.renderedElement.style.paddingTop="0px"),n=this.getLastVisibleRenderedItem(),(this.getHasExpandedAction()||n&&n.isBleedingAtBottom())&&(this.renderedElement.style.paddingBottom="0px")))},Ht.prototype.getHasBackground=function(){var t=this.getParentContainer();return this.hasExplicitStyle&&!!t&&t.getEffectiveStyle()!=this.getEffectiveStyle()},Ht.prototype.getHasExpandedAction=function(){return!1},Ht.prototype.getDefaultPadding=function(){return this.getHasBackground()?new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding):Bt.prototype.getDefaultPadding.call(this)},Object.defineProperty(Ht.prototype,"hasExplicitStyle",{get:function(){return null!=this._style},enumerable:!0,configurable:!0}),Object.defineProperty(Ht.prototype,"defaultStyle",{get:function(){return s.ContainerStyle.Default},enumerable:!0,configurable:!0}),Object.defineProperty(Ht.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!0,configurable:!0}),Ht.prototype.getBleed=function(){return this._bleed},Ht.prototype.setBleed=function(t){this._bleed=t},Ht.prototype.isBleeding=function(){return this.getHasBackground()&&this.getBleed()},Ht.prototype.toJSON=function(){var t=Bt.prototype.toJSON.call(this);return o.setProperty(t,"style",this.style),t},Ht.prototype.validate=function(){var t=Bt.prototype.validate.call(this);return this._style&&(this.hostConfig.containerStyles.getStyleByName(this._style)||t.push({error:s.ValidationError.InvalidPropertyValue,message:"Unknown container style: "+this._style})),t},Ht.prototype.parse=function(t,e){Bt.prototype.parse.call(this,t,e),this._style=t.style},Ht.prototype.render=function(){var t=Bt.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),t},Ht.prototype.getEffectiveStyle=function(){if(!this._style){var t=this.getParentContainer();if(t)return t.getEffectiveStyle()}return this.style?this.style:this.defaultStyle},Object.defineProperty(Ht.prototype,"style",{get:function(){return this.allowCustomStyle&&this._style&&this.hostConfig.containerStyles.getStyleByName(this._style)?this._style:null},set:function(t){this._style=t},enumerable:!0,configurable:!0}),Ht);function Ht(){var t=null!==Bt&&Bt.apply(this,arguments)||this;return t._style=null,t._bleed=!1,t}e.StylableCardElementContainer=Vt;var Ut=(qt.prototype.reset=function(){this.url=void 0,this.fillMode=qt.defaultFillMode,this.horizontalAlignment=qt.defaultHorizontalAlignment,this.verticalAlignment=qt.defaultVerticalAlignment},qt.prototype.parse=function(t,e){this.url=t.url,this.fillMode=o.getEnumValueOrDefault(s.FillMode,t.fillMode,this.fillMode),this.horizontalAlignment=o.getEnumValueOrDefault(s.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.verticalAlignment=o.getEnumValueOrDefault(s.VerticalAlignment,t.verticalAlignment,this.verticalAlignment)},qt.prototype.toJSON=function(){if(!this.isValid())return null;if(this.fillMode==qt.defaultFillMode&&this.horizontalAlignment==qt.defaultHorizontalAlignment&&this.verticalAlignment==qt.defaultVerticalAlignment)return this.url;var t={};return o.setProperty(t,"url",this.url),o.setEnumProperty(s.FillMode,t,"fillMode",this.fillMode,qt.defaultFillMode),o.setEnumProperty(s.HorizontalAlignment,t,"horizontalAlignment",this.horizontalAlignment,qt.defaultHorizontalAlignment),o.setEnumProperty(s.VerticalAlignment,t,"verticalAlignment",this.verticalAlignment,qt.defaultVerticalAlignment),t},qt.prototype.apply=function(t){if(this.url){switch(t.style.backgroundImage="url('"+this.url+"')",this.fillMode){case s.FillMode.Repeat:t.style.backgroundRepeat="repeat";break;case s.FillMode.RepeatHorizontally:t.style.backgroundRepeat="repeat-x";break;case s.FillMode.RepeatVertically:t.style.backgroundRepeat="repeat-y";break;case s.FillMode.Cover:default:t.style.backgroundRepeat="no-repeat",t.style.backgroundSize="cover"}switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.backgroundPositionX="center";break;case s.HorizontalAlignment.Right:t.style.backgroundPositionX="right"}switch(this.verticalAlignment){case s.VerticalAlignment.Center:t.style.backgroundPositionY="center";break;case s.VerticalAlignment.Bottom:t.style.backgroundPositionY="bottom"}}},qt.prototype.isValid=function(){return!o.isNullOrEmpty(this.url)},qt.defaultFillMode=s.FillMode.Cover,qt.defaultHorizontalAlignment=s.HorizontalAlignment.Left,qt.defaultVerticalAlignment=s.VerticalAlignment.Top,qt);function qt(){this.fillMode=qt.defaultFillMode,this.horizontalAlignment=qt.defaultHorizontalAlignment,this.verticalAlignment=qt.defaultVerticalAlignment}e.BackgroundImage=Ut;var Jt,jt=(r(Wt,Jt=Vt),Wt.prototype.isElementAllowed=function(t,e){if(!this.hostConfig.supportsInteractivity&&t.isInteractive)return!1;if(e)for(var n=0;n<e.length;n++)if(t.getJsonTypeName()===e[n])return!1;return!0},Wt.prototype.insertItemAt=function(t,e,n){if(t.parent&&!n)throw new Error("The element already belongs to another container.");if(!t.isStandalone)throw new Error("Elements of type "+t.getJsonTypeName()+" cannot be used as standalone elements.");e<0||e>=this._items.length?this._items.push(t):this._items.splice(e,0,t),t.setParent(this)},Wt.prototype.supportsExcplitiHeight=function(){return!0},Wt.prototype.getItemsCollectionPropertyName=function(){return"items"},Wt.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.backgroundImage.apply(this.renderedElement),Jt.prototype.applyBackground.call(this)},Wt.prototype.internalRender=function(){this._renderedItems=[];var t,e=this.hostConfig,n=document.createElement("div");switch(null!=this.rtl&&this.rtl&&(n.dir="rtl"),n.classList.add(e.makeCssClassName("ac-container")),n.style.display="flex",n.style.flexDirection="column",fe.useAdvancedCardBottomTruncation&&(n.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case s.VerticalAlignment.Center:n.style.justifyContent="center";break;case s.VerticalAlignment.Bottom:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}if(0<this._items.length)for(var i=0;i<this._items.length;i++){var r=this.isElementAllowed(this._items[i],this.getForbiddenElementTypes())?this._items[i].render():null;r&&(0<this._renderedItems.length&&this._items[i].separatorElement&&(this._items[i].separatorElement.style.flex="0 0 auto",o.appendChild(n,this._items[i].separatorElement)),o.appendChild(n,r),this._renderedItems.push(this._items[i]))}else this.isDesignMode()&&((t=this.createPlaceholderElement()).style.width="100%",t.style.height="100%",n.appendChild(t));return n},Wt.prototype.truncateOverflow=function(t){for(var e=this.renderedElement.offsetTop+t+1,n=function(t){var i=t.renderedElement;if(i)switch(o.getFitStatus(i,e)){case s.ContainerFitStatus.FullyInContainer:t.resetOverflow()&&n(t);break;case s.ContainerFitStatus.Overflowing:var r=e-i.offsetTop;t.handleOverflow(r);break;case s.ContainerFitStatus.FullyOutOfContainer:t.handleOverflow(0)}},i=0,r=this._items;i<r.length;i++){var a=r[i];n(a)}return!0},Wt.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._items;t<e.length;t++)e[t].resetOverflow()},Wt.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||Jt.prototype.getHasBackground.call(this)},Object.defineProperty(Wt.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),Wt.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);if(o.setProperty(t,"backgroundImage",this.backgroundImage.toJSON()),o.setEnumProperty(s.VerticalAlignment,t,"verticalContentAlignment",this.verticalContentAlignment,s.VerticalAlignment.Top),0<this._items.length){for(var e=[],n=0,i=this._items;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,this.getItemsCollectionPropertyName(),e)}return o.setProperty(t,"bleed",this.bleed),t},Wt.prototype.getItemCount=function(){return this._items.length},Wt.prototype.getItemAt=function(t){return this._items[t]},Wt.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&0<this._renderedItems.length)for(var t=0,e=this._renderedItems;t<e.length;t++){var n=e[t];if(n.isVisible)return n}return null},Wt.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&0<this._renderedItems.length)for(var t=this._renderedItems.length-1;0<=t;t--)if(this._renderedItems[t].isVisible)return this._renderedItems[t];return null},Wt.prototype.getJsonTypeName=function(){return"Container"},Wt.prototype.isFirstElement=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].isVisible)return this._items[e]==t;return!1},Wt.prototype.isLastElement=function(t){for(var e=this._items.length-1;0<=e;e--)if(this._items[e].isVisible)return this._items[e]==t;return!1},Wt.prototype.isRtl=function(){if(null!=this.rtl)return this.rtl;var t=this.getParentContainer();return!!t&&t.isRtl()},Wt.prototype.isBleedingAtTop=function(){var t=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!t&&t.isBleedingAtTop()},Wt.prototype.isBleedingAtBottom=function(){var t=this.getLastVisibleRenderedItem();return this.isBleeding()||!!t&&t.isBleedingAtBottom()},Wt.prototype.validate=function(){for(var t=Jt.prototype.validate.call(this),e=0;e<this._items.length;e++)!this.hostConfig.supportsInteractivity&&this._items[e].isInteractive&&t.push({error:s.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."}),this.isElementAllowed(this._items[e],this.getForbiddenElementTypes())||t.push({error:s.ValidationError.InteractivityNotAllowed,message:"Elements of type "+this._items[e].getJsonTypeName()+" are not allowed in this container."}),t=t.concat(this._items[e].validate());return t},Wt.prototype.parse=function(t,e){Jt.prototype.parse.call(this,t,e),this.setShouldFallback(!1),this._items=[],this._renderedItems=[];var n=t.backgroundImage;if(n&&(this.backgroundImage.reset(),"string"==typeof n?(this.backgroundImage.url=n,this.backgroundImage.fillMode=s.FillMode.Cover):"object"==typeof n&&this.backgroundImage.parse(n,e)),this.verticalContentAlignment=o.getEnumValueOrDefault(s.VerticalAlignment,t.verticalContentAlignment,this.verticalContentAlignment),null!=t[this.getItemsCollectionPropertyName()]){var i=t[this.getItemsCollectionPropertyName()];this.clear();for(var r=0;r<i.length;r++){var a=g(this,i[r],e);a&&this.insertItemAt(a,-1,!0)}}this.bleed=o.parseBoolProperty(t.bleed,this.bleed)},Wt.prototype.indexOf=function(t){return this._items.indexOf(t)},Wt.prototype.addItem=function(t){this.insertItemAt(t,-1,!1)},Wt.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._items.indexOf(e),!1)},Wt.prototype.insertItemAfter=function(t,e){this.insertItemAt(t,this._items.indexOf(e)+1,!1)},Wt.prototype.removeItem=function(t){var e=this._items.indexOf(t);return 0<=e&&(this._items.splice(e,1),t.setParent(null),this.updateLayout(),!0)},Wt.prototype.clear=function(){this._items=[]},Wt.prototype.getResourceInformation=function(){var t=Jt.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},Wt.prototype.getActionById=function(t){var e=Jt.prototype.getActionById.call(this,t);if(!e&&(this.selectAction&&(e=this.selectAction.getActionById(t)),!e))for(var n=0;n<this._items.length&&!(e=this._items[n].getActionById(t));n++);return e},Wt.prototype.renderSpeech=function(){if(null!=this.speak)return this.speak;var t=null;if(0<this._items.length){t="";for(var e=0;e<this._items.length;e++){var n=this._items[e].renderSpeech();n&&(t+=n)}}return t},Object.defineProperty(Wt.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Wt.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Wt.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),Wt);function Wt(){var t=null!==Jt&&Jt.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t.backgroundImage=new Ut,t.verticalContentAlignment=s.VerticalAlignment.Top,t.rtl=null,t}e.Container=jt;var Gt,Zt=(r(Yt,Gt=jt),Yt.prototype.adjustRenderedElementSize=function(t){var e;this.isDesignMode()?(t.style.minWidth="20px",t.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(t.style.minWidth="0",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?t.style.flex="0 1 auto":"stretch"===this.width?t.style.flex="1 1 50px":(e=this.width).unit==s.SizeUnit.Pixel?(t.style.flex="0 0 auto",t.style.width=e.physicalSize+"px"):t.style.flex="1 1 "+(0<this._computedWeight?this._computedWeight:e.physicalSize)+"%"},Yt.prototype.getDefaultPadding=function(){var t=this.parent,e=Gt.prototype.getDefaultPadding.call(this);return e.top=e.top==s.Spacing.None&&t.isBleedingAtTop()&&t.isAtTheVeryTop()?s.Spacing.Padding:e.top,e.right=e.right==s.Spacing.None&&t.isBleeding()&&t.isAtTheVeryRight()?s.Spacing.Padding:e.right,e.bottom=e.bottom==s.Spacing.None&&t.isBleedingAtBottom()&&t.isAtTheVeryBottom()?s.Spacing.Padding:e.bottom,e.left=e.left==s.Spacing.None&&t.isBleeding()&&t.isAtTheVeryLeft()?s.Spacing.Padding:e.left,e},Object.defineProperty(Yt.prototype,"separatorOrientation",{get:function(){return s.Orientation.Vertical},enumerable:!0,configurable:!0}),Yt.prototype.getJsonTypeName=function(){return"Column"},Yt.prototype.toJSON=function(){var t=Gt.prototype.toJSON.call(this);return this.width instanceof a.SizeAndUnit?this.width.unit==s.SizeUnit.Pixel?o.setProperty(t,"width",this.width.physicalSize+"px"):o.setProperty(t,"width",this.width.physicalSize):o.setProperty(t,"width",this.width),t},Yt.prototype.parse=function(t,e){Gt.prototype.parse.call(this,t,e);var n=t.width;void 0===n&&void 0!==(n=t.size)&&ne({error:s.ValidationError.Deprecated,message:'The "Column.size" property is deprecated and will be removed. Use the "Column.width" property instead.'},e);var i=!1;try{this.width=a.SizeAndUnit.parse(n)}catch(t){"string"!=typeof n||"auto"!==n&&"stretch"!==n?i=!0:this.width=n}i&&ne({error:s.ValidationError.InvalidPropertyValue,message:"Invalid column width:"+n+' - defaulting to "auto"'},e)},Object.defineProperty(Yt.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof Qt)&&this.separatorElement&&!this.parent.isLeftMostElement(this)},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),Yt);function Yt(t){void 0===t&&(t="auto");var e=Gt.call(this)||this;return e._computedWeight=0,e.width="auto",e.width=t,e}e.Column=Zt;var Kt,Qt=(r(Xt,Kt=Vt),Xt.prototype.internalRender=function(){if(this._renderedColumns=[],0<this._columns.length){var t=this.hostConfig,e=document.createElement("div");switch(e.className=t.makeCssClassName("ac-columnSet"),e.style.display="flex",fe.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.justifyContent="center";break;case s.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}for(var n=0,i=0,r=this._columns;i<r.length;i++)(l=r[i]).width instanceof a.SizeAndUnit&&l.width.unit==s.SizeUnit.Weight&&(n+=l.width.physicalSize);for(var l,c,u=0,p=this._columns;u<p.length;u++){(l=p[u]).width instanceof a.SizeAndUnit&&l.width.unit==s.SizeUnit.Weight&&0<n&&(c=100/n*l.width.physicalSize,l._computedWeight=c);var h=l.render();h&&(0<this._renderedColumns.length&&l.separatorElement&&(l.separatorElement.style.flex="0 0 auto",o.appendChild(e,l.separatorElement)),o.appendChild(e,h),this._renderedColumns.push(l))}return 0<this._renderedColumns.length?e:null}return null},Xt.prototype.truncateOverflow=function(t){for(var e=0,n=this._columns;e<n.length;e++)n[e].handleOverflow(t);return!0},Xt.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._columns;t<e.length;t++)e[t].resetOverflow()},Object.defineProperty(Xt.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),Xt.prototype.toJSON=function(){var t=Kt.prototype.toJSON.call(this);if(0<this._columns.length){for(var e=[],n=0,i=this._columns;n<i.length;n++){var r=i[n];e.push(r.toJSON())}o.setProperty(t,"columns",e)}return o.setProperty(t,"bleed",this.bleed),t},Xt.prototype.isFirstElement=function(t){for(var e=0;e<this._columns.length;e++)if(this._columns[e].isVisible)return this._columns[e]==t;return!1},Xt.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&0<this._renderedColumns.length)for(var t=0,e=this._columns;t<e.length;t++)if(e[t].isBleedingAtTop())return!0;return!1},Xt.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&0<this._renderedColumns.length)for(var t=0,e=this._columns;t<e.length;t++)if(e[t].isBleedingAtBottom())return!0;return!1},Xt.prototype.getCount=function(){return this._columns.length},Xt.prototype.getItemCount=function(){return this.getCount()},Xt.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&0<this._renderedColumns.length?this._renderedColumns[0]:null},Xt.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&0<this._renderedColumns.length?this._renderedColumns[this._renderedColumns.length-1]:null},Xt.prototype.getColumnAt=function(t){return this._columns[t]},Xt.prototype.getItemAt=function(t){return this.getColumnAt(t)},Xt.prototype.getJsonTypeName=function(){return"ColumnSet"},Xt.prototype.parse=function(t,e){if(Kt.prototype.parse.call(this,t,e),null!=t.columns){var n=t.columns;this._columns=[];for(var i=0;i<n.length;i++){var r=new Zt;r.setParent(this),r.parse(n[i],e),this._columns.push(r)}}this.bleed=o.parseBoolProperty(t.bleed,this.bleed)},Xt.prototype.validate=function(){for(var t=Kt.prototype.validate.call(this),e=0,n=0,i=0;i<this._columns.length;i++)"number"==typeof this._columns[i].width?e++:"stretch"===this._columns[i].width&&n++;return 0<e&&0<n&&t.push({error:s.ValidationError.Hint,message:"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}),t},Xt.prototype.addColumn=function(t){if(t.parent)throw new Error("This column already belongs to another ColumnSet.");this._columns.push(t),t.setParent(this)},Xt.prototype.removeItem=function(t){if(t instanceof Zt){var e=this._columns.indexOf(t);if(0<=e)return this._columns.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},Xt.prototype.indexOf=function(t){return t instanceof Zt?this._columns.indexOf(t):-1},Xt.prototype.isLeftMostElement=function(t){return 0==this._columns.indexOf(t)},Xt.prototype.isRightMostElement=function(t){return this._columns.indexOf(t)==this._columns.length-1},Xt.prototype.getActionById=function(t){for(var e=null,n=0;n<this._columns.length&&!(e=this._columns[n].getActionById(t));n++);return e},Xt.prototype.renderSpeech=function(){if(null!=this.speak)return this.speak;var t="";if(0<this._columns.length)for(var e=0;e<this._columns.length;e++)t+=this._columns[e].renderSpeech();return t},Object.defineProperty(Xt.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Xt.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),Xt);function Xt(){var t=null!==Kt&&Kt.apply(this,arguments)||this;return t._columns=[],t}function $t(t){var e=t.getRootElement(),n=e&&e.onImageLoaded?e.onImageLoaded:fe.onImageLoaded;n&&n(t)}function te(t,e){var n=t.parent.getRootElement(),i=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:fe.onInlineCardExpanded;i&&i(t,e)}function ee(t,e){void 0===e&&(e=!0);var n=t.getRootElement();e&&n.updateLayout();var i=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:fe.onElementVisibilityChanged;null!=i&&i(t)}function ne(t,e){e&&e.push(t),null!=fe.onParseError&&fe.onParseError(t)}e.ColumnSet=Qt;var ie,re=(r(se,ie=jt),se.prototype.internalRender=function(){var t=ie.prototype.internalRender.call(this),e=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return e&&(o.appendChild(t,o.renderSeparation({spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),lineThickness:null,lineColor:null},s.Orientation.Horizontal)),o.appendChild(t,e)),this.renderIfEmpty||0<t.children.length?t:null},se.prototype.getHasExpandedAction=function(){return 0!=this._actionCollection.renderedActionCount&&(1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction)},Object.defineProperty(se.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!0,configurable:!0}),se.prototype.toJSON=function(){var t=ie.prototype.toJSON.call(this);return o.setProperty(t,"actions",this._actionCollection.toJSON()),t},se.prototype.getActionCount=function(){return this._actionCollection.items.length},se.prototype.getActionAt=function(t){if(0<=t&&t<this.getActionCount())return this._actionCollection.items[t];ie.prototype.getActionAt.call(this,t)},se.prototype.getActionById=function(t){return this._actionCollection.getActionById(t)||ie.prototype.getActionById.call(this,t)},se.prototype.parse=function(t,e){ie.prototype.parse.call(this,t,e),this._actionCollection.parse(t.actions,e)},se.prototype.validate=function(){var t=ie.prototype.validate.call(this);return this._actionCollection&&(t=t.concat(this._actionCollection.validate())),t},se.prototype.isLastElement=function(t){return ie.prototype.isLastElement.call(this,t)&&0==this._actionCollection.items.length},se.prototype.addAction=function(t){this._actionCollection.addAction(t)},se.prototype.clear=function(){ie.prototype.clear.call(this),this._actionCollection.clear()},se.prototype.getAllInputs=function(){return ie.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs())},se.prototype.getResourceInformation=function(){return ie.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},se.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?ie.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},Object.defineProperty(se.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),se);function se(){var t=ie.call(this)||this;return t._actionCollection=new Ft(t),t}e.ContainerWithActions=re;var ae=(oe.prototype.findTypeRegistration=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return this._items[e];return null},oe.prototype.clear=function(){this._items=[]},oe.prototype.registerType=function(t,e){var n=this.findTypeRegistration(t);null!=n?n.createInstance=e:(n={typeName:t,createInstance:e},this._items.push(n))},oe.prototype.unregisterType=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return void this._items.splice(e,1)},oe.prototype.createInstance=function(t){var e=this.findTypeRegistration(t);return e?e.createInstance():null},oe.prototype.getItemCount=function(){return this._items.length},oe.prototype.getItemAt=function(t){return this._items[t]},oe);function oe(){this._items=[],this.reset()}e.TypeRegistry=ae;var le,ce=(r(ue,le=ae),ue.prototype.reset=function(){this.clear(),this.registerType("Container",(function(){return new jt})),this.registerType("TextBlock",(function(){return new C})),this.registerType("Image",(function(){return new P})),this.registerType("ImageSet",(function(){return new N})),this.registerType("Media",(function(){return new V})),this.registerType("FactSet",(function(){return new _})),this.registerType("ColumnSet",(function(){return new Qt})),this.registerType("ActionSet",(function(){return new zt})),this.registerType("Input.Text",(function(){return new W})),this.registerType("Input.Date",(function(){return new at})),this.registerType("Input.Time",(function(){return new pt})),this.registerType("Input.Number",(function(){return new it})),this.registerType("Input.ChoiceSet",(function(){return new tt})),this.registerType("Input.Toggle",(function(){return new Y}))},ue);function ue(){return null!==le&&le.apply(this,arguments)||this}e.ElementTypeRegistry=ce;var pe,he=(r(de,pe=ae),de.prototype.reset=function(){this.clear(),this.registerType("Action.OpenUrl",(function(){return new bt})),this.registerType("Action.Submit",(function(){return new Ct})),this.registerType("Action.ShowCard",(function(){return new Mt})),this.registerType("Action.ToggleVisibility",(function(){return new St}))},de);function de(){return null!==pe&&pe.apply(this,arguments)||this}e.ActionTypeRegistry=he;var ge,fe=(r(me,ge=re),Object.defineProperty(me,"processMarkdown",{get:function(){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},set:function(t){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},enumerable:!0,configurable:!0}),me.applyMarkdown=function(t){var e={didProcess:!1};return me.onProcessMarkdown?me.onProcessMarkdown(t,e):window.markdownit?(e.outputHtml=window.markdownit().render(t),e.didProcess=!0):console.warn("Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"),e},me.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||me.currentVersion.major<this.version.major||me.currentVersion.major==this.version.major&&me.currentVersion.minor<this.version.minor)},me.prototype.getItemsCollectionPropertyName=function(){return"body"},me.prototype.internalRender=function(){var t=ge.prototype.internalRender.call(this);return me.useAdvancedCardBottomTruncation&&(t.style.minHeight=null),t},me.prototype.getHasBackground=function(){return!0},me.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(me.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(me.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(me.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!0,configurable:!0}),Object.defineProperty(me.prototype,"hasBackground",{get:function(){return!0},enumerable:!0,configurable:!0}),me.prototype.getJsonTypeName=function(){return"AdaptiveCard"},me.prototype.toJSON=function(){var t=ge.prototype.toJSON.call(this);return o.setProperty(t,"$schema","http://adaptivecards.io/schemas/adaptive-card.json"),!this.bypassVersionCheck&&this.version&&o.setProperty(t,"version",this.version.toString()),o.setProperty(t,"fallbackText",this.fallbackText),o.setProperty(t,"lang",this.lang),o.setProperty(t,"speak",this.speak),t},me.prototype.validate=function(){var t=[];return"AdaptiveCard"!=this._cardTypeName&&t.push({error:s.ValidationError.MissingCardType,message:'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'}),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.push({error:s.ValidationError.UnsupportedCardVersion,message:"The specified card version ("+this.version+") is not supported. The maximum supported card version is "+me.currentVersion}):t.push({error:s.ValidationError.PropertyCantBeNull,message:"The version property must be specified."}),t.concat(ge.prototype.validate.call(this))},me.prototype.parse=function(t,e){this._fallbackCard=null,this._cardTypeName=t.type;var n=t.lang;if(n&&"string"==typeof n)try{this.lang=n}catch(t){ne({error:s.ValidationError.InvalidPropertyValue,message:t.message},e)}this.version=l.Version.parse(t.version,e),this.fallbackText=t.fallbackText;var i=g(null,t.fallback,e);i&&(this._fallbackCard=new me,this._fallbackCard.addItem(i)),ge.prototype.parse.call(this,t,e)},me.prototype.render=function(t){var e;if(this.shouldFallback())if(this._fallbackCard)this._fallbackCard.hostConfig=this.hostConfig,e=this._fallbackCard.render();else{var n=o.isNullOrEmpty(this.fallbackText)?"The card could not be rendered. It is either malformed or uses features not supported by this host.":this.fallbackText;try{var i=new me;i.hostConfig=this.hostConfig,i.parse({type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:n,wrap:!0}]}),e=i.render()}catch(t){(e=document.createElement("div")).innerHTML=n}}else(e=ge.prototype.render.call(this))&&(e.tabIndex=0,o.isNullOrEmpty(this.speak)||e.setAttribute("aria-label",this.speak));return t&&(t.appendChild(e),this.updateLayout()),e},me.prototype.updateLayout=function(t){var e,n;void 0===t&&(t=!0),ge.prototype.updateLayout.call(this,t),me.useAdvancedCardBottomTruncation&&this.isRendered()&&(e=this.renderedElement,n=this.hostConfig.getEffectiveSpacing(s.Spacing.Default),this.handleOverflow(e.offsetHeight-n))},me.prototype.shouldFallback=function(){return ge.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(me.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!0,configurable:!0}),me.currentVersion=new l.Version(1,1),me.useAdvancedTextBlockTruncation=!0,me.useAdvancedCardBottomTruncation=!1,me.useMarkdownInRadioButtonAndCheckbox=!0,me.allowMarkForTextHighlighting=!1,me.alwaysBleedSeparators=!1,me.elementTypeRegistry=new ce,me.actionTypeRegistry=new he,me.onAnchorClicked=null,me.onExecuteAction=null,me.onElementVisibilityChanged=null,me.onImageLoaded=null,me.onInlineCardExpanded=null,me.onParseElement=null,me.onParseAction=null,me.onParseError=null,me.onProcessMarkdown=null,me);function me(){var t=null!==ge&&ge.apply(this,arguments)||this;return t._cardTypeName="AdaptiveCard",t._fallbackCard=null,t.onAnchorClicked=null,t.onExecuteAction=null,t.onElementVisibilityChanged=null,t.onImageLoaded=null,t.onInlineCardExpanded=null,t.onParseElement=null,t.onParseAction=null,t.version=new l.Version(1,0),t.designMode=!1,t}e.AdaptiveCard=fe;var ye,Ce=(r(ve,ye=fe),ve.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding,this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(ve.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ve.prototype,"defaultStyle",{get:function(){return this.suppressStyle?s.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:s.ContainerStyle.Emphasis},enumerable:!0,configurable:!0}),ve.prototype.render=function(t){var e=ye.prototype.render.call(this,t);return e.setAttribute("aria-live","polite"),e.removeAttribute("tabindex"),e},ve.prototype.getForbiddenActionTypes=function(){return[Mt]},ve);function ve(){var t=null!==ye&&ye.apply(this,arguments)||this;return t.suppressStyle=!1,t}var Ae=new l.HostConfig({supportsInteractivity:!0,fontFamily:"Segoe UI",spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:s.Spacing.Default,buttonSpacing:10,showCard:{actionMode:s.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:s.Orientation.Horizontal,actionAlignment:s.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:s.Size.Medium,maxImageHeight:100},factSet:{title:{color:s.TextColor.Default,size:s.TextSize.Default,isSubtle:!1,weight:s.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:s.TextColor.Default,size:s.TextSize.Default,isSubtle:!1,weight:s.TextWeight.Default,wrap:!0},spacing:10}})},"./src/enums.ts":function(t,e,n){"use strict";var i,r,s,a,o,l,c,u,p,h,d,g,f,m,y;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.Size||(e.Size={}))[i.Auto=0]="Auto",i[i.Stretch=1]="Stretch",i[i.Small=2]="Small",i[i.Medium=3]="Medium",i[i.Large=4]="Large",(r=e.SizeUnit||(e.SizeUnit={}))[r.Weight=0]="Weight",r[r.Pixel=1]="Pixel",(s=e.TextSize||(e.TextSize={}))[s.Small=0]="Small",s[s.Default=1]="Default",s[s.Medium=2]="Medium",s[s.Large=3]="Large",s[s.ExtraLarge=4]="ExtraLarge",(a=e.Spacing||(e.Spacing={}))[a.None=0]="None",a[a.Small=1]="Small",a[a.Default=2]="Default",a[a.Medium=3]="Medium",a[a.Large=4]="Large",a[a.ExtraLarge=5]="ExtraLarge",a[a.Padding=6]="Padding",(o=e.TextWeight||(e.TextWeight={}))[o.Lighter=0]="Lighter",o[o.Default=1]="Default",o[o.Bolder=2]="Bolder",(l=e.TextColor||(e.TextColor={}))[l.Default=0]="Default",l[l.Dark=1]="Dark",l[l.Light=2]="Light",l[l.Accent=3]="Accent",l[l.Good=4]="Good",l[l.Warning=5]="Warning",l[l.Attention=6]="Attention",(c=e.HorizontalAlignment||(e.HorizontalAlignment={}))[c.Left=0]="Left",c[c.Center=1]="Center",c[c.Right=2]="Right",(u=e.VerticalAlignment||(e.VerticalAlignment={}))[u.Top=0]="Top",u[u.Center=1]="Center",u[u.Bottom=2]="Bottom",(p=e.ActionAlignment||(e.ActionAlignment={}))[p.Left=0]="Left",p[p.Center=1]="Center",p[p.Right=2]="Right",p[p.Stretch=3]="Stretch",(h=e.ImageStyle||(e.ImageStyle={}))[h.Default=0]="Default",h[h.Person=1]="Person",(d=e.ShowCardActionMode||(e.ShowCardActionMode={}))[d.Inline=0]="Inline",d[d.Popup=1]="Popup",(g=e.Orientation||(e.Orientation={}))[g.Horizontal=0]="Horizontal",g[g.Vertical=1]="Vertical",(f=e.FillMode||(e.FillMode={}))[f.Cover=0]="Cover",f[f.RepeatHorizontally=1]="RepeatHorizontally",f[f.RepeatVertically=2]="RepeatVertically",f[f.Repeat=3]="Repeat",(m=e.ActionIconPlacement||(e.ActionIconPlacement={}))[m.LeftOfTitle=0]="LeftOfTitle",m[m.AboveTitle=1]="AboveTitle",(y=e.InputTextStyle||(e.InputTextStyle={}))[y.Text=0]="Text",y[y.Tel=1]="Tel",y[y.Url=2]="Url",y[y.Email=3]="Email";var C,v,A=(b.Default="default",b.Emphasis="emphasis",b);function b(){}e.ContainerStyle=A,(C=e.ValidationError||(e.ValidationError={}))[C.Hint=0]="Hint",C[C.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",C[C.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",C[C.Deprecated=3]="Deprecated",C[C.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",C[C.InteractivityNotAllowed=5]="InteractivityNotAllowed",C[C.InvalidPropertyValue=6]="InvalidPropertyValue",C[C.MissingCardType=7]="MissingCardType",C[C.PropertyCantBeNull=8]="PropertyCantBeNull",C[C.TooManyActions=9]="TooManyActions",C[C.UnknownActionType=10]="UnknownActionType",C[C.UnknownElementType=11]="UnknownElementType",C[C.UnsupportedCardVersion=12]="UnsupportedCardVersion",(v=e.ContainerFitStatus||(e.ContainerFitStatus={}))[v.FullyInContainer=0]="FullyInContainer",v[v.Overflowing=1]="Overflowing",v[v.FullyOutOfContainer=2]="FullyOutOfContainer"},"./src/host-config.ts":function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n("./src/enums.ts"),a=n("./src/utils.ts"),o=n("./src/shared.ts"),l=function(t){this.default="#000000",this.subtle="#666666",t&&(this.default=t.default||this.default,this.subtle=t.subtle||this.subtle)};e.TextColorDefinition=l;var c=function(t){this.allowCustomStyle=!1,t&&(this.allowCustomStyle=t.allowCustomStyle||this.allowCustomStyle)};e.AdaptiveCardConfig=c;var u=(p.prototype.toJSON=function(){return{imageSize:s.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},p);function p(t){this.imageSize=s.Size.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=a.getValueOrDefault(t.maxImageHeight,100))}e.ImageSetConfig=u;var h=(d.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},d);function d(t){this.allowInlinePlayback=!0,t&&(this.defaultPoster=t.defaultPoster,this.allowInlinePlayback=t.allowInlinePlayback||this.allowInlinePlayback)}e.MediaConfig=h;var g=(f.prototype.getDefaultWeight=function(){return s.TextWeight.Default},f.prototype.toJSON=function(){return{size:s.TextSize[this.size],color:s.TextColor[this.color],isSubtle:this.isSubtle,weight:s.TextWeight[this.weight],wrap:this.wrap}},f);function f(t){this.size=s.TextSize.Default,this.color=s.TextColor.Default,this.isSubtle=!1,this.weight=s.TextWeight.Default,this.wrap=!0,t&&(this.size=a.parseHostConfigEnum(s.TextSize,t.size,s.TextSize.Default),this.color=a.parseHostConfigEnum(s.TextColor,t.color,s.TextColor.Default),this.isSubtle=t.isSubtle||this.isSubtle,this.weight=a.parseHostConfigEnum(s.TextWeight,t.weight,this.getDefaultWeight()),this.wrap=null!=t.wrap?t.wrap:this.wrap)}e.FactTextDefinition=g;var m,y=(r(C,m=g),C.prototype.getDefaultWeight=function(){return s.TextWeight.Bolder},C);function C(t){var e=m.call(this,t)||this;return e.maxWidth=150,e.weight=s.TextWeight.Bolder,t&&(e.maxWidth=null!=t.maxWidth?t.maxWidth:e.maxWidth,e.weight=a.parseHostConfigEnum(s.TextWeight,t.weight,s.TextWeight.Bolder)),e}e.FactTitleDefinition=y;var v=function(t){this.title=new y,this.value=new g,this.spacing=10,t&&(this.title=new y(t.title),this.value=new g(t.value),this.spacing=t.spacing&&null!=t.spacing?t.spacing&&t.spacing:this.spacing)};e.FactSetConfig=v;var A=(b.prototype.toJSON=function(){return{actionMode:s.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},b);function b(t){this.actionMode=s.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=s.ContainerStyle.Emphasis,t&&(this.actionMode=a.parseHostConfigEnum(s.ShowCardActionMode,t.actionMode,s.ShowCardActionMode.Inline),this.inlineTopMargin=null!=t.inlineTopMargin?t.inlineTopMargin:this.inlineTopMargin,this.style=t.style&&"string"==typeof t.style?t.style:s.ContainerStyle.Emphasis)}e.ShowCardActionConfig=A;var x=(I.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:s.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:s.Orientation[this.actionsOrientation],actionAlignment:s.ActionAlignment[this.actionAlignment]}},I);function I(t){if(this.maxActions=5,this.spacing=s.Spacing.Default,this.buttonSpacing=20,this.showCard=new A,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=s.Orientation.Horizontal,this.actionAlignment=s.ActionAlignment.Left,this.iconPlacement=s.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=24,t){this.maxActions=null!=t.maxActions?t.maxActions:this.maxActions,this.spacing=a.parseHostConfigEnum(s.Spacing,t.spacing&&t.spacing,s.Spacing.Default),this.buttonSpacing=null!=t.buttonSpacing?t.buttonSpacing:this.buttonSpacing,this.showCard=new A(t.showCard),this.preExpandSingleShowCardAction=a.getValueOrDefault(t.preExpandSingleShowCardAction,!1),this.actionsOrientation=a.parseHostConfigEnum(s.Orientation,t.actionsOrientation,s.Orientation.Horizontal),this.actionAlignment=a.parseHostConfigEnum(s.ActionAlignment,t.actionAlignment,s.ActionAlignment.Left),this.iconPlacement=a.parseHostConfigEnum(s.ActionIconPlacement,t.iconPlacement,s.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=t.allowTitleToWrap?t.allowTitleToWrap:this.allowTitleToWrap;try{var e=o.SizeAndUnit.parse(t.iconSize);e.unit==s.SizeUnit.Pixel&&(this.iconSize=e.physicalSize)}catch(t){}}}e.ActionsConfig=x;var S=(k.prototype.getTextColorDefinitionOrDefault=function(t,e){return new l(t||e)},k.prototype.parse=function(t){t&&(this.backgroundColor=t.backgroundColor,t.foregroundColors&&(this.foregroundColors.default=this.getTextColorDefinitionOrDefault(t.foregroundColors.default,{default:"#333333",subtle:"#EE333333"}),this.foregroundColors.dark=this.getTextColorDefinitionOrDefault(t.foregroundColors.dark,{default:"#000000",subtle:"#66000000"}),this.foregroundColors.light=this.getTextColorDefinitionOrDefault(t.foregroundColors.light,{default:"#FFFFFF",subtle:"#33000000"}),this.foregroundColors.accent=this.getTextColorDefinitionOrDefault(t.foregroundColors.accent,{default:"#2E89FC",subtle:"#882E89FC"}),this.foregroundColors.good=this.getTextColorDefinitionOrDefault(t.foregroundColors.good,{default:"#54A254",subtle:"#DD54A254"}),this.foregroundColors.warning=this.getTextColorDefinitionOrDefault(t.foregroundColors.warning,{default:"#E69500",subtle:"#DDE69500"}),this.foregroundColors.attention=this.getTextColorDefinitionOrDefault(t.foregroundColors.attention,{default:"#CC3300",subtle:"#DDCC3300"})),this.highlightBackgroundColor=t.highlightBackgroundColor,this.highlightForegroundColor=t.highlightForegroundColor)},Object.defineProperty(k.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!0,configurable:!0}),k);function k(t){this.foregroundColors={default:new l,dark:new l,light:new l,accent:new l,good:new l,warning:new l,attention:new l},this.parse(t)}e.ContainerStyleDefinition=S;var _,E=(r(w,_=S),Object.defineProperty(w.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!0,configurable:!0}),w);function w(){return null!==_&&_.apply(this,arguments)||this}var P=(T.prototype.toJSON=function(){var t=this,e=[];Object.keys(this._allStyles).forEach((function(n){t._allStyles[n].isBuiltIn||e.push({name:n,style:t._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return 0<e.length&&(n.customStyles=e),n},T.prototype.getStyleByName=function(t,e){return void 0===e&&(e=null),this._allStyles.hasOwnProperty(t)?this._allStyles[t]:e},Object.defineProperty(T.prototype,"default",{get:function(){return this._allStyles[s.ContainerStyle.Default]},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"emphasis",{get:function(){return this._allStyles[s.ContainerStyle.Emphasis]},enumerable:!0,configurable:!0}),T);function T(t){if(this._allStyles={},this._allStyles[s.ContainerStyle.Default]=new E,this._allStyles[s.ContainerStyle.Emphasis]=new E,t){this._allStyles[s.ContainerStyle.Default].parse(t[s.ContainerStyle.Default]),this._allStyles[s.ContainerStyle.Emphasis].parse(t[s.ContainerStyle.Emphasis]);var e=t.customStyles;if(e&&Array.isArray(e))for(var n=0,i=e;n<i.length;n++){var r,a=i[n];!a||(r=a.name)&&"string"==typeof r&&(this._allStyles.hasOwnProperty(r)?this._allStyles[r].parse(a.style):this._allStyles[r]=new S(a.style))}}}e.ContainerStyleSet=P;var D=(M.parse=function(t,e){if(!t)return null;var n=new M;n._versionString=t;var i=/(\d+).(\d+)/gi.exec(t);return null!=i&&3==i.length?(n._major=parseInt(i[1]),n._minor=parseInt(i[2])):n._isValid=!1,!n._isValid&&e&&e.push({error:s.ValidationError.InvalidPropertyValue,message:"Invalid version string: "+n._versionString}),n},M.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},M.prototype.compareTo=function(t){if(!this.isValid||!t.isValid)throw new Error("Cannot compare invalid version.");return this.major>t.major?1:this.major<t.major?-1:this.minor>t.minor?1:this.minor<t.minor?-1:0},Object.defineProperty(M.prototype,"major",{get:function(){return this._major},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"minor",{get:function(){return this._minor},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,configurable:!0}),M);function M(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this._isValid=!0,this._major=t,this._minor=e}e.Version=D;var O=(F.prototype.setCapability=function(t,e){this.capabilities||(this.capabilities={}),this.capabilities[t]=e},F.prototype.parse=function(t,e){if(t)for(var n in t){var i,r=t[n];"string"==typeof r&&("*"==r?this.setCapability(n,"*"):(i=D.parse(r,e)).isValid&&this.setCapability(n,i))}},F.prototype.hasCapability=function(t,e){return!(!this.capabilities||!this.capabilities.hasOwnProperty(t))&&("*"==e||"*"==this.capabilities[t]||e.compareTo(this.capabilities[t])<=0)},F.prototype.areAllMet=function(t){if(this.capabilities)for(var e in this.capabilities)if(!t.hasCapability(e,this.capabilities[e]))return!1;return!0},F);function F(){this.capabilities=null}e.HostCapabilities=O;var N=(R.prototype.getEffectiveSpacing=function(t){switch(t){case s.Spacing.Small:return this.spacing.small;case s.Spacing.Default:return this.spacing.default;case s.Spacing.Medium:return this.spacing.medium;case s.Spacing.Large:return this.spacing.large;case s.Spacing.ExtraLarge:return this.spacing.extraLarge;case s.Spacing.Padding:return this.spacing.padding;default:return 0}},R.prototype.paddingDefinitionToSpacingDefinition=function(t){return new o.SpacingDefinition(this.getEffectiveSpacing(t.top),this.getEffectiveSpacing(t.right),this.getEffectiveSpacing(t.bottom),this.getEffectiveSpacing(t.left))},R.prototype.makeCssClassName=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",i=0;i<t.length;i++)0<i&&(n+=" "),this.cssClassNamePrefix&&(n+=this.cssClassNamePrefix+"-"),n+=t[i];return n},R);function R(t){this.hostCapabilities=new O,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new P,this.actions=new x,this.adaptiveCard=new c,this.imageSet=new u,this.media=new h,this.factSet=new v,this.cssClassNamePrefix=null,t&&(("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),this.choiceSetInputValueSeparator=t&&"string"==typeof t.choiceSetInputValueSeparator?t.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=t&&"boolean"==typeof t.supportsInteractivity?t.supportsInteractivity:this.supportsInteractivity,this.fontFamily=t.fontFamily||this.fontFamily,this.fontSizes={small:t.fontSizes&&t.fontSizes.small||this.fontSizes.small,default:t.fontSizes&&t.fontSizes.default||this.fontSizes.default,medium:t.fontSizes&&t.fontSizes.medium||this.fontSizes.medium,large:t.fontSizes&&t.fontSizes.large||this.fontSizes.large,extraLarge:t.fontSizes&&t.fontSizes.extraLarge||this.fontSizes.extraLarge},t.lineHeights&&(this.lineHeights={small:t.lineHeights.small,default:t.lineHeights.default,medium:t.lineHeights.medium,large:t.lineHeights.large,extraLarge:t.lineHeights.extraLarge}),this.fontWeights={lighter:t.fontWeights&&t.fontWeights.lighter||this.fontWeights.lighter,default:t.fontWeights&&t.fontWeights.default||this.fontWeights.default,bolder:t.fontWeights&&t.fontWeights.bolder||this.fontWeights.bolder},this.imageSizes={small:t.imageSizes&&t.imageSizes.small||this.imageSizes.small,medium:t.imageSizes&&t.imageSizes.medium||this.imageSizes.medium,large:t.imageSizes&&t.imageSizes.large||this.imageSizes.large},this.containerStyles=new P(t.containerStyles),this.spacing={small:t.spacing&&t.spacing.small||this.spacing.small,default:t.spacing&&t.spacing.default||this.spacing.default,medium:t.spacing&&t.spacing.medium||this.spacing.medium,large:t.spacing&&t.spacing.large||this.spacing.large,extraLarge:t.spacing&&t.spacing.extraLarge||this.spacing.extraLarge,padding:t.spacing&&t.spacing.padding||this.spacing.padding},this.separator={lineThickness:t.separator&&t.separator.lineThickness||this.separator.lineThickness,lineColor:t.separator&&t.separator.lineColor||this.separator.lineColor},this.actions=new x(t.actions||this.actions),this.adaptiveCard=new c(t.adaptiveCard||this.adaptiveCard),this.imageSet=new u(t.imageSet),this.factSet=new v(t.factSet))}e.HostConfig=N},"./src/shared.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/enums.ts");e.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var r=(s.prototype.substituteInputValues=function(t,n){this._processed=this._original;for(var i,r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;null!=(i=r.exec(this._original));){for(var s,a=null,o=0;o<t.length;o++)if(t[o].id.toLowerCase()==i[1].toLowerCase()){a=t[o];break}a&&(s="",a.value&&(s=a.value),n===e.ContentTypes.applicationJson?s=(s=JSON.stringify(s)).slice(1,-1):n===e.ContentTypes.applicationXWwwFormUrlencoded&&(s=encodeURIComponent(s)),this._processed=this._processed.replace(i[0],s))}this._isProcessed=!0},s.prototype.getOriginal=function(){return this._original},s.prototype.get=function(){return this._isProcessed?this._processed:this._original},s.prototype.set=function(t){this._original=t,this._isProcessed=!1},s);function s(){this._isProcessed=!1,this._original=null,this._processed=null}e.StringWithSubstitutions=r,e.SpacingDefinition=function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=t,this.right=e,this.bottom=n,this.left=i},e.PaddingDefinition=function(t,e,n,r){void 0===t&&(t=i.Spacing.None),void 0===e&&(e=i.Spacing.None),void 0===n&&(n=i.Spacing.None),void 0===r&&(r=i.Spacing.None),this.top=i.Spacing.None,this.right=i.Spacing.None,this.bottom=i.Spacing.None,this.left=i.Spacing.None,this.top=t,this.right=e,this.bottom=n,this.left=r};var a=(o.parse=function(t,e){void 0===e&&(e=!1);var n=new o(0,i.SizeUnit.Weight),r=/^([0-9]+)(px|\*)?$/g.exec(t),s=e?3:2;if(r&&r.length>=s)return n.physicalSize=parseInt(r[1]),3==r.length&&"px"==r[2]&&(n.unit=i.SizeUnit.Pixel),n;throw new Error("Invalid size: "+t)},o);function o(t,e){this.physicalSize=t,this.unit=e}e.SizeAndUnit=a;var l=(c.generate=function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return c.lut[255&t]+c.lut[t>>8&255]+c.lut[t>>16&255]+c.lut[t>>24&255]+"-"+c.lut[255&e]+c.lut[e>>8&255]+"-"+c.lut[e>>16&15|64]+c.lut[e>>24&255]+"-"+c.lut[63&n|128]+c.lut[n>>8&255]+"-"+c.lut[n>>16&255]+c.lut[n>>24&255]+c.lut[255&i]+c.lut[i>>8&255]+c.lut[i>>16&255]+c.lut[i>>24&255]},c.initialize=function(){for(var t=0;t<256;t++)c.lut[t]=(t<16?"0":"")+t.toString(16)},c.lut=[],c);function c(){}(e.UUID=l).initialize()},"./src/text-formatters.ts":function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=(a.prototype.format=function(t,e){for(var n,i=e;null!=(n=this._regularExpression.exec(e));)i=i.replace(n[0],this.internalFormat(t,n));return i},a);function a(t){this._regularExpression=t}var o,l=(r(c,o=s),c.prototype.internalFormat=function(t,e){var n=new Date(Date.parse(e[1])),i=null!=e[2]?e[2].toLowerCase():"compact";return"compact"!=i?n.toLocaleDateString(t,{day:"numeric",weekday:i,month:i,year:"numeric"}):n.toLocaleDateString()},c);function c(){return null!==o&&o.apply(this,arguments)||this}var u,p=(r(h,u=s),h.prototype.internalFormat=function(t,e){return new Date(Date.parse(e[1])).toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})},h);function h(){return null!==u&&u.apply(this,arguments)||this}e.formatText=function(t,e){for(var n=[new l(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new p(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],i=e,r=0;r<n.length;r++)i=n[r].format(t,i);return i}},"./src/utils.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("./src/enums.ts"),r=n("./src/shared.ts");function s(t,e){return t||e}function a(t){return null==t||""===t}function o(t,e,n){if(a(e))return n;for(var i in t)if(0<=parseInt(i,10)){var r=t[i];if(r&&"string"==typeof r&&r.toLowerCase()===e.toLowerCase())return parseInt(i,10)}return n}function l(t){var e=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(t);if(e&&e[4]){var n=parseInt(e[1],16)/255;return"rgba("+parseInt(e[2],16)+","+parseInt(e[3],16)+","+parseInt(e[4],16)+","+n+")"}return t}function c(t,e){for(e+=1;e<t.length&&"<"==t[e];)for(;e<t.length&&">"!=t[e++];);return e}e.generateUniqueId=function(){return"__ac-"+r.UUID.generate()},e.getValueOrDefault=s,e.isNullOrEmpty=a,e.appendChild=function(t,e){null!=e&&null!=e&&t.appendChild(e)},e.setProperty=function(t,e,n,i){void 0===i&&(i=void 0),!n||i&&i===n||(t[e]=n)},e.setEnumProperty=function(t,e,n,i,r){void 0!==r&&r===i||(e[n]=t[i])},e.parseBoolProperty=function(t,e){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;default:return e}return e},e.getEnumValueOrDefault=o,e.parseHostConfigEnum=function(t,e,n){return"string"==typeof e?o(t,e,n):"number"==typeof e?s(e,n):n},e.renderSeparation=function(t,e){if(0<t.spacing||0<t.lineThickness){var n=document.createElement("div");return n.className="ac-"+(e==i.Orientation.Horizontal?"horizontal":"vertical")+"-separator",e==i.Orientation.Horizontal?t.lineThickness?(n.style.paddingTop=t.spacing/2+"px",n.style.marginBottom=t.spacing/2+"px",n.style.borderBottom=t.lineThickness+"px solid "+l(t.lineColor)):n.style.height=t.spacing+"px":t.lineThickness?(n.style.paddingLeft=t.spacing/2+"px",n.style.marginRight=t.spacing/2+"px",n.style.borderRight=t.lineThickness+"px solid "+l(t.lineColor)):n.style.width=t.spacing+"px",n.style.overflow="hidden",n}return null},e.stringToCssColor=l,e.truncate=function(t,e,n){function i(){return-1<=e-t.scrollHeight}if(!i()){for(var r=t.innerHTML,s=function(e){t.innerHTML=r.substring(0,e)+"..."},a=function(t){for(var e=[],n=c(t,-1);n<t.length;)" "==t[n]&&e.push(n),n=c(t,n);return e}(r),o=0,l=a.length,u=0;o<l;){var p=Math.floor((o+l)/2);s(a[p]),i()?(u=a[p],o=p+1):l=p}if(s(u),n&&e-t.scrollHeight>=n-1){for(var h=c(r,u);h<r.length&&(s(h),i());)h=c(r,u=h);s(u)}}},e.getFitStatus=function(t,e){var n=t.offsetTop;return n+t.clientHeight<=e?i.ContainerFitStatus.FullyInContainer:n<e?i.ContainerFitStatus.Overflowing:i.ContainerFitStatus.FullyOutOfContainer}}},t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s="./src/adaptivecards.ts");function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var e,n}()},function(t,e,n){"use strict";t.exports=n(17)},function(t,e,n){"use strict";t.exports.encode=n(18),t.exports.decode=n(19),t.exports.format=n(20),t.exports.parse=n(21)},function(t,e){t.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},function(t,e){t.exports=/[\0-\x1F\x7F-\x9F]/},function(t,e){t.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},function(t,e,n){"use strict";var i="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",r="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",s=new RegExp("^(?:"+i+"|"+r+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),a=new RegExp("^(?:"+i+"|"+r+")");t.exports.HTML_TAG_RE=s,t.exports.HTML_OPEN_CLOSE_TAG_RE=a},function(t,e,n){"use strict";t.exports.tokenize=function(t,e){var n,i,r,s,a=t.pos,o=t.src.charCodeAt(a);if(e)return!1;if(126!==o)return!1;if(r=(i=t.scanDelims(t.pos,!0)).length,s=String.fromCharCode(o),r<2)return!1;for(r%2&&(t.push("text","",0).content=s,r--),n=0;n<r;n+=2)t.push("text","",0).content=s+s,t.delimiters.push({marker:o,jump:n,token:t.tokens.length-1,level:t.level,end:-1,open:i.can_open,close:i.can_close});return t.pos+=i.length,!0},t.exports.postProcess=function(t){var e,n,i,r,s,a=[],o=t.delimiters,l=t.delimiters.length;for(e=0;e<l;e++)126===(i=o[e]).marker&&-1!==i.end&&(r=o[i.end],(s=t.tokens[i.token]).type="s_open",s.tag="s",s.nesting=1,s.markup="~~",s.content="",(s=t.tokens[r.token]).type="s_close",s.tag="s",s.nesting=-1,s.markup="~~",s.content="","text"===t.tokens[r.token-1].type&&"~"===t.tokens[r.token-1].content&&a.push(r.token-1));for(;a.length;){for(n=(e=a.pop())+1;n<t.tokens.length&&"s_close"===t.tokens[n].type;)n++;e!==--n&&(s=t.tokens[n],t.tokens[n]=t.tokens[e],t.tokens[e]=s)}}},function(t,e,n){"use strict";t.exports.tokenize=function(t,e){var n,i,r=t.pos,s=t.src.charCodeAt(r);if(e)return!1;if(95!==s&&42!==s)return!1;for(i=t.scanDelims(t.pos,42===s),n=0;n<i.length;n++)t.push("text","",0).content=String.fromCharCode(s),t.delimiters.push({marker:s,length:i.length,jump:n,token:t.tokens.length-1,level:t.level,end:-1,open:i.can_open,close:i.can_close});return t.pos+=i.length,!0},t.exports.postProcess=function(t){var e,n,i,r,s,a,o=t.delimiters;for(e=t.delimiters.length-1;e>=0;e--)95!==(n=o[e]).marker&&42!==n.marker||-1!==n.end&&(i=o[n.end],a=e>0&&o[e-1].end===n.end+1&&o[e-1].token===n.token-1&&o[n.end+1].token===i.token+1&&o[e-1].marker===n.marker,s=String.fromCharCode(n.marker),(r=t.tokens[n.token]).type=a?"strong_open":"em_open",r.tag=a?"strong":"em",r.nesting=1,r.markup=a?s+s:s,r.content="",(r=t.tokens[i.token]).type=a?"strong_close":"em_close",r.tag=a?"strong":"em",r.nesting=-1,r.markup=a?s+s:s,r.content="",a&&(t.tokens[o[e-1].token].content="",t.tokens[o[n.end+1].token].content="",e--))}},function(t,e,n){class i{}i.Constants={ActionCardAction:"actioncard",ActionId:"actionId",ActionsProperty:"actions",ActivityImageProperty:"activityImage",ActivityImageStyleProperty:"activityImageStyle",ActivityImageTypeProperty:"activityImageType",ActivitySubtitleProperty:"activitySubtitle",ActivityTextProperty:"activityText",ActivityTitleProperty:"activityTitle",AdaptiveCard:"adaptiveCard",AdaptiveCardSerializedProperty:"AdaptiveCardSerialized",AddInId:"addInId",AndroidClient:"android",AuthenticationUrl:"authenticationUrl",AutoInvokeAction:"autoInvokeAction",AutoInvokeOptions:"autoInvokeOptions",BackgroundColor:"backgroundColor",BackgroundImage:"backgroundImage",BodyContentTypeProperty:"bodyContentType",BodyProperty:"body",Bottom:"bottom",ChoiceSetInput:"ChoiceSetInput",ChoicesProperty:"choices",ClientTelemetry:"clientTelemetry",ClientType:"clientType",ClientVersion:"clientVersion",ConstrainWidth:"constrainWidth",CompactProperty:"compact",ConnectedAccountNotErrorString:"ConnectedAccountNotFoundError",ConnectorLoginLinkId:"ConnectorLoginActionId",ConnectorMessage:"connectorMessage",ConnectorSenderGuidProperty:"ConnectorSenderGuid",connectorSenderGuidProperty:"connectorSenderGuid",ConsentPromptDisplayed:"ConsentPromptDisplayed",ConversationId:"conversationId",Culture:"culture",DataProperty:"data",DateInput:"dateinput",DefaultStyle:"default",DesktopCommandId:"desktopCommandId",DisplayAppointmentFormAction:"action.displayappointmentform",DisplayId:"displayId",DisplayMessageFormAction:"action.displaymessageform",DisplayMessageProperty:"displayMessage",DisplayProperty:"display",ElementId:"elementId",ErrorCode:"errorCode",ErrorProperty:"error",Errors:"errors",EnableBodyTogglingProperty:"enableBodyToggling",Expanded:"expanded",EventName:"eventName",FactSet:"FactSet",FactsProperty:"facts",GroupMailbox:"Group",HasSucceeded:"hasSucceeded",HeadersProperty:"headers",HeroImageProperty:"heroImage",HideCardOnInvokeProperty:"hideCardOnInvoke",HideCardProperty:"hideCard",HideOriginalBodyProperty:"hideOriginalBody",Href:"href",HttpAction:"HttpAction",HttpForbiddenCode:"403",HttpPostAction:"httppost",HttpStatusCodeProperty:"httpStatusCode",HttpUnauthorizedCode:"401",IdProperty:"@id",IncludeTimeProperty:"includeTime",InitializationContext:"initializationContext",ImageProperty:"image",ImageSet:"ImageSet",ImagesProperty:"images",IncludeTimeProperty:"includeTime",InnerErrorCodeProperty:"innerErrorCode",InputIdProperty:"id",InputsProperty:"inputs",InvokeAddinCommandAction:"invokeaddincommand",InvokeAuthFlow:"invokeAuthFlow",IOsClient:"iOS",IsAdaptiveCardAction:"isAdaptiveCardAction",IsAutoInvokeAction:"isAutoInvokeAction",IsGroupEscalationMessage:"isGroupEscalationMessage",IsVisible:"isVisible",IsMoreAction:"isMoreAction",IsEphemeralRefreshCardProperty:"isEphemeralRefreshCard",IsMultiSelectProperty:"isMultiSelect",IsMultilineProperty:"isMultiline",IsPrimaryAction:"isPrimary",IsRetryFlow:"isRetryFlow",IsRequiredProperty:"isRequired",IsShowCardExpanded:"isShowCardExpanded",IsHttpPostActionAvailableProperty:"isHttpPostActionAvailable",ItemId:"itemId",Left:"left",MacClient:"mac",MailboxType:"mailboxType",MarkdownProperty:"markdown",MaxLengthProperty:"maxLength",MerchantId:"merchantId",MessageCardSerializedProperty:"MessageCardSerialized",MessageCardContextProperty:"messageCardContext",MessageCardExtensionContextProperty:"MessageCardExtensionContext",messageCardExtensionContextProperty:"messageCardExtensionContext",MessageCardHidden:"MessageCardHidden",MessageCardRemoved:"MessageCardRemoved",MessageCardRendered:"MessageCardRendered",MessageId:"messageId",MessageProperty:"message",MessageType:"messageType",MoreAction:"MoreAction",MultiChoiceInput:"multichoiceinput",NameProperty:"name",HeightProperty:"height",OpenUriAction:"openuri",OriginatorProperty:"originator",Padding:"padding",PerformedAtProperty:"performedAt",PerformedActionsProperty:"performedActions",PerformedActionsSerializedProperty:"PerformedActionsSerialized",PixelWidth:"pixelWidth",PlaceHolderProperty:"placeholder",PostId:"postId",PotentialActionProperty:"potentialAction",ProductContext:"productContext",ProviderAccountUniqueId:"ProviderAccountUniqueId",providerAccountUniqueId:"providerAccountUniqueId",RefreshCardSerializedProperty:"refreshCardSerialized",CardUpdatesProperty:"cardUpdates",ReplaceElementAction:"ReplaceElement",RemoveElementAction:"RemoveElement",Response:"response",Resources:"resources",ResponseSerialized:"responseSerialized",RemoveCardProperty:"removeCard",Right:"right",SectionsProperty:"sections",Separator:"separator",ShowCardOnFailure:"showCardOnFailure",ShowOriginalCardProperty:"showOriginalCard",SizeProperty:"size",SourceProperty:"source",StartGroupProperty:"startGroup",StatusProperty:"status",StyleProperty:"style",SummaryProperty:"summary",TargetDomId:"targetDom",TargetElements:"targetElements",TargetProperty:"target",TargetsProperty:"targets",TextInput:"textinput",TextProperty:"text",ThemeColorProperty:"themeColor",ThreadId:"threadId",TimeZone:"timeZone",TitleProperty:"title",ToggleVisibilityClicked:"ToggleVisibilityActionClick",Top:"top",TypeProperty:"@type",UiCulture:"uiCulture",Url:"url",UserMailbox:"User",UserPerformedActionsProperty:"userPerformedActions",ValueProperty:"value",ViewAction:"viewaction",WinClient:"windows",RTL:"rtl",InitialCardProcessing:"InitialCardProcessing",FinalCardProcessing:"FinalCardProcessing",InitialCardRendering:"InitialCardRendering",FinalCardRendering:"FinalCardRendering",ShowCardCloseButtonAriaLabel:"Click here to close the {title} dialog",InputParameters:"InputParameters",DialogParameters:"DialogParameters",SupportedCardUpdateElementTypes:["ActionSet","ChoiceSetInput","Column","ColumnSet","Container","DateInput","FactSet","Image","ImageSet","NumberInput","TextBlock","TextInput","TimeInput","ToggleInput"],OpenInBrowser:" Opens in a browser window",DateInputConstants:{SelectedDate:"selectedDate",SelectedDateWithTimeZone:"selectedDateWithTimeZone"}},i.getImageProxyUrl=function(t,e,n,i){return e&&t&&0!==t.toLowerCase().indexOf(n)&&0!==t.toLowerCase().indexOf(i)&&(0===t.toLowerCase().indexOf("http://")||0===t.toLowerCase().indexOf("https://"))?i+escape(t):t},i.getAttachmentImageProxyUrl=function(t,e,n,i){return e&&t&&0===t.toLowerCase().indexOf(n)?i+escape(t):t},i.format=function(t,...e){if(t){var n=e,i=/[{}]/g;return t.replace(/\{\d+\}/g,(function(t){let e=n[t.replace(i,"")];return null==e&&(e=""),e}))}},i.htmlDecode=function(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value},i.formatDate=function(t){if(!t)return null;var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=new Date(t),r=n.getFullYear(),s=(t=n.getDate(),["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][n.getDay()]);e=e[n.getMonth()];return i.format("{0}, {1} {2}, {3}",s,e,t,r)},i.replaceAll=function(t,e,n){return t.replace(new RegExp(e,"g"),n)},i.applyCSS=function(t){var e=document.head,n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.appendChild(n)},e.Utils=i},function(t,e,n){var i=null,r=13;window.markdownit=n(15),window.AdaptiveCards=n(4);class s{constructor(t,e=null){try{this.logTimeStamp("constructor-start");const r=n(72).initialize;this.ClientManagerClass=n(75).ClientManager,e&&e.isDarkMode?n(!function(){var t=new Error("Cannot find module './windows/message-card-dark-mode.css'");throw t.code="MODULE_NOT_FOUND",t}()):n(92),this.MessageCardConverterClass=n(108).MessageCardConverter,this.UtilsClass=n(13).Utils,r(),this.clientManagerInstance=new this.ClientManagerClass(e),i=this,this.context=e,this.constants=this.UtilsClass.Constants,this.clientManagerInstance.supportSavingState&&this.context&&this.onRestoreInstanceState(this.context.messageId,this.context.isShowCardJson),this.messageCardConverterInstance=new this.MessageCardConverterClass(this.clientManagerInstance,this.UtilsClass),this.targetDom=t,this.currentAction=this.constants.InitialCardProcessing,this.isAutoInvokeSpinnerVisible=!1,null!=i&&(this.clientManagerInstance.supportInlineShowCard&&(AdaptiveCards.AdaptiveCard.onInlineCardExpanded=function(t,e){i.onInlineCardExpanded(t,e)}),AdaptiveCards.AdaptiveCard.onExecuteAction=function(t){i.onExecuteAction(t)},AdaptiveCards.AdaptiveCard.onParseElement=function(t,e){i.onParseElement(t,e)},AdaptiveCards.AdaptiveCard.onParseAction=function(t,e){i.onParseAction(t,e)},AdaptiveCards.AdaptiveCard.onAnchorClicked=function(t,e){return i.onAnchorClicked(t,e)},AdaptiveCards.AdaptiveCard.onImageLoaded=function(t){i.onImageLoaded(t)},AdaptiveCards.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox=!1,AdaptiveCards.AdaptiveCard.alwaysBleedSeparators=!0,AdaptiveCards.AdaptiveCard.allowMarkForTextHighlighting=!0),this.WorkingStatusMessage="Working on it",this.ActionFailureStatusMessage="Action could not be completed.",this.ActionSuccessStatusMessage="The action completed successfully.",this.ACFailureStatusMessage="Something went wrong. Please try again later.",this.PleaseLoginContinueMessage="LOG IN",this.OutlookBaseUrl="https://outlook.office.com",this.logTimeStamp("constructor-end")}catch(t){if(console.log(t.message),console.log(t.stack),null==this.clientManagerInstance)throw t;this.clientManagerInstance.logException(t)}}renderCard(t){try{if(this.logTimeStamp("renderCard-start"),this.extendedPropertyJson=this.clientManagerInstance.processData(t),console.log(JSON.stringify(this.extendedPropertyJson)),this.allPerformedActions=[],null!=this.extendedPropertyJson[this.constants.AdaptiveCardSerializedProperty])this.adaptiveCardJson=JSON.parse(this.extendedPropertyJson[this.constants.AdaptiveCardSerializedProperty]),this.generateAdaptiveCardInstance(!1);else if(null!=this.context&&!0===this.context.isShowCardJson&&"AdaptiveCard"==this.extendedPropertyJson.type){this.adaptiveCardJson=this.extendedPropertyJson,this.adaptiveCardJson.version=this.context.version;var e=document.querySelector(this.targetDom);null!=e&&(e.style.padding="0px",e.style.border="0px",e.classList.add("ac-showCard")),this.generateAdaptiveCardInstance(!0)}else if("AdaptiveCard"==this.extendedPropertyJson.type)this.adaptiveCardJson=this.extendedPropertyJson,this.generateAdaptiveCardInstance(!1);else if(this.clientManagerInstance.supportMessageCard&&null!=this.extendedPropertyJson[this.constants.MessageCardSerializedProperty]){if(this.messageCardJson=JSON.parse(this.extendedPropertyJson[this.constants.MessageCardSerializedProperty]),null!=this.extendedPropertyJson[this.constants.PerformedActionsSerializedProperty]){for(var n=JSON.parse(this.extendedPropertyJson[this.constants.PerformedActionsSerializedProperty])[this.constants.UserPerformedActionsProperty],r=0;r<n.length;r++)this.allPerformedActions=this.allPerformedActions.concat(n[r][this.constants.PerformedActionsProperty]);this.allPerformedActions.sort(i.sortFunction)}this.convertToAdaptiveCardInstance(!1)}else"MessageCard"==this.extendedPropertyJson.type&&(this.messageCardJson=this.extendedPropertyJson,this.convertToAdaptiveCardInstance(!1));this.logTimeStamp("renderCard-end")}catch(t){console.log(t.message),console.log(t.stack),this.clientManagerInstance.logException(t),this.setCardVisible(!1)}}convertToAdaptiveCardInstance(t){this.logTimeStamp("conversion-start"),this.adaptiveCardInstance=this.messageCardConverterInstance.parseMessageCard(this.messageCardJson),this.logTimeStamp("conversion-end"),this.httpActionList=[];var e=!0;this.imagesCount=this.adaptiveCardInstance.imagesCount,this.populateClientTelemetryObject(),this.clientManagerInstance.storeClientTelemetryProperties(this.clientTelemetryJson),!1===t&&null!=this.adaptiveCardInstance.autoInvokeAction&&!0===this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke&&(e=!1);var n=this.getRenderedAdaptiveCard();this.currentAction===this.constants.InitialCardProcessing?(this.clientManagerInstance.logInitialCardProcessingEnd(),this.currentAction=this.constants.InitialCardRendering):this.currentAction===this.constants.FinalCardProcessing&&(this.clientManagerInstance.logFinalCardProcessingEnd(),this.currentAction=this.constants.FinalCardRendering),null==n?(this.setCardVisible(!1),this.currentAction===this.constants.InitialCardRendering?(this.clientManagerInstance.logInitialCardRenderingEnd(),!0!==this.ignoreAutoInvokeAction&&void 0!==this.adaptiveCardInstance.autoInvokeAction||this.clientManagerInstance.logFinalCardRenderingEnd()):this.currentAction===this.constants.FinalCardRendering&&(this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction="")):(this.setCardVisible(e),this.renderAsHtml(n)),!1===t&&null!=this.adaptiveCardInstance.autoInvokeAction&&this.onExecuteAction(this.adaptiveCardInstance.autoInvokeAction)}generateAdaptiveCardInstance(t){this.logTimeStamp("conversion-start"),this.adaptiveCardInstance=new AdaptiveCards.AdaptiveCard,this.adaptiveCardInstance.hideOriginalBody=this.adaptiveCardJson[this.constants.HideOriginalBodyProperty]||!1,this.adaptiveCardInstance.enableBodyToggling=this.adaptiveCardJson[this.constants.EnableBodyTogglingProperty]||!1,this.adaptiveCardInstance.isHttpPostActionAvailable=!1,this.adaptiveCardInstance.isConstrainWidth=void 0===this.adaptiveCardJson[this.constants.ConstrainWidth]||this.adaptiveCardJson[this.constants.ConstrainWidth],this.adaptiveCardInstance.rtl=this.adaptiveCardJson[this.constants.RTL]||!1,null!=this.adaptiveCardJson[this.constants.MessageCardContextProperty]&&(this.adaptiveCardInstance.messageCardContext=this.adaptiveCardJson[this.constants.MessageCardContextProperty]),null!=this.adaptiveCardJson[this.constants.OriginatorProperty]&&(this.adaptiveCardInstance.originator=this.adaptiveCardJson[this.constants.OriginatorProperty]);var e=!0;if(this.httpActionList=[],this.openUrlList=[],this.imagesCount=0,this.adaptiveCardInstance.hostConfig=new AdaptiveCards.HostConfig(this.clientManagerInstance.getACHostConfigs(this.context)[0]),this.context&&this.context.hostCapabilities)try{var n=new AdaptiveCards.HostCapabilities;n.parse(this.context.hostCapabilities,null),this.adaptiveCardInstance.hostConfig.hostCapabilities=n}catch(t){console.log(t.message)}else this.clientManagerInstance.capabilities&&(this.adaptiveCardInstance.hostConfig.hostCapabilities=this.clientManagerInstance.capabilities);if(this.adaptiveCardInstance.parse(this.adaptiveCardJson),!this.adaptiveCardInstance.isVersionSupported())throw"Adaptive card Version not supported";null!=this.adaptiveCardJson[this.constants.AutoInvokeAction]&&(this.adaptiveCardInstance.autoInvokeAction=this.createActionInstance("Action.Http",this.adaptiveCardInstance),this.adaptiveCardInstance.autoInvokeAction.setParent(this.adaptiveCardInstance),this.adaptiveCardInstance.autoInvokeAction.parse(this.adaptiveCardJson[this.constants.AutoInvokeAction]),this.adaptiveCardInstance.autoInvokeAction.isAutoInvokeAction=!0),null!=this.adaptiveCardJson[this.constants.AutoInvokeOptions]&&(this.adaptiveCardInstance.autoInvokeOptions=this.adaptiveCardJson[this.constants.AutoInvokeOptions]),!1===t&&null!=this.adaptiveCardInstance.autoInvokeAction&&!0===this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke&&(e=!1),this.logTimeStamp("conversion-end"),null!=this.context&&(null==this.context||void 0!==this.context.isShowCardJson&&!1!==this.context.isShowCardJson)||(this.populateClientTelemetryObject(),this.clientManagerInstance.storeClientTelemetryProperties(this.clientTelemetryJson));var i=this.getRenderedAdaptiveCard();if(this.currentAction===this.constants.InitialCardProcessing?(this.clientManagerInstance.logInitialCardProcessingEnd(),this.currentAction=this.constants.InitialCardRendering):this.currentAction===this.constants.FinalCardProcessing&&(this.clientManagerInstance.logFinalCardProcessingEnd(),this.currentAction=this.constants.FinalCardRendering),this.adaptiveCardJson&&this.adaptiveCardJson.requires&&this.adaptiveCardInstance.hostConfig.hostCapabilities){var r=this.adaptiveCardJson.requires,s=new AdaptiveCards.HostCapabilities;s.parse(r,null),s.areAllMet(this.adaptiveCardInstance.hostConfig.hostCapabilities)||(i=null)}null==i?(this.setCardVisible(!1),this.currentAction===this.constants.InitialCardRendering?(this.clientManagerInstance.logInitialCardRenderingEnd(),!0!==this.ignoreAutoInvokeAction&&void 0!==this.adaptiveCardInstance.autoInvokeAction||this.clientManagerInstance.logFinalCardRenderingEnd()):this.currentAction===this.constants.FinalCardRendering&&(this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction="")):(this.setCardVisible(e),this.renderAsHtml(i)),!1===t&&null!=this.adaptiveCardInstance.autoInvokeAction&&this.adaptiveCardInstance.autoInvokeAction.execute()}sortFunction(t,e){return t[i.constants.performedAtProperty]>e[i.constants.performedAtProperty]?1:e[i.constants.performedAtProperty]>t[i.constants.performedAtProperty]?-1:0}showStatusMessage(t,e,n,i){if(null!=n._items)for(var r=0;r<n._items.length;r++)if(this.showStatusMessage(t,e,n._items[r],i))return!0;if(n instanceof AdaptiveCards.ActionSet&&null!=n._actionCollection&&null!=n._actionCollection.items)for(r=0;r<n._actionCollection.items.length;r++)if(this.showStatusMessage(t,e,n._actionCollection.items[r],i))return!0;if(n instanceof AdaptiveCards.ShowCardAction&&null!=n.card&&null!=n.card._items)for(r=0;r<n.card._items.length;r++)if(this.showStatusMessage(t,e,n.card._items[r],!1))return n.setStatus(e),!0;return n instanceof AdaptiveCards.Action&&null!=n.id&&n.id===t&&(!0===i&&n.setStatus(e),!0)}populateClientTelemetryObject(){this.clientTelemetryJson={};var t="00000000-0000-0000-0000-000000000000";this.extendedPropertyJson[this.constants.ConnectorSenderGuidProperty]&&(t=this.extendedPropertyJson[this.constants.ConnectorSenderGuidProperty]),this.clientTelemetryJson[this.constants.connectorSenderGuidProperty]=t,this.extendedPropertyJson[this.constants.ProviderAccountUniqueId]&&(this.clientTelemetryJson[this.constants.providerAccountUniqueId]=this.extendedPropertyJson[this.constants.ProviderAccountUniqueId]),this.clientTelemetryJson[this.constants.IsHttpPostActionAvailableProperty]=this.adaptiveCardInstance.isHttpPostActionAvailable,this.adaptiveCardInstance.messageCardContext&&(this.clientTelemetryJson[this.constants.MessageCardContextProperty]=this.adaptiveCardInstance.messageCardContext),this.extendedPropertyJson[this.constants.MessageCardExtensionContextProperty]&&(this.clientTelemetryJson[this.constants.messageCardExtensionContextProperty]=this.extendedPropertyJson[this.constants.MessageCardExtensionContextProperty]),null!=this.adaptiveCardInstance&&null!=this.messageCardJson?this.clientTelemetryJson[this.constants.MessageType]=this.constants.ConnectorMessage:null!=this.adaptiveCardInstance&&(this.clientTelemetryJson[this.constants.MessageType]=this.constants.AdaptiveCard),null!=this.adaptiveCardInstance.originator&&(this.clientTelemetryJson[this.constants.OriginatorProperty]=this.adaptiveCardInstance.originator)}renderAsHtml(t){var e=document.querySelector(this.targetDom);e&&t&&(e.innerHTML="",e.appendChild(t),this.allInputInstances=this.adaptiveCardInstance.getAllInputs(),this.handleInputValueChanged(this.allInputInstances),this.adaptiveCardInstance.updateLayout());for(var n=0;n<this.allPerformedActions.length;n++){var i=this.allPerformedActions[n];null!=i[this.constants.DisplayMessageProperty]&&null!=i[this.constants.ActionId]&&this.showStatusMessage(i[this.constants.ActionId],this.getStatusMessageJson(i[this.constants.DisplayMessageProperty]),this.adaptiveCardInstance,!0)}this.addOpenUrlIcon(),this.clientManagerInstance.postRender(),this.currentAction===this.constants.InitialCardRendering?(this.clientManagerInstance.logInitialCardRenderingEnd(),!0!==this.ignoreAutoInvokeAction&&void 0!==this.adaptiveCardInstance.autoInvokeAction||this.clientManagerInstance.logFinalCardRenderingEnd()):this.currentAction===this.constants.FinalCardRendering&&(this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction="")}handleActionsIncaseOfAutoInvoke(){const t=document.getElementsByClassName("ac-pushButton");t&&(Array.from(t).map(t=>t.disabled=this.isAutoInvokeSpinnerVisible),this.addOpenUrlIcon())}addOpenUrlIcon(){if(this.openUrlList)for(let a=0;a<this.openUrlList.length;a++){var t=this.openUrlList[a].renderedElement;if(t&&t.classList&&t.innerText){var e=t.innerText;if(t.innerText="",null===t.querySelector("#openUrlButton")){var n=document.createElement("span");n.id="iconDummyOpenUrl",n.classList.add("iconDummyOpenUrl"),n.style.display="inline-block",n.innerText=" ",t.appendChild(n);var i=document.createElement("span");i.id="openUrlButton",i.classList.add("openUrlButton"),i.style.margin="auto",i.innerText=e,i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",t.appendChild(i);var r=e;r=r.concat(this.constants.OpenInBrowser),t.setAttribute("aria-label",r);var s=document.createElement("span");s.id="iconOpenUrl",s.style.display="inline-block",s.innerText=" ",t.appendChild(s),1==t.disabled?s.classList.add("ac-openUrlIconDisabled"):1===this.clientManagerInstance.actionButtonsCount||this.openUrlList[a].isPrimary?s.classList.add("ac-openUrlIconNonPrimary"):s.classList.add("ac-openUrlIconPrimary")}}}}displayErrorMessage(t){if(!t.isAutoInvokeAction&&t.data)for(var e=0;e<t.data.length;e++)if(t.data[e].validationErrors&&t.data[e].validationErrors.length>0)return this.clientManagerInstance.displaySnackMessage(t.data[e].validationErrors[0].message,!1),!0;return!1}displayMessageFromClient(t,e){this.clientManagerInstance.displaySnackMessage(t,e)}showAutoInvokeSpinner(){this.isAutoInvokeSpinnerVisible=!0,this.handleActionsIncaseOfAutoInvoke();let t=document.querySelector(this.targetDom),e=document.createElement("div");e.className="ac-overlay-spinner",t.parentElement.prepend(e),this.NofifyHeightChangeForWindows();var n=6e3;this.context&&this.context.spinnerTimeout&&"number"==typeof this.context.spinnerTimeout&&(n=this.context.spinnerTimeout),setTimeout((function(){i.hideAutoInvokeSpinner()}),n)}hideAutoInvokeSpinner(){this.isAutoInvokeSpinnerVisible=!1,this.handleActionsIncaseOfAutoInvoke(),this.allInputInstances&&this.handleInputValueChanged(this.allInputInstances);let t=document.getElementsByClassName("ac-overlay-spinner")[0];t&&t.parentNode.removeChild(t),this.NofifyHeightChangeForWindows()}onInlineCardExpanded(t,e){if(t instanceof AdaptiveCards.ShowCardAction){if(e&&t.card&&t.card._renderedElement){let e=t._actionCollection;if(e&&e._owner.hostConfig.actions.preExpandSingleShowCardAction){if(1===(e._owner.hostConfig.actions.maxActions?Math.min(e._owner.hostConfig.actions.maxActions,e.items.length):e.items.length))return}this.showCardActionRef=t;var n=t.card._renderedElement,s=document.createElement("div");s.className="inlineExpandedShowCard",s.id="inlineExpandedShowCard";var a=document.createElement("div");a.className="showCardHeaderDiv";var o=document.createElement("div");o.className="showCardHeaderTitle",o.innerHTML=t.title,a.appendChild(o);var l=document.createElement("div");l.className="showCardCloseButton",l.setAttribute("role","button"),l.tabIndex=0,l.addEventListener("keydown",(function(t){t.keyCode===r&&t.currentTarget.click()}));var c=this.constants.ShowCardCloseButtonAriaLabel;c=c.replace(/{title}/g,t.title),l.setAttribute("aria-label",c);var u=i;for(l.onclick=function(){u.CollapseExpandedShowCardDialog()},a.appendChild(l),s.appendChild(a);n.hasChildNodes();)s.appendChild(n.firstChild);n.style.padding="0px",n.appendChild(s);var p=document.querySelectorAll(".ac-pushButton"),h=document.getElementById("inlineExpandedShowCard");Array.prototype.forEach.call(p,(function(t){if(h&&!h.contains(t)){if(t.querySelector("#openUrlButton")){var e=t.querySelector("#iconOpenUrl");e.classList=null,e.classList.add("ac-openUrlIconDisabled")}t.disabled=!0}})),this.addOpenUrlIcon(),this.handleInputValueChanged(this.allInputInstances),this.NofifyHeightChangeForWindows()}this.clientManagerInstance.executeShowCardAction(t,null!=this.adaptiveCardJson,e)}}onExecuteAction(t){this.displayErrorMessage(t)||(t.isAutoInvokeAction&&this.showAutoInvokeSpinner(),null!=this.messageCardJson?this.onExecuteMessageCardAction(t):null!=this.adaptiveCardJson&&this.onExecuteAdaptiveCardAction(t))}onExecuteMessageCardAction(t){var e=null;if(null!=t.renderedElement&&"button"===t.renderedElement.type&&(e="button",this.addOpenUrlIcon()),!this.previousActionExecuting){if(this.actionNeedsSpinner(t)&&(this.previousActionExecuting=!0,this.previousAction=t,null!=t.renderedElement&&"button"===t.renderedElement.type)){for(var n=0;n<t.renderedElement.children.length;n++)t.renderedElement.children[n].style.visibility="hidden";var i=document.createElement("div");i.className="ac-spinner",i.style.position="absolute",t.renderedElement.appendChild(i),t.renderedElement.setAttribute("aria-live","assertive"),t.renderedElement.setAttribute("aria-label","loading"),t.renderedElement.setAttribute("aria-relevant","additions")}this.clientManagerInstance.executeAction(t,!1,e)}}onExecuteAdaptiveCardAction(t){var e=null;if(null!=t.renderedElement&&"button"===t.renderedElement.type?(e="button",1==this.clientManagerInstance.actionButtonsCount&&t.renderedElement.classList.add("primary"),this.addOpenUrlIcon()):t.parent instanceof AdaptiveCards.TextBlock?e="inline":t.isAutoInvokeAction||(e="selectAction"),!this.previousActionExecuting){if(this.clientManagerInstance.MoreActionClass&&t instanceof this.clientManagerInstance.MoreActionClass?this.previousAction=t:this.actionNeedsSpinner(t)&&(this.previousActionExecuting=!0,this.previousAction=t),this.actionNeedsSpinner(t))if(null!=t.renderedElement&&"button"===t.renderedElement.type){for(var n=0;n<t.renderedElement.children.length;n++)t.renderedElement.children[n].style.visibility="hidden";var i=document.createElement("div");i.className="ac-spinner",i.style.position="absolute",t.renderedElement.appendChild(i),t.renderedElement.setAttribute("aria-live","assertive"),t.renderedElement.setAttribute("aria-label","loading"),t.renderedElement.setAttribute("aria-relevant","additions")}else if(t.parent instanceof AdaptiveCards.TextBlock||t.parent instanceof AdaptiveCards.Image||t.parent instanceof AdaptiveCards.ColumnSet||t.parent instanceof AdaptiveCards.Column||t.parent instanceof AdaptiveCards.Container){var r=document.createElement("div");r.className="ac-overlayDiv",r.style.width="16px",r.style.height="16px",r.style.position="absolute",r.style.margin="auto",r.style.left="0px",r.style.right="0px",r.style.top="0px",r.style.bottom="0px";var s=document.createElement("div");s.className="ac-spinner",s.classList.add("ac-inline-spinner"),s.style.width="14px",s.style.height="14px",r.appendChild(s);var a=t.parent.renderedElement;t.parent instanceof AdaptiveCards.Image&&(a=t.parent.renderedElement.children[0]);var o=a.childNodes;for(n=0;n<o.length;n++)o[n].style&&(o[n].style.opacity=.25);a.appendChild(r),a.style.position="relative"}this.clientManagerInstance.executeAction(t,!0,e)}}addInputParameters(t){var e={};if(this.context){let t=this.context.inputParameters;if(t)for(let n=0;n<t.length;n++)e[t[n].id]=t[n].value}var n=this.adaptiveCardInstance.getAllInputs();if(n)for(var i=0;i<n.length;i++){var r=null;if(null!=n[i].value){r=n[i].actualValue?n[i].actualValue:n[i].value;var s=n[i].validate?n[i].validate():null,a={id:n[i].id,value:r};s&&s.length>0&&(a.validationErrors=s),e[a.id]=a.value}}for(var o in t.data=[],e)t.data.push({id:o,value:e[o]})}onParseElement(t,e){try{"boolean"==typeof e[this.constants.IsVisible]&&(t.isVisible=e[this.constants.IsVisible]);var n=t.getJsonTypeName();if("Image"===n&&(this.imagesCount++,t.backgroundColor=e[this.constants.BackgroundColor],e[this.constants.Url]=this.UtilsClass.getImageProxyUrl(e[this.constants.Url],this.clientManagerInstance.supportImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.getImageProxyUrl()),e[this.constants.Url]=this.UtilsClass.getAttachmentImageProxyUrl(e[this.constants.Url],this.clientManagerInstance.supportAttachmentImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.imageAttachmentProxyUrl)),"BackgroundImage"===n&&(this.imagesCount++,e[this.constants.Url]=this.UtilsClass.getImageProxyUrl(e[this.constants.Url],this.clientManagerInstance.supportImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.getImageProxyUrl()),e[this.constants.Url]=this.UtilsClass.getAttachmentImageProxyUrl(e[this.constants.Url],this.clientManagerInstance.supportAttachmentImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.imageAttachmentProxyUrl)),t instanceof AdaptiveCards.Input&&(t.isRequired=e[this.constants.IsRequiredProperty]||!1,t.onValueChanged=i.onInputValueChanged),t instanceof AdaptiveCards.DateInput&&(t.placeholder=e[this.constants.PlaceHolderProperty]),t instanceof AdaptiveCards.ChoiceSetInput&&(t.choiceList=e[this.constants.ChoicesProperty]),t instanceof AdaptiveCards.Container||t instanceof AdaptiveCards.ColumnSet){var r=e[this.constants.Padding];if(r)if("string"==typeof r){var s=AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Spacing,r,AdaptiveCards.Spacing.None);t.padding=new AdaptiveCards.PaddingDefinition(s,s,s,s)}else"object"==typeof r&&(t.padding=new AdaptiveCards.PaddingDefinition(AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Spacing,r[this.constants.Top],AdaptiveCards.Spacing.None),AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Spacing,r[this.constants.Right],AdaptiveCards.Spacing.None),AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Spacing,r[this.constants.Bottom],AdaptiveCards.Spacing.None),AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Spacing,r[this.constants.Left],AdaptiveCards.Spacing.None)))}if((t instanceof AdaptiveCards.ContainerWithActions||t instanceof AdaptiveCards.ActionSet)&&!0===i.clientManagerInstance.supportMoreAction){var a=e[this.constants.ActionsProperty],o=a.length;if(a.length>2&&"Action.More"!==a[a.length-1].type){var l={type:"Action.More",title:o-1+" More Actions",actions:a.splice(1)};a.push(l),e[this.constants.ActionsProperty]=a}}}catch(t){this.clientManagerInstance.logException(t)}}onParseAction(t,e){try{t instanceof AdaptiveCards.OpenUrlAction&&this.openUrlList.push(t),t.potentialAction=e,t.isAutoInvokeAction=!1,t.hideCardOnInvoke=e[this.constants.HideCardOnInvokeProperty]||!1,t.isPrimary=e[this.constants.IsPrimaryAction]||!1,t instanceof AdaptiveCards.HttpAction&&(this.httpActionList.push(t),this.adaptiveCardInstance.isHttpPostActionAvailable=!0)}catch(t){this.clientManagerInstance.logException(t)}}onInputValueChanged(t){t.placeHolderElement&&(t.placeHolderElement.style.display=t.value?"block":"none"),!1!==t.isRequired&&i.handleInputValueChanged(i.allInputInstances)}handleInputValueChanged(t){for(var e in this.logTimeStamp("handleInputValueChanged-start"),this.httpActionList){var n=this.httpActionList[e];if(n.renderedElement){var i=n.inputIds,r=!0;for(var s in i){var a=null,o=null;for(var l in t)if(i[s]===t[l].id){o=t[l],a=t[l].value;break}if(null!==o&&(!1!==o.isRequired&&!0===o.isRequired&&0==(r=o instanceof AdaptiveCards.ToggleInput&&o._checkboxInputElement?o._checkboxInputElement.checked:o instanceof AdaptiveCards.NumberInput?o.ValueInRange(o.value):!this.StringIsNullOrEmpty(a))))break}if(!1===r)n.renderedElement.disabled=!0;else{document.getElementById("inlineExpandedShowCard");n.renderedElement.disabled=!1}}}this.logTimeStamp("handleInputValueChanged-end")}onAnchorClicked(t,e){var n=e[this.constants.Href]||"";if(0===n.toLowerCase().indexOf("action:")){var i=n.split(":")[1];if(i===this.constants.ConnectorLoginLinkId)return this.clientManagerInstance.executePleaseLoginAction(this.ConnectorsLoginUrl),!0;var r=this.findInlineActionById(i,t);return null!=r&&(r.execute(),!0)}}onImageLoaded(t){this.imagesCount&&(this.imagesCount--,0===this.imagesCount&&this.clientManagerInstance.notifyHeightChange())}findInlineActionById(t,e){var n=null;if(null==t)return n;var i=this.adaptiveCardJson[this.constants.Resources];if(null===i)return n;var r=i[this.constants.ActionsProperty];if(null==r)return n;for(var s=0;s<r.length;s++)if(r[s].id===t){var a=r[s];(n=this.createActionInstance(a.type,e))&&n.parse(a);break}return n}setCardVisible(t){!1===t?this.clientManagerInstance.setComponentVisibility(!1,!1,!0,!1):this.clientManagerInstance.setComponentVisibility(!0,this.adaptiveCardInstance.enableBodyToggling,!this.adaptiveCardInstance.hideOriginalBody,this.adaptiveCardInstance.isConstrainWidth)}showMoreActionWorkingStatus(){if(null!=this.adaptiveCardJson){this.previousAction&&(this.previousActionExecuting=!0);for(var t=0;t<this.previousAction.renderedElement.children.length;t++)this.previousAction.renderedElement.children[t].style.visibility="hidden";var e=document.createElement("div");e.className="ac-spinner",e.style.position="absolute",this.previousAction.renderedElement.appendChild(e)}}updateActionStatus(){if(null!=this.previousAction){if(null!=this.previousAction.renderedElement&&"button"===this.previousAction.renderedElement.type){this.previousAction.renderedElement.setAttribute("aria-label",this.previousAction.title);var t=this.previousAction.renderedElement.getElementsByClassName("ac-spinner");t.length>0&&this.previousAction.renderedElement.removeChild(t[0]);for(var e=0;e<this.previousAction.renderedElement.children.length;e++)this.previousAction.renderedElement.children[e].style.visibility="visible"}else if(this.previousAction.parent instanceof AdaptiveCards.TextBlock||this.previousAction.parent instanceof AdaptiveCards.Image||this.previousAction.parent instanceof AdaptiveCards.ColumnSet||this.previousAction.parent instanceof AdaptiveCards.Column||this.previousAction.parent instanceof AdaptiveCards.Container){var n=this.previousAction.parent.renderedElement.getElementsByClassName("ac-overlayDiv");if(n.length>0){var i=n[0].parentNode;i.removeChild(n[0]);var r=i.childNodes;for(e=0;e<r.length;e++)r[e].style&&(r[e].style.opacity=1)}}this.CollapseExpandedShowCardDialog()}this.previousActionExecuting=!1}processMessageCardActionResponse(t){this.updateActionStatus();var e=this.clientManagerInstance.processData(t);this.hasCardUpdates=!1,!0===e[this.constants.IsAutoInvokeAction]?this.processMessageCardAutoInvokeActionResponse(e):this.processMessageCardHttpActionResponse(e)}processMessageCardHttpActionResponse(t){try{try{var e=!1,n=t[this.constants.ActionId];if(this.isJsonString(t[this.constants.ResponseSerialized])){var i=JSON.parse(t[this.constants.ResponseSerialized]);if(!0===i[this.constants.RemoveCardProperty])this.setCardVisible(!1),this.clientManagerInstance.updateExplicitMessageCardProperty(),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardRemoved);else if(!0===i[this.constants.HideCardProperty])this.setCardVisible(!1),this.clientManagerInstance.notifyRefreshCardResponse(JSON.stringify(t)),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardHidden);else if(this.StringIsNullOrEmpty(i[this.constants.InnerErrorCodeProperty])||i[this.constants.InnerErrorCodeProperty]!==this.constants.ConnectedAccountNotErrorString||this.StringIsNullOrEmpty(i[this.constants.AuthenticationUrl]))if(this.StringIsNullOrEmpty(i[this.constants.RefreshCardSerializedProperty]))if(!0===i[this.constants.ShowOriginalCardProperty])this.renderAsHtml(this.getRenderedAdaptiveCard()),this.setCardVisible(!0);else{var r=null,s="";s=this.StringIsNullOrEmpty(i[this.constants.DisplayMessageProperty])?i[this.constants.InnerErrorCodeProperty]?this.ActionFailureStatusMessage:this.ActionSuccessStatusMessage:i[this.constants.DisplayMessageProperty],r=(i[this.constants.InnerErrorCodeProperty],this.getStatusMessageJson(s)),this.showStatusMessage(n,r,this.adaptiveCardInstance,!0),this.NofifyHeightChangeForWindows()}else this.messageCardJson=JSON.parse(i[this.constants.RefreshCardSerializedProperty]),this.allPerformedActions=[],this.convertToAdaptiveCardInstance(!0),this.handleNotifyHeightChange();else this.ConnectorsLoginUrl=i[this.constants.AuthenticationUrl],this.showStatusMessage(n,this.getLoginMessageJson(i[this.constants.DisplayMessageProperty],this.constants.ConnectorLoginLinkId),this.adaptiveCardInstance,!0),this.clientManagerInstance.logEventTelemetry(this.constants.ConsentPromptDisplayed),this.NofifyHeightChangeForWindows(),this.errorMessageActionId=n}else e=!0}catch(t){console.log(t.message),console.log(t.stack),e=!0,this.clientManagerInstance.logException(t)}!0===e&&null!=n&&(this.showStatusMessage(n,this.getStatusMessageJson(this.ActionFailureStatusMessage,this.clientManagerInstance.errorStatusImageUrl),this.adaptiveCardInstance,!0),this.NofifyHeightChangeForWindows())}catch(t){console.log(t.message),console.log(t.stack),this.clientManagerInstance.logException(t)}}processMessageCardAutoInvokeActionResponse(t){if(!1===this.isAutoInvokeSpinnerVisible)return this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),void(this.currentAction="");try{this.currentAction=this.constants.FinalCardProcessing;var e=!0;if(null!=this.messageCardJson[this.constants.AutoInvokeOptions]&&null!=this.messageCardJson[this.constants.AutoInvokeOptions][this.constants.ShowCardOnFailure]&&(e=this.messageCardJson[this.constants.AutoInvokeOptions][this.constants.ShowCardOnFailure]),this.isJsonString(t[this.constants.ResponseSerialized])){var n=JSON.parse(t[this.constants.ResponseSerialized]);n[this.constants.InnerErrorCodeProperty]||n[this.constants.AuthenticationUrl]?(this.setCardVisible(e),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):!0===n[this.constants.RemoveCardProperty]?(this.setCardVisible(!1),this.clientManagerInstance.updateExplicitMessageCardProperty(),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardRemoved),this.clientManagerInstance.logFinalCardProcessingEnd(),null==this.adaptiveCardInstance.autoInvokeAction||this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke||this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):!0===n[this.constants.HideCardProperty]?(this.setCardVisible(!1),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardHidden),this.clientManagerInstance.logFinalCardProcessingEnd(),null==this.adaptiveCardInstance.autoInvokeAction||this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke||this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):this.StringIsNullOrEmpty(n[this.constants.RefreshCardSerializedProperty])?!0===n[this.constants.ShowOriginalCardProperty]?(this.clientManagerInstance.logFinalCardProcessingEnd(),this.currentAction=this.constants.FinalCardRendering,this.renderAsHtml(this.getRenderedAdaptiveCard()),this.setCardVisible(!0)):!1===n[this.constants.ShowOriginalCardProperty]&&(this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction="",this.setCardVisible(!1)):(this.messageCardJson=JSON.parse(n[this.constants.RefreshCardSerializedProperty]),this.allPerformedActions=[],this.convertToAdaptiveCardInstance(!0),this.handleNotifyHeightChange())}else this.setCardVisible(e),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""}catch(t){console.log(t.message),console.log(t.stack),this.setCardVisible(!1),this.clientManagerInstance.logException(t),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""}this.hideAutoInvokeSpinner()}processAdaptiveCardActionResponse(t,e=null){let n=this.previousAction;this.updateActionStatus();var i=this.clientManagerInstance.processData(t);let r=this.UtilsClass.MessageId;i.hasOwnProperty(r)&&this.context.hasOwnProperty(r)&&i[r]!==this.context[r]||(this.hasCardUpdates=!1,!0===i[this.constants.IsAutoInvokeAction]?this.processAdaptiveCardAutoInvokeActionResponse(i):this.processAdaptiveCardHttpActionResponse(i,n,e))}processAdaptiveCardHttpActionResponse(t,e,n=null){try{try{var i=!1;if(this.isJsonString(t[this.constants.ResponseSerialized])){var r=JSON.parse(t[this.constants.ResponseSerialized]);if(!0===r[this.constants.RemoveCardProperty])this.setCardVisible(!1),this.clientManagerInstance.updateExplicitMessageCardProperty(),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardRemoved);else if(!0===r[this.constants.HideCardProperty])this.setCardVisible(!1),this.clientManagerInstance.notifyRefreshCardResponse(JSON.stringify(t)),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardHidden);else if(this.tryHandleCardUpdates(r))this.handleNotifyHeightChange();else if(this.tryHandleRefreshCard(r))this.clientManagerInstance.notifyRefreshCardResponse(JSON.stringify(t)),this.handleNotifyHeightChange();else if(!0===r[this.constants.ShowOriginalCardProperty])this.renderAsHtml(this.getRenderedAdaptiveCard()),this.setCardVisible(!0);else{let n="Unknown";if(null!=r[this.constants.StatusProperty]&&(n=r[this.constants.StatusProperty]),r[this.constants.InnerErrorCodeProperty]&&(n="Failed"),"completed"===n||"Completed"===n){let t=this.ActionSuccessStatusMessage;null!=r[this.constants.DisplayMessageProperty]&&(t=r[this.constants.DisplayMessageProperty]),this.clientManagerInstance.displaySnackMessage(t,!0)}else{let n=null;r[this.constants.Errors]&&Array.isArray(r[this.constants.Errors])&&(n=r[this.constants.Errors][0]);let i=this.ACFailureStatusMessage;if(n&&n[this.constants.MessageProperty]?i=n[this.constants.MessageProperty]:r[this.constants.DisplayMessageProperty]&&(i=r[this.constants.DisplayMessageProperty]),t.hasOwnProperty(this.constants.IsRetryFlow)&&!1===t[this.constants.IsRetryFlow]&&e&&this.ShouldHandleAuthErrors(r,n)){let t="";n[this.constants.HttpStatusCodeProperty]===this.constants.HttpUnauthorizedCode&&n[this.constants.Url]?t=n[this.constants.Url]:r[this.constants.AuthenticationUrl]&&(t=r[this.constants.AuthenticationUrl]),this.clientManagerInstance.executeAuthFlowForHttpAction(e,n,t,i)}else this.clientManagerInstance.displaySnackMessage(i,!1)}}}else n?this.clientManagerInstance.displaySnackMessage(n,!1):i=!0}catch(t){console.log(t.message),console.log(t.stack),i=!0,this.clientManagerInstance.logException(t)}!0===i&&this.clientManagerInstance.displaySnackMessage(this.ACFailureStatusMessage,!1)}catch(t){console.log(t.message),console.log(t.stack),this.clientManagerInstance.logException(t)}}processAdaptiveCardAutoInvokeActionResponse(t){if(!1===this.isAutoInvokeSpinnerVisible)return this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),void(this.currentAction="");try{this.currentAction=this.constants.FinalCardProcessing;var e=!0;if(null!=this.adaptiveCardInstance.autoInvokeOptions&&null!=this.adaptiveCardInstance.autoInvokeOptions[this.constants.ShowCardOnFailure]&&(e=this.adaptiveCardInstance.autoInvokeOptions[this.constants.ShowCardOnFailure]),this.isJsonString(t[this.constants.ResponseSerialized])){var n=JSON.parse(t[this.constants.ResponseSerialized]);0,!0===n[this.constants.RemoveCardProperty]?(this.setCardVisible(!1),this.clientManagerInstance.updateExplicitMessageCardProperty(),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardRemoved),this.clientManagerInstance.logFinalCardProcessingEnd(),null==this.adaptiveCardInstance.autoInvokeAction||this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke||this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):!0===n[this.constants.HideCardProperty]?(this.setCardVisible(!1),this.clientManagerInstance.logEventTelemetry(this.constants.MessageCardHidden),this.clientManagerInstance.logFinalCardProcessingEnd(),null==this.adaptiveCardInstance.autoInvokeAction||this.adaptiveCardInstance.autoInvokeAction.hideCardOnInvoke||this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):this.tryHandleCardUpdates(n)?(this.handleNotifyHeightChange(),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):this.tryHandleRefreshCard(n)?this.handleNotifyHeightChange():!0===n[this.constants.ShowOriginalCardProperty]?(this.clientManagerInstance.logFinalCardProcessingEnd(),this.currentAction=this.constants.FinalCardRendering,this.renderAsHtml(this.getRenderedAdaptiveCard()),this.setCardVisible(!0)):"Failed"===n[this.constants.StatusProperty]||n[this.constants.InnerErrorCodeProperty]?(this.setCardVisible(e),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""):(this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction="")}else this.setCardVisible(e),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""}catch(t){console.log(t.message),console.log(t.stack),this.setCardVisible(!1),this.clientManagerInstance.logException(t),this.clientManagerInstance.logFinalCardProcessingEnd(),this.clientManagerInstance.logFinalCardRenderingEnd(),this.currentAction=""}this.hideAutoInvokeSpinner()}ShouldHandleAuthErrors(t,e){return!!t&&(!!t[this.constants.AuthenticationUrl]||!(!e||!e[this.constants.HttpStatusCodeProperty]||e[this.constants.HttpStatusCodeProperty]!==this.constants.HttpUnauthorizedCode&&e[this.constants.HttpStatusCodeProperty]!==this.constants.HttpForbiddenCode))}isSupportedCardUpdateElementType(t){return this.constants.SupportedCardUpdateElementTypes.includes(t)}tryHandleCardUpdates(t){if(!t[this.constants.CardUpdatesProperty])return!1;const e=t[this.constants.CardUpdatesProperty];let n=0;try{for(const t of e){let e;if(!t.elementId||!(e=document.getElementById(t.elementId)))continue;const i=this.adaptiveCardInstance.getElementById(t.elementId);if(i&&this.isSupportedCardUpdateElementType(i.getJsonTypeName())){switch(t.action){case this.constants.ReplaceElementAction:if(!this.isSupportedCardUpdateElementType(t.element.type))continue;const n=this.createElementInstance(t.element.type);n.parse(t.element),i.parent.insertItemBefore(n,i),i.remove();const r=n.render();e.replaceWith(r);break;case this.constants.RemoveElementAction:i.remove(),e.remove()}this.adaptiveCardJson=this.adaptiveCardInstance.toJSON(),n++}}return 0!==n}catch(t){return!1}}tryHandleRefreshCard(t){if(this.StringIsNullOrEmpty(t[this.constants.RefreshCardSerializedProperty]))return!1;var e=JSON.parse(t[this.constants.RefreshCardSerializedProperty]);return"AdaptiveCard"===e.type?(this.adaptiveCardJson=e,this.generateAdaptiveCardInstance(!0)):"MessageCard"===e["@type"]&&(this.messageCardJson=e,this.allPerformedActions=[],this.convertToAdaptiveCardInstance(!0)),!0}handleNotifyHeightChange(){this.clientManagerInstance.notifyHeightChange()}getLoginMessageJson(t,e){return{$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",padding:{top:"large",right:"default",bottom:"large",left:"default"},version:"1.0",style:"emphasis",body:[{type:"TextBlock",text:t+" [Please login to continue](action:"+e+")",size:"default",spacing:"small",wrap:!0}]}}getStatusMessageJson(t,e){return e?{$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",padding:{top:"large",right:"default",bottom:"large",left:"default"},version:"1.0",style:"emphasis",body:[{type:"ColumnSet",columns:[{type:"Column",width:"stretch",items:[{type:"TextBlock",text:t,size:"default",spacing:"small",wrap:!0}]},{type:"Column",width:"auto",items:[{type:"Image",url:e,pixelWidth:18}]}]}]}:{$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",padding:{top:"large",right:"default",bottom:"large",left:"default"},version:"1.0",style:"emphasis",body:[{type:"TextBlock",text:t,size:"default",spacing:"small",wrap:!0}]}}hideCardStatusMessage(){null!=this.errorMessageActionId&&(this.showStatusMessage(this.errorMessageActionId,null,this.adaptiveCardInstance,!0),this.NofifyHeightChangeForWindows())}showWorkingStatusMessage(t){null!=t&&this.showStatusMessage(t,this.getStatusMessageJson(this.WorkingStatusMessage,this.clientManagerInstance.spinnerUrl),this.adaptiveCardInstance,!0)}isJsonString(t){try{JSON.parse(t)}catch(t){return!1}return!0}logTimeStamp(t){var e=performance.now();null!=this.clientManagerInstance&&this.clientManagerInstance.logTimeStamp(t,e)}getRenderedAdaptiveCard(){if(null==this.adaptiveCardInstance)return null;this.logTimeStamp("renderHTML-start");var t=this.adaptiveCardInstance.render();if(t){var e=t.querySelectorAll("h1, h2, h3, h4, h5, h6");if(Array.prototype.forEach.call(e,(function(t){t.style.lineHeight=1.33})),null!=this.clientManagerInstance.actionButtonsCount){var n=t.querySelectorAll(".ac-pushButton");if(this.clientManagerInstance.actionButtonsCount=n.length,1==n.length)n[0].classList.add("primary")}this.clientManagerInstance.supportMessageCard&&this.messageCardJson&&this.messageCardConverterInstance.applyMessageCardStyling(t,this.messageCardJson)}return this.logTimeStamp("renderHTML-end"),t}actionNeedsSpinner(t){return!t.isAutoInvokeAction&&(t instanceof this.clientManagerInstance.HttpActionClass||t instanceof this.clientManagerInstance.DisplayMessageFormActionClass||t instanceof this.clientManagerInstance.DisplayAppointmentFormActionClass)}createActionInstance(t,e){var n=AdaptiveCards.AdaptiveCard.actionTypeRegistry.createInstance(t);return n&&n.setParent(e),n}createElementInstance(t,e){var n=AdaptiveCards.AdaptiveCard.elementTypeRegistry.createInstance(t);return n&&n.setParent(e),n}StringIsNullOrEmpty(t){return!t}CollapseExpandedShowCardDialog(){if(this.showCardActionRef){var t=document.querySelectorAll(".ac-pushButton");t&&Array.prototype.forEach.call(t,(function(t){if(t.disabled=!1,t.querySelector("#openUrlButton")){var e=t.querySelector("#iconOpenUrl");e.classList=null,t.isPrimary||t.classList.contains("primary")?e.classList.add("ac-openUrlIconNonPrimary"):e.classList.add("ac-openUrlIconPrimary")}})),this.handleInputValueChanged(this.allInputInstances),this.showCardActionRef._actionCollection.collapseExpandedAction(),this.showCardActionRef=null,this.NofifyHeightChangeForWindows()}}onSaveInstanceState(t,e,n=null){let i;if(!this.clientManagerInstance.supportSavingState)return;const r={};for(i in this.allInputInstances){const t=this.allInputInstances[i];let e=t.value?t.value:"";if(r[t.id]=e,t.actualValue&&(r[t.id]=t.actualValue),t.selectedDate&&t.selectedDateWithTimeZone){const e=this.constants.DateInputConstants.SelectedDate,n=this.constants.DateInputConstants.SelectedDateWithTimeZone;var s={};s[e]=t.selectedDate,s[n]=t.selectedDateWithTimeZone,r[t.id]=s}}const a={};a[this.constants.InputParameters]=r,a[this.constants.DialogParameters]=n,i=e?t+e:t,window.localStorage.setItem(i,JSON.stringify(a))}onRestoreInstanceState(t,e){let n;if(!this.clientManagerInstance.supportSavingState)return;const i=e?t+e:t,r=JSON.parse(window.localStorage.getItem(i));if(r&&r.hasOwnProperty(this.constants.InputParameters)&&(this.clientManagerInstance.restoredInputs=r[this.constants.InputParameters]),r&&r.hasOwnProperty(this.constants.DialogParameters)){const t=r[this.constants.DialogParameters];if(t){const e=t[0];if(!e)return;switch(e.type){case"MORE_ACTIONS":case"SHOW_CARD":window.amNativeRenderer&&amNativeRenderer.executeAction(e.params);break;case"INPUT_POPUP":{const t=(n=JSON.parse(e.params)).popupProperties,i=n.isNumeric;window.amNativeRenderer&&amNativeRenderer.openPopup(t,i);break}case"CHOICE_PICKER":{const t=(n=JSON.parse(e.params)).id,i=n.title,r=n.choices,s=n.selectedChoices,a=!1,o=n.isRequired;window.amNativeRenderer&&amNativeRenderer.showChoicePicker(t,i,r,s,a,o);break}case"DATE_INPUT":{const t=(n=JSON.parse(e.params)).id,i=n.selectedDate;window.amNativeRenderer&&amNativeRenderer.showDatePicker(t,i);break}}}}window.localStorage.clear()}NofifyHeightChangeForWindows(){i.clientManagerInstance.notifyHeightChange()}}e.CardRender=s},function(t,e,n){"use strict";t.exports=n(16)},function(t,e,n){"use strict";var i=n(0),r=n(24),s=n(28),a=n(29),o=n(37),l=n(51),c=n(64),u=n(6),p=n(66),h={default:n(69),zero:n(70),commonmark:n(71)},d=/^(vbscript|javascript|file|data):/,g=/^data:image\/(gif|png|jpeg|webp);/;function f(t){var e=t.trim().toLowerCase();return!d.test(e)||!!g.test(e)}var m=["http:","https:","mailto:"];function y(t){var e=u.parse(t,!0);if(e.hostname&&(!e.protocol||m.indexOf(e.protocol)>=0))try{e.hostname=p.toASCII(e.hostname)}catch(t){}return u.encode(u.format(e))}function C(t){var e=u.parse(t,!0);if(e.hostname&&(!e.protocol||m.indexOf(e.protocol)>=0))try{e.hostname=p.toUnicode(e.hostname)}catch(t){}return u.decode(u.format(e))}function v(t,e){if(!(this instanceof v))return new v(t,e);e||i.isString(t)||(e=t||{},t="default"),this.inline=new l,this.block=new o,this.core=new a,this.renderer=new s,this.linkify=new c,this.validateLink=f,this.normalizeLink=y,this.normalizeLinkText=C,this.utils=i,this.helpers=i.assign({},r),this.options={},this.configure(t),e&&this.set(e)}v.prototype.set=function(t){return i.assign(this.options,t),this},v.prototype.configure=function(t){var e,n=this;if(i.isString(t)&&!(t=h[e=t]))throw new Error('Wrong `markdown-it` preset "'+e+'", check name');if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&n.set(t.options),t.components&&Object.keys(t.components).forEach((function(e){t.components[e].rules&&n[e].ruler.enableOnly(t.components[e].rules),t.components[e].rules2&&n[e].ruler2.enableOnly(t.components[e].rules2)})),this},v.prototype.enable=function(t,e){var n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach((function(e){n=n.concat(this[e].ruler.enable(t,!0))}),this),n=n.concat(this.inline.ruler2.enable(t,!0));var i=t.filter((function(t){return n.indexOf(t)<0}));if(i.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+i);return this},v.prototype.disable=function(t,e){var n=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach((function(e){n=n.concat(this[e].ruler.disable(t,!0))}),this),n=n.concat(this.inline.ruler2.disable(t,!0));var i=t.filter((function(t){return n.indexOf(t)<0}));if(i.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+i);return this},v.prototype.use=function(t){var e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this},v.prototype.parse=function(t,e){if("string"!=typeof t)throw new Error("Input data should be a String");var n=new this.core.State(t,this,e);return this.core.process(n),n.tokens},v.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)},v.prototype.parseInline=function(t,e){var n=new this.core.State(t,this,e);return n.inlineMode=!0,this.core.process(n),n.tokens},v.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)},t.exports=v},function(t){t.exports=JSON.parse('{"Aacute":"","aacute":"","Abreve":"","abreve":"","ac":"","acd":"","acE":"","Acirc":"","acirc":"","acute":"","Acy":"","acy":"","AElig":"","aelig":"","af":"","Afr":"","afr":"","Agrave":"","agrave":"","alefsym":"","aleph":"","Alpha":"","alpha":"","Amacr":"","amacr":"","amalg":"","amp":"&","AMP":"&","andand":"","And":"","and":"","andd":"","andslope":"","andv":"","ang":"","ange":"","angle":"","angmsdaa":"","angmsdab":"","angmsdac":"","angmsdad":"","angmsdae":"","angmsdaf":"","angmsdag":"","angmsdah":"","angmsd":"","angrt":"","angrtvb":"","angrtvbd":"","angsph":"","angst":"","angzarr":"","Aogon":"","aogon":"","Aopf":"","aopf":"","apacir":"","ap":"","apE":"","ape":"","apid":"","apos":"\'","ApplyFunction":"","approx":"","approxeq":"","Aring":"","aring":"","Ascr":"","ascr":"","Assign":"","ast":"*","asymp":"","asympeq":"","Atilde":"","atilde":"","Auml":"","auml":"","awconint":"","awint":"","backcong":"","backepsilon":"","backprime":"","backsim":"","backsimeq":"","Backslash":"","Barv":"","barvee":"","barwed":"","Barwed":"","barwedge":"","bbrk":"","bbrktbrk":"","bcong":"","Bcy":"","bcy":"","bdquo":"","becaus":"","because":"","Because":"","bemptyv":"","bepsi":"","bernou":"","Bernoullis":"","Beta":"","beta":"","beth":"","between":"","Bfr":"","bfr":"","bigcap":"","bigcirc":"","bigcup":"","bigodot":"","bigoplus":"","bigotimes":"","bigsqcup":"","bigstar":"","bigtriangledown":"","bigtriangleup":"","biguplus":"","bigvee":"","bigwedge":"","bkarow":"","blacklozenge":"","blacksquare":"","blacktriangle":"","blacktriangledown":"","blacktriangleleft":"","blacktriangleright":"","blank":"","blk12":"","blk14":"","blk34":"","block":"","bne":"=","bnequiv":"","bNot":"","bnot":"","Bopf":"","bopf":"","bot":"","bottom":"","bowtie":"","boxbox":"","boxdl":"","boxdL":"","boxDl":"","boxDL":"","boxdr":"","boxdR":"","boxDr":"","boxDR":"","boxh":"","boxH":"","boxhd":"","boxHd":"","boxhD":"","boxHD":"","boxhu":"","boxHu":"","boxhU":"","boxHU":"","boxminus":"","boxplus":"","boxtimes":"","boxul":"","boxuL":"","boxUl":"","boxUL":"","boxur":"","boxuR":"","boxUr":"","boxUR":"","boxv":"","boxV":"","boxvh":"","boxvH":"","boxVh":"","boxVH":"","boxvl":"","boxvL":"","boxVl":"","boxVL":"","boxvr":"","boxvR":"","boxVr":"","boxVR":"","bprime":"","breve":"","Breve":"","brvbar":"","bscr":"","Bscr":"","bsemi":"","bsim":"","bsime":"","bsolb":"","bsol":"\\\\","bsolhsub":"","bull":"","bullet":"","bump":"","bumpE":"","bumpe":"","Bumpeq":"","bumpeq":"","Cacute":"","cacute":"","capand":"","capbrcup":"","capcap":"","cap":"","Cap":"","capcup":"","capdot":"","CapitalDifferentialD":"","caps":"","caret":"","caron":"","Cayleys":"","ccaps":"","Ccaron":"","ccaron":"","Ccedil":"","ccedil":"","Ccirc":"","ccirc":"","Cconint":"","ccups":"","ccupssm":"","Cdot":"","cdot":"","cedil":"","Cedilla":"","cemptyv":"","cent":"","centerdot":"","CenterDot":"","cfr":"","Cfr":"","CHcy":"","chcy":"","check":"","checkmark":"","Chi":"","chi":"","circ":"","circeq":"","circlearrowleft":"","circlearrowright":"","circledast":"","circledcirc":"","circleddash":"","CircleDot":"","circledR":"","circledS":"","CircleMinus":"","CirclePlus":"","CircleTimes":"","cir":"","cirE":"","cire":"","cirfnint":"","cirmid":"","cirscir":"","ClockwiseContourIntegral":"","CloseCurlyDoubleQuote":"","CloseCurlyQuote":"","clubs":"","clubsuit":"","colon":":","Colon":"","Colone":"","colone":"","coloneq":"","comma":",","commat":"@","comp":"","compfn":"","complement":"","complexes":"","cong":"","congdot":"","Congruent":"","conint":"","Conint":"","ContourIntegral":"","copf":"","Copf":"","coprod":"","Coproduct":"","copy":"","COPY":"","copysr":"","CounterClockwiseContourIntegral":"","crarr":"","cross":"","Cross":"","Cscr":"","cscr":"","csub":"","csube":"","csup":"","csupe":"","ctdot":"","cudarrl":"","cudarrr":"","cuepr":"","cuesc":"","cularr":"","cularrp":"","cupbrcap":"","cupcap":"","CupCap":"","cup":"","Cup":"","cupcup":"","cupdot":"","cupor":"","cups":"","curarr":"","curarrm":"","curlyeqprec":"","curlyeqsucc":"","curlyvee":"","curlywedge":"","curren":"","curvearrowleft":"","curvearrowright":"","cuvee":"","cuwed":"","cwconint":"","cwint":"","cylcty":"","dagger":"","Dagger":"","daleth":"","darr":"","Darr":"","dArr":"","dash":"","Dashv":"","dashv":"","dbkarow":"","dblac":"","Dcaron":"","dcaron":"","Dcy":"","dcy":"","ddagger":"","ddarr":"","DD":"","dd":"","DDotrahd":"","ddotseq":"","deg":"","Del":"","Delta":"","delta":"","demptyv":"","dfisht":"","Dfr":"","dfr":"","dHar":"","dharl":"","dharr":"","DiacriticalAcute":"","DiacriticalDot":"","DiacriticalDoubleAcute":"","DiacriticalGrave":"`","DiacriticalTilde":"","diam":"","diamond":"","Diamond":"","diamondsuit":"","diams":"","die":"","DifferentialD":"","digamma":"","disin":"","div":"","divide":"","divideontimes":"","divonx":"","DJcy":"","djcy":"","dlcorn":"","dlcrop":"","dollar":"$","Dopf":"","dopf":"","Dot":"","dot":"","DotDot":"","doteq":"","doteqdot":"","DotEqual":"","dotminus":"","dotplus":"","dotsquare":"","doublebarwedge":"","DoubleContourIntegral":"","DoubleDot":"","DoubleDownArrow":"","DoubleLeftArrow":"","DoubleLeftRightArrow":"","DoubleLeftTee":"","DoubleLongLeftArrow":"","DoubleLongLeftRightArrow":"","DoubleLongRightArrow":"","DoubleRightArrow":"","DoubleRightTee":"","DoubleUpArrow":"","DoubleUpDownArrow":"","DoubleVerticalBar":"","DownArrowBar":"","downarrow":"","DownArrow":"","Downarrow":"","DownArrowUpArrow":"","DownBreve":"","downdownarrows":"","downharpoonleft":"","downharpoonright":"","DownLeftRightVector":"","DownLeftTeeVector":"","DownLeftVectorBar":"","DownLeftVector":"","DownRightTeeVector":"","DownRightVectorBar":"","DownRightVector":"","DownTeeArrow":"","DownTee":"","drbkarow":"","drcorn":"","drcrop":"","Dscr":"","dscr":"","DScy":"","dscy":"","dsol":"","Dstrok":"","dstrok":"","dtdot":"","dtri":"","dtrif":"","duarr":"","duhar":"","dwangle":"","DZcy":"","dzcy":"","dzigrarr":"","Eacute":"","eacute":"","easter":"","Ecaron":"","ecaron":"","Ecirc":"","ecirc":"","ecir":"","ecolon":"","Ecy":"","ecy":"","eDDot":"","Edot":"","edot":"","eDot":"","ee":"","efDot":"","Efr":"","efr":"","eg":"","Egrave":"","egrave":"","egs":"","egsdot":"","el":"","Element":"","elinters":"","ell":"","els":"","elsdot":"","Emacr":"","emacr":"","empty":"","emptyset":"","EmptySmallSquare":"","emptyv":"","EmptyVerySmallSquare":"","emsp13":"","emsp14":"","emsp":"","ENG":"","eng":"","ensp":"","Eogon":"","eogon":"","Eopf":"","eopf":"","epar":"","eparsl":"","eplus":"","epsi":"","Epsilon":"","epsilon":"","epsiv":"","eqcirc":"","eqcolon":"","eqsim":"","eqslantgtr":"","eqslantless":"","Equal":"","equals":"=","EqualTilde":"","equest":"","Equilibrium":"","equiv":"","equivDD":"","eqvparsl":"","erarr":"","erDot":"","escr":"","Escr":"","esdot":"","Esim":"","esim":"","Eta":"","eta":"","ETH":"","eth":"","Euml":"","euml":"","euro":"","excl":"!","exist":"","Exists":"","expectation":"","exponentiale":"","ExponentialE":"","fallingdotseq":"","Fcy":"","fcy":"","female":"","ffilig":"","fflig":"","ffllig":"","Ffr":"","ffr":"","filig":"","FilledSmallSquare":"","FilledVerySmallSquare":"","fjlig":"fj","flat":"","fllig":"","fltns":"","fnof":"","Fopf":"","fopf":"","forall":"","ForAll":"","fork":"","forkv":"","Fouriertrf":"","fpartint":"","frac12":"","frac13":"","frac14":"","frac15":"","frac16":"","frac18":"","frac23":"","frac25":"","frac34":"","frac35":"","frac38":"","frac45":"","frac56":"","frac58":"","frac78":"","frasl":"","frown":"","fscr":"","Fscr":"","gacute":"","Gamma":"","gamma":"","Gammad":"","gammad":"","gap":"","Gbreve":"","gbreve":"","Gcedil":"","Gcirc":"","gcirc":"","Gcy":"","gcy":"","Gdot":"","gdot":"","ge":"","gE":"","gEl":"","gel":"","geq":"","geqq":"","geqslant":"","gescc":"","ges":"","gesdot":"","gesdoto":"","gesdotol":"","gesl":"","gesles":"","Gfr":"","gfr":"","gg":"","Gg":"","ggg":"","gimel":"","GJcy":"","gjcy":"","gla":"","gl":"","glE":"","glj":"","gnap":"","gnapprox":"","gne":"","gnE":"","gneq":"","gneqq":"","gnsim":"","Gopf":"","gopf":"","grave":"`","GreaterEqual":"","GreaterEqualLess":"","GreaterFullEqual":"","GreaterGreater":"","GreaterLess":"","GreaterSlantEqual":"","GreaterTilde":"","Gscr":"","gscr":"","gsim":"","gsime":"","gsiml":"","gtcc":"","gtcir":"","gt":">","GT":">","Gt":"","gtdot":"","gtlPar":"","gtquest":"","gtrapprox":"","gtrarr":"","gtrdot":"","gtreqless":"","gtreqqless":"","gtrless":"","gtrsim":"","gvertneqq":"","gvnE":"","Hacek":"","hairsp":"","half":"","hamilt":"","HARDcy":"","hardcy":"","harrcir":"","harr":"","hArr":"","harrw":"","Hat":"^","hbar":"","Hcirc":"","hcirc":"","hearts":"","heartsuit":"","hellip":"","hercon":"","hfr":"","Hfr":"","HilbertSpace":"","hksearow":"","hkswarow":"","hoarr":"","homtht":"","hookleftarrow":"","hookrightarrow":"","hopf":"","Hopf":"","horbar":"","HorizontalLine":"","hscr":"","Hscr":"","hslash":"","Hstrok":"","hstrok":"","HumpDownHump":"","HumpEqual":"","hybull":"","hyphen":"","Iacute":"","iacute":"","ic":"","Icirc":"","icirc":"","Icy":"","icy":"","Idot":"","IEcy":"","iecy":"","iexcl":"","iff":"","ifr":"","Ifr":"","Igrave":"","igrave":"","ii":"","iiiint":"","iiint":"","iinfin":"","iiota":"","IJlig":"","ijlig":"","Imacr":"","imacr":"","image":"","ImaginaryI":"","imagline":"","imagpart":"","imath":"","Im":"","imof":"","imped":"","Implies":"","incare":"","in":"","infin":"","infintie":"","inodot":"","intcal":"","int":"","Int":"","integers":"","Integral":"","intercal":"","Intersection":"","intlarhk":"","intprod":"","InvisibleComma":"","InvisibleTimes":"","IOcy":"","iocy":"","Iogon":"","iogon":"","Iopf":"","iopf":"","Iota":"","iota":"","iprod":"","iquest":"","iscr":"","Iscr":"","isin":"","isindot":"","isinE":"","isins":"","isinsv":"","isinv":"","it":"","Itilde":"","itilde":"","Iukcy":"","iukcy":"","Iuml":"","iuml":"","Jcirc":"","jcirc":"","Jcy":"","jcy":"","Jfr":"","jfr":"","jmath":"","Jopf":"","jopf":"","Jscr":"","jscr":"","Jsercy":"","jsercy":"","Jukcy":"","jukcy":"","Kappa":"","kappa":"","kappav":"","Kcedil":"","kcedil":"","Kcy":"","kcy":"","Kfr":"","kfr":"","kgreen":"","KHcy":"","khcy":"","KJcy":"","kjcy":"","Kopf":"","kopf":"","Kscr":"","kscr":"","lAarr":"","Lacute":"","lacute":"","laemptyv":"","lagran":"","Lambda":"","lambda":"","lang":"","Lang":"","langd":"","langle":"","lap":"","Laplacetrf":"","laquo":"","larrb":"","larrbfs":"","larr":"","Larr":"","lArr":"","larrfs":"","larrhk":"","larrlp":"","larrpl":"","larrsim":"","larrtl":"","latail":"","lAtail":"","lat":"","late":"","lates":"","lbarr":"","lBarr":"","lbbrk":"","lbrace":"{","lbrack":"[","lbrke":"","lbrksld":"","lbrkslu":"","Lcaron":"","lcaron":"","Lcedil":"","lcedil":"","lceil":"","lcub":"{","Lcy":"","lcy":"","ldca":"","ldquo":"","ldquor":"","ldrdhar":"","ldrushar":"","ldsh":"","le":"","lE":"","LeftAngleBracket":"","LeftArrowBar":"","leftarrow":"","LeftArrow":"","Leftarrow":"","LeftArrowRightArrow":"","leftarrowtail":"","LeftCeiling":"","LeftDoubleBracket":"","LeftDownTeeVector":"","LeftDownVectorBar":"","LeftDownVector":"","LeftFloor":"","leftharpoondown":"","leftharpoonup":"","leftleftarrows":"","leftrightarrow":"","LeftRightArrow":"","Leftrightarrow":"","leftrightarrows":"","leftrightharpoons":"","leftrightsquigarrow":"","LeftRightVector":"","LeftTeeArrow":"","LeftTee":"","LeftTeeVector":"","leftthreetimes":"","LeftTriangleBar":"","LeftTriangle":"","LeftTriangleEqual":"","LeftUpDownVector":"","LeftUpTeeVector":"","LeftUpVectorBar":"","LeftUpVector":"","LeftVectorBar":"","LeftVector":"","lEg":"","leg":"","leq":"","leqq":"","leqslant":"","lescc":"","les":"","lesdot":"","lesdoto":"","lesdotor":"","lesg":"","lesges":"","lessapprox":"","lessdot":"","lesseqgtr":"","lesseqqgtr":"","LessEqualGreater":"","LessFullEqual":"","LessGreater":"","lessgtr":"","LessLess":"","lesssim":"","LessSlantEqual":"","LessTilde":"","lfisht":"","lfloor":"","Lfr":"","lfr":"","lg":"","lgE":"","lHar":"","lhard":"","lharu":"","lharul":"","lhblk":"","LJcy":"","ljcy":"","llarr":"","ll":"","Ll":"","llcorner":"","Lleftarrow":"","llhard":"","lltri":"","Lmidot":"","lmidot":"","lmoustache":"","lmoust":"","lnap":"","lnapprox":"","lne":"","lnE":"","lneq":"","lneqq":"","lnsim":"","loang":"","loarr":"","lobrk":"","longleftarrow":"","LongLeftArrow":"","Longleftarrow":"","longleftrightarrow":"","LongLeftRightArrow":"","Longleftrightarrow":"","longmapsto":"","longrightarrow":"","LongRightArrow":"","Longrightarrow":"","looparrowleft":"","looparrowright":"","lopar":"","Lopf":"","lopf":"","loplus":"","lotimes":"","lowast":"","lowbar":"_","LowerLeftArrow":"","LowerRightArrow":"","loz":"","lozenge":"","lozf":"","lpar":"(","lparlt":"","lrarr":"","lrcorner":"","lrhar":"","lrhard":"","lrm":"","lrtri":"","lsaquo":"","lscr":"","Lscr":"","lsh":"","Lsh":"","lsim":"","lsime":"","lsimg":"","lsqb":"[","lsquo":"","lsquor":"","Lstrok":"","lstrok":"","ltcc":"","ltcir":"","lt":"<","LT":"<","Lt":"","ltdot":"","lthree":"","ltimes":"","ltlarr":"","ltquest":"","ltri":"","ltrie":"","ltrif":"","ltrPar":"","lurdshar":"","luruhar":"","lvertneqq":"","lvnE":"","macr":"","male":"","malt":"","maltese":"","Map":"","map":"","mapsto":"","mapstodown":"","mapstoleft":"","mapstoup":"","marker":"","mcomma":"","Mcy":"","mcy":"","mdash":"","mDDot":"","measuredangle":"","MediumSpace":"","Mellintrf":"","Mfr":"","mfr":"","mho":"","micro":"","midast":"*","midcir":"","mid":"","middot":"","minusb":"","minus":"","minusd":"","minusdu":"","MinusPlus":"","mlcp":"","mldr":"","mnplus":"","models":"","Mopf":"","mopf":"","mp":"","mscr":"","Mscr":"","mstpos":"","Mu":"","mu":"","multimap":"","mumap":"","nabla":"","Nacute":"","nacute":"","nang":"","nap":"","napE":"","napid":"","napos":"","napprox":"","natural":"","naturals":"","natur":"","nbsp":"","nbump":"","nbumpe":"","ncap":"","Ncaron":"","ncaron":"","Ncedil":"","ncedil":"","ncong":"","ncongdot":"","ncup":"","Ncy":"","ncy":"","ndash":"","nearhk":"","nearr":"","neArr":"","nearrow":"","ne":"","nedot":"","NegativeMediumSpace":"","NegativeThickSpace":"","NegativeThinSpace":"","NegativeVeryThinSpace":"","nequiv":"","nesear":"","nesim":"","NestedGreaterGreater":"","NestedLessLess":"","NewLine":"\\n","nexist":"","nexists":"","Nfr":"","nfr":"","ngE":"","nge":"","ngeq":"","ngeqq":"","ngeqslant":"","nges":"","nGg":"","ngsim":"","nGt":"","ngt":"","ngtr":"","nGtv":"","nharr":"","nhArr":"","nhpar":"","ni":"","nis":"","nisd":"","niv":"","NJcy":"","njcy":"","nlarr":"","nlArr":"","nldr":"","nlE":"","nle":"","nleftarrow":"","nLeftarrow":"","nleftrightarrow":"","nLeftrightarrow":"","nleq":"","nleqq":"","nleqslant":"","nles":"","nless":"","nLl":"","nlsim":"","nLt":"","nlt":"","nltri":"","nltrie":"","nLtv":"","nmid":"","NoBreak":"","NonBreakingSpace":"","nopf":"","Nopf":"","Not":"","not":"","NotCongruent":"","NotCupCap":"","NotDoubleVerticalBar":"","NotElement":"","NotEqual":"","NotEqualTilde":"","NotExists":"","NotGreater":"","NotGreaterEqual":"","NotGreaterFullEqual":"","NotGreaterGreater":"","NotGreaterLess":"","NotGreaterSlantEqual":"","NotGreaterTilde":"","NotHumpDownHump":"","NotHumpEqual":"","notin":"","notindot":"","notinE":"","notinva":"","notinvb":"","notinvc":"","NotLeftTriangleBar":"","NotLeftTriangle":"","NotLeftTriangleEqual":"","NotLess":"","NotLessEqual":"","NotLessGreater":"","NotLessLess":"","NotLessSlantEqual":"","NotLessTilde":"","NotNestedGreaterGreater":"","NotNestedLessLess":"","notni":"","notniva":"","notnivb":"","notnivc":"","NotPrecedes":"","NotPrecedesEqual":"","NotPrecedesSlantEqual":"","NotReverseElement":"","NotRightTriangleBar":"","NotRightTriangle":"","NotRightTriangleEqual":"","NotSquareSubset":"","NotSquareSubsetEqual":"","NotSquareSuperset":"","NotSquareSupersetEqual":"","NotSubset":"","NotSubsetEqual":"","NotSucceeds":"","NotSucceedsEqual":"","NotSucceedsSlantEqual":"","NotSucceedsTilde":"","NotSuperset":"","NotSupersetEqual":"","NotTilde":"","NotTildeEqual":"","NotTildeFullEqual":"","NotTildeTilde":"","NotVerticalBar":"","nparallel":"","npar":"","nparsl":"","npart":"","npolint":"","npr":"","nprcue":"","nprec":"","npreceq":"","npre":"","nrarrc":"","nrarr":"","nrArr":"","nrarrw":"","nrightarrow":"","nRightarrow":"","nrtri":"","nrtrie":"","nsc":"","nsccue":"","nsce":"","Nscr":"","nscr":"","nshortmid":"","nshortparallel":"","nsim":"","nsime":"","nsimeq":"","nsmid":"","nspar":"","nsqsube":"","nsqsupe":"","nsub":"","nsubE":"","nsube":"","nsubset":"","nsubseteq":"","nsubseteqq":"","nsucc":"","nsucceq":"","nsup":"","nsupE":"","nsupe":"","nsupset":"","nsupseteq":"","nsupseteqq":"","ntgl":"","Ntilde":"","ntilde":"","ntlg":"","ntriangleleft":"","ntrianglelefteq":"","ntriangleright":"","ntrianglerighteq":"","Nu":"","nu":"","num":"#","numero":"","numsp":"","nvap":"","nvdash":"","nvDash":"","nVdash":"","nVDash":"","nvge":"","nvgt":">","nvHarr":"","nvinfin":"","nvlArr":"","nvle":"","nvlt":"<","nvltrie":"","nvrArr":"","nvrtrie":"","nvsim":"","nwarhk":"","nwarr":"","nwArr":"","nwarrow":"","nwnear":"","Oacute":"","oacute":"","oast":"","Ocirc":"","ocirc":"","ocir":"","Ocy":"","ocy":"","odash":"","Odblac":"","odblac":"","odiv":"","odot":"","odsold":"","OElig":"","oelig":"","ofcir":"","Ofr":"","ofr":"","ogon":"","Ograve":"","ograve":"","ogt":"","ohbar":"","ohm":"","oint":"","olarr":"","olcir":"","olcross":"","oline":"","olt":"","Omacr":"","omacr":"","Omega":"","omega":"","Omicron":"","omicron":"","omid":"","ominus":"","Oopf":"","oopf":"","opar":"","OpenCurlyDoubleQuote":"","OpenCurlyQuote":"","operp":"","oplus":"","orarr":"","Or":"","or":"","ord":"","order":"","orderof":"","ordf":"","ordm":"","origof":"","oror":"","orslope":"","orv":"","oS":"","Oscr":"","oscr":"","Oslash":"","oslash":"","osol":"","Otilde":"","otilde":"","otimesas":"","Otimes":"","otimes":"","Ouml":"","ouml":"","ovbar":"","OverBar":"","OverBrace":"","OverBracket":"","OverParenthesis":"","para":"","parallel":"","par":"","parsim":"","parsl":"","part":"","PartialD":"","Pcy":"","pcy":"","percnt":"%","period":".","permil":"","perp":"","pertenk":"","Pfr":"","pfr":"","Phi":"","phi":"","phiv":"","phmmat":"","phone":"","Pi":"","pi":"","pitchfork":"","piv":"","planck":"","planckh":"","plankv":"","plusacir":"","plusb":"","pluscir":"","plus":"+","plusdo":"","plusdu":"","pluse":"","PlusMinus":"","plusmn":"","plussim":"","plustwo":"","pm":"","Poincareplane":"","pointint":"","popf":"","Popf":"","pound":"","prap":"","Pr":"","pr":"","prcue":"","precapprox":"","prec":"","preccurlyeq":"","Precedes":"","PrecedesEqual":"","PrecedesSlantEqual":"","PrecedesTilde":"","preceq":"","precnapprox":"","precneqq":"","precnsim":"","pre":"","prE":"","precsim":"","prime":"","Prime":"","primes":"","prnap":"","prnE":"","prnsim":"","prod":"","Product":"","profalar":"","profline":"","profsurf":"","prop":"","Proportional":"","Proportion":"","propto":"","prsim":"","prurel":"","Pscr":"","pscr":"","Psi":"","psi":"","puncsp":"","Qfr":"","qfr":"","qint":"","qopf":"","Qopf":"","qprime":"","Qscr":"","qscr":"","quaternions":"","quatint":"","quest":"?","questeq":"","quot":"\\"","QUOT":"\\"","rAarr":"","race":"","Racute":"","racute":"","radic":"","raemptyv":"","rang":"","Rang":"","rangd":"","range":"","rangle":"","raquo":"","rarrap":"","rarrb":"","rarrbfs":"","rarrc":"","rarr":"","Rarr":"","rArr":"","rarrfs":"","rarrhk":"","rarrlp":"","rarrpl":"","rarrsim":"","Rarrtl":"","rarrtl":"","rarrw":"","ratail":"","rAtail":"","ratio":"","rationals":"","rbarr":"","rBarr":"","RBarr":"","rbbrk":"","rbrace":"}","rbrack":"]","rbrke":"","rbrksld":"","rbrkslu":"","Rcaron":"","rcaron":"","Rcedil":"","rcedil":"","rceil":"","rcub":"}","Rcy":"","rcy":"","rdca":"","rdldhar":"","rdquo":"","rdquor":"","rdsh":"","real":"","realine":"","realpart":"","reals":"","Re":"","rect":"","reg":"","REG":"","ReverseElement":"","ReverseEquilibrium":"","ReverseUpEquilibrium":"","rfisht":"","rfloor":"","rfr":"","Rfr":"","rHar":"","rhard":"","rharu":"","rharul":"","Rho":"","rho":"","rhov":"","RightAngleBracket":"","RightArrowBar":"","rightarrow":"","RightArrow":"","Rightarrow":"","RightArrowLeftArrow":"","rightarrowtail":"","RightCeiling":"","RightDoubleBracket":"","RightDownTeeVector":"","RightDownVectorBar":"","RightDownVector":"","RightFloor":"","rightharpoondown":"","rightharpoonup":"","rightleftarrows":"","rightleftharpoons":"","rightrightarrows":"","rightsquigarrow":"","RightTeeArrow":"","RightTee":"","RightTeeVector":"","rightthreetimes":"","RightTriangleBar":"","RightTriangle":"","RightTriangleEqual":"","RightUpDownVector":"","RightUpTeeVector":"","RightUpVectorBar":"","RightUpVector":"","RightVectorBar":"","RightVector":"","ring":"","risingdotseq":"","rlarr":"","rlhar":"","rlm":"","rmoustache":"","rmoust":"","rnmid":"","roang":"","roarr":"","robrk":"","ropar":"","ropf":"","Ropf":"","roplus":"","rotimes":"","RoundImplies":"","rpar":")","rpargt":"","rppolint":"","rrarr":"","Rrightarrow":"","rsaquo":"","rscr":"","Rscr":"","rsh":"","Rsh":"","rsqb":"]","rsquo":"","rsquor":"","rthree":"","rtimes":"","rtri":"","rtrie":"","rtrif":"","rtriltri":"","RuleDelayed":"","ruluhar":"","rx":"","Sacute":"","sacute":"","sbquo":"","scap":"","Scaron":"","scaron":"","Sc":"","sc":"","sccue":"","sce":"","scE":"","Scedil":"","scedil":"","Scirc":"","scirc":"","scnap":"","scnE":"","scnsim":"","scpolint":"","scsim":"","Scy":"","scy":"","sdotb":"","sdot":"","sdote":"","searhk":"","searr":"","seArr":"","searrow":"","sect":"","semi":";","seswar":"","setminus":"","setmn":"","sext":"","Sfr":"","sfr":"","sfrown":"","sharp":"","SHCHcy":"","shchcy":"","SHcy":"","shcy":"","ShortDownArrow":"","ShortLeftArrow":"","shortmid":"","shortparallel":"","ShortRightArrow":"","ShortUpArrow":"","shy":"","Sigma":"","sigma":"","sigmaf":"","sigmav":"","sim":"","simdot":"","sime":"","simeq":"","simg":"","simgE":"","siml":"","simlE":"","simne":"","simplus":"","simrarr":"","slarr":"","SmallCircle":"","smallsetminus":"","smashp":"","smeparsl":"","smid":"","smile":"","smt":"","smte":"","smtes":"","SOFTcy":"","softcy":"","solbar":"","solb":"","sol":"/","Sopf":"","sopf":"","spades":"","spadesuit":"","spar":"","sqcap":"","sqcaps":"","sqcup":"","sqcups":"","Sqrt":"","sqsub":"","sqsube":"","sqsubset":"","sqsubseteq":"","sqsup":"","sqsupe":"","sqsupset":"","sqsupseteq":"","square":"","Square":"","SquareIntersection":"","SquareSubset":"","SquareSubsetEqual":"","SquareSuperset":"","SquareSupersetEqual":"","SquareUnion":"","squarf":"","squ":"","squf":"","srarr":"","Sscr":"","sscr":"","ssetmn":"","ssmile":"","sstarf":"","Star":"","star":"","starf":"","straightepsilon":"","straightphi":"","strns":"","sub":"","Sub":"","subdot":"","subE":"","sube":"","subedot":"","submult":"","subnE":"","subne":"","subplus":"","subrarr":"","subset":"","Subset":"","subseteq":"","subseteqq":"","SubsetEqual":"","subsetneq":"","subsetneqq":"","subsim":"","subsub":"","subsup":"","succapprox":"","succ":"","succcurlyeq":"","Succeeds":"","SucceedsEqual":"","SucceedsSlantEqual":"","SucceedsTilde":"","succeq":"","succnapprox":"","succneqq":"","succnsim":"","succsim":"","SuchThat":"","sum":"","Sum":"","sung":"","sup1":"","sup2":"","sup3":"","sup":"","Sup":"","supdot":"","supdsub":"","supE":"","supe":"","supedot":"","Superset":"","SupersetEqual":"","suphsol":"","suphsub":"","suplarr":"","supmult":"","supnE":"","supne":"","supplus":"","supset":"","Supset":"","supseteq":"","supseteqq":"","supsetneq":"","supsetneqq":"","supsim":"","supsub":"","supsup":"","swarhk":"","swarr":"","swArr":"","swarrow":"","swnwar":"","szlig":"","Tab":"\\t","target":"","Tau":"","tau":"","tbrk":"","Tcaron":"","tcaron":"","Tcedil":"","tcedil":"","Tcy":"","tcy":"","tdot":"","telrec":"","Tfr":"","tfr":"","there4":"","therefore":"","Therefore":"","Theta":"","theta":"","thetasym":"","thetav":"","thickapprox":"","thicksim":"","ThickSpace":"","ThinSpace":"","thinsp":"","thkap":"","thksim":"","THORN":"","thorn":"","tilde":"","Tilde":"","TildeEqual":"","TildeFullEqual":"","TildeTilde":"","timesbar":"","timesb":"","times":"","timesd":"","tint":"","toea":"","topbot":"","topcir":"","top":"","Topf":"","topf":"","topfork":"","tosa":"","tprime":"","trade":"","TRADE":"","triangle":"","triangledown":"","triangleleft":"","trianglelefteq":"","triangleq":"","triangleright":"","trianglerighteq":"","tridot":"","trie":"","triminus":"","TripleDot":"","triplus":"","trisb":"","tritime":"","trpezium":"","Tscr":"","tscr":"","TScy":"","tscy":"","TSHcy":"","tshcy":"","Tstrok":"","tstrok":"","twixt":"","twoheadleftarrow":"","twoheadrightarrow":"","Uacute":"","uacute":"","uarr":"","Uarr":"","uArr":"","Uarrocir":"","Ubrcy":"","ubrcy":"","Ubreve":"","ubreve":"","Ucirc":"","ucirc":"","Ucy":"","ucy":"","udarr":"","Udblac":"","udblac":"","udhar":"","ufisht":"","Ufr":"","ufr":"","Ugrave":"","ugrave":"","uHar":"","uharl":"","uharr":"","uhblk":"","ulcorn":"","ulcorner":"","ulcrop":"","ultri":"","Umacr":"","umacr":"","uml":"","UnderBar":"_","UnderBrace":"","UnderBracket":"","UnderParenthesis":"","Union":"","UnionPlus":"","Uogon":"","uogon":"","Uopf":"","uopf":"","UpArrowBar":"","uparrow":"","UpArrow":"","Uparrow":"","UpArrowDownArrow":"","updownarrow":"","UpDownArrow":"","Updownarrow":"","UpEquilibrium":"","upharpoonleft":"","upharpoonright":"","uplus":"","UpperLeftArrow":"","UpperRightArrow":"","upsi":"","Upsi":"","upsih":"","Upsilon":"","upsilon":"","UpTeeArrow":"","UpTee":"","upuparrows":"","urcorn":"","urcorner":"","urcrop":"","Uring":"","uring":"","urtri":"","Uscr":"","uscr":"","utdot":"","Utilde":"","utilde":"","utri":"","utrif":"","uuarr":"","Uuml":"","uuml":"","uwangle":"","vangrt":"","varepsilon":"","varkappa":"","varnothing":"","varphi":"","varpi":"","varpropto":"","varr":"","vArr":"","varrho":"","varsigma":"","varsubsetneq":"","varsubsetneqq":"","varsupsetneq":"","varsupsetneqq":"","vartheta":"","vartriangleleft":"","vartriangleright":"","vBar":"","Vbar":"","vBarv":"","Vcy":"","vcy":"","vdash":"","vDash":"","Vdash":"","VDash":"","Vdashl":"","veebar":"","vee":"","Vee":"","veeeq":"","vellip":"","verbar":"|","Verbar":"","vert":"|","Vert":"","VerticalBar":"","VerticalLine":"|","VerticalSeparator":"","VerticalTilde":"","VeryThinSpace":"","Vfr":"","vfr":"","vltri":"","vnsub":"","vnsup":"","Vopf":"","vopf":"","vprop":"","vrtri":"","Vscr":"","vscr":"","vsubnE":"","vsubne":"","vsupnE":"","vsupne":"","Vvdash":"","vzigzag":"","Wcirc":"","wcirc":"","wedbar":"","wedge":"","Wedge":"","wedgeq":"","weierp":"","Wfr":"","wfr":"","Wopf":"","wopf":"","wp":"","wr":"","wreath":"","Wscr":"","wscr":"","xcap":"","xcirc":"","xcup":"","xdtri":"","Xfr":"","xfr":"","xharr":"","xhArr":"","Xi":"","xi":"","xlarr":"","xlArr":"","xmap":"","xnis":"","xodot":"","Xopf":"","xopf":"","xoplus":"","xotime":"","xrarr":"","xrArr":"","Xscr":"","xscr":"","xsqcup":"","xuplus":"","xutri":"","xvee":"","xwedge":"","Yacute":"","yacute":"","YAcy":"","yacy":"","Ycirc":"","ycirc":"","Ycy":"","ycy":"","yen":"","Yfr":"","yfr":"","YIcy":"","yicy":"","Yopf":"","yopf":"","Yscr":"","yscr":"","YUcy":"","yucy":"","yuml":"","Yuml":"","Zacute":"","zacute":"","Zcaron":"","zcaron":"","Zcy":"","zcy":"","Zdot":"","zdot":"","zeetrf":"","ZeroWidthSpace":"","Zeta":"","zeta":"","zfr":"","Zfr":"","ZHcy":"","zhcy":"","zigrarr":"","zopf":"","Zopf":"","Zscr":"","zscr":"","zwj":"","zwnj":""}')},function(t,e,n){"use strict";var i={};function r(t,e,n){var s,a,o,l,c,u="";for("string"!=typeof e&&(n=e,e=r.defaultChars),void 0===n&&(n=!0),c=function(t){var e,n,r=i[t];if(r)return r;for(r=i[t]=[],e=0;e<128;e++)n=String.fromCharCode(e),/^[0-9a-z]$/i.test(n)?r.push(n):r.push("%"+("0"+e.toString(16).toUpperCase()).slice(-2));for(e=0;e<t.length;e++)r[t.charCodeAt(e)]=t[e];return r}(e),s=0,a=t.length;s<a;s++)if(o=t.charCodeAt(s),n&&37===o&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3)))u+=t.slice(s,s+3),s+=2;else if(o<128)u+=c[o];else if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&s+1<a&&(l=t.charCodeAt(s+1))>=56320&&l<=57343){u+=encodeURIComponent(t[s]+t[s+1]),s++;continue}u+="%EF%BF%BD"}else u+=encodeURIComponent(t[s]);return u}r.defaultChars=";/?:@&=+$,-_.!~*'()#",r.componentChars="-_.!~*'()",t.exports=r},function(t,e,n){"use strict";var i={};function r(t,e){var n;return"string"!=typeof e&&(e=r.defaultChars),n=function(t){var e,n,r=i[t];if(r)return r;for(r=i[t]=[],e=0;e<128;e++)n=String.fromCharCode(e),r.push(n);for(e=0;e<t.length;e++)r[n=t.charCodeAt(e)]="%"+("0"+n.toString(16).toUpperCase()).slice(-2);return r}(e),t.replace(/(%[a-f0-9]{2})+/gi,(function(t){var e,i,r,s,a,o,l,c="";for(e=0,i=t.length;e<i;e+=3)(r=parseInt(t.slice(e+1,e+3),16))<128?c+=n[r]:192==(224&r)&&e+3<i&&128==(192&(s=parseInt(t.slice(e+4,e+6),16)))?(c+=(l=r<<6&1984|63&s)<128?"":String.fromCharCode(l),e+=3):224==(240&r)&&e+6<i&&(s=parseInt(t.slice(e+4,e+6),16),a=parseInt(t.slice(e+7,e+9),16),128==(192&s)&&128==(192&a))?(c+=(l=r<<12&61440|s<<6&4032|63&a)<2048||l>=55296&&l<=57343?"":String.fromCharCode(l),e+=6):240==(248&r)&&e+9<i&&(s=parseInt(t.slice(e+4,e+6),16),a=parseInt(t.slice(e+7,e+9),16),o=parseInt(t.slice(e+10,e+12),16),128==(192&s)&&128==(192&a)&&128==(192&o))?((l=r<<18&1835008|s<<12&258048|a<<6&4032|63&o)<65536||l>1114111?c+="":(l-=65536,c+=String.fromCharCode(55296+(l>>10),56320+(1023&l))),e+=9):c+="";return c}))}r.defaultChars=";/?:@&=+$,#",r.componentChars="",t.exports=r},function(t,e,n){"use strict";t.exports=function(t){var e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&-1!==t.hostname.indexOf(":")?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||""}},function(t,e,n){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var r=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,o=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(o),c=["%","/","?",";","#"].concat(l),u=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};i.prototype.parse=function(t,e){var n,i,s,o,l,f=t;if(f=f.trim(),!e&&1===t.split("#").length){var m=a.exec(f);if(m)return this.pathname=m[1],m[2]&&(this.search=m[2]),this}var y=r.exec(f);if(y&&(s=(y=y[0]).toLowerCase(),this.protocol=y,f=f.substr(y.length)),(e||y||f.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(l="//"===f.substr(0,2))||y&&d[y]||(f=f.substr(2),this.slashes=!0)),!d[y]&&(l||y&&!g[y])){var C,v,A=-1;for(n=0;n<u.length;n++)-1!==(o=f.indexOf(u[n]))&&(-1===A||o<A)&&(A=o);for(-1!==(v=-1===A?f.lastIndexOf("@"):f.lastIndexOf("@",A))&&(C=f.slice(0,v),f=f.slice(v+1),this.auth=C),A=-1,n=0;n<c.length;n++)-1!==(o=f.indexOf(c[n]))&&(-1===A||o<A)&&(A=o);-1===A&&(A=f.length),":"===f[A-1]&&A--;var b=f.slice(0,A);f=f.slice(A),this.parseHost(b),this.hostname=this.hostname||"";var x="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!x){var I=this.hostname.split(/\./);for(n=0,i=I.length;n<i;n++){var S=I[n];if(S&&!S.match(p)){for(var k="",_=0,E=S.length;_<E;_++)S.charCodeAt(_)>127?k+="x":k+=S[_];if(!k.match(p)){var w=I.slice(0,n),P=I.slice(n+1),T=S.match(h);T&&(w.push(T[1]),P.unshift(T[2])),P.length&&(f=P.join(".")+f),this.hostname=w.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var D=f.indexOf("#");-1!==D&&(this.hash=f.substr(D),f=f.slice(0,D));var M=f.indexOf("?");return-1!==M&&(this.search=f.substr(M),f=f.slice(0,M)),f&&(this.pathname=f),g[s]&&this.hostname&&!this.pathname&&(this.pathname=""),this},i.prototype.parseHost=function(t){var e=s.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},t.exports=function(t,e){if(t&&t instanceof i)return t;var n=new i;return n.parse(t,e),n}},function(t,e,n){"use strict";e.Any=n(7),e.Cc=n(8),e.Cf=n(23),e.P=n(1),e.Z=n(9)},function(t,e){t.exports=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/},function(t,e,n){"use strict";e.parseLinkLabel=n(25),e.parseLinkDestination=n(26),e.parseLinkTitle=n(27)},function(t,e,n){"use strict";t.exports=function(t,e,n){var i,r,s,a,o=-1,l=t.posMax,c=t.pos;for(t.pos=e+1,i=1;t.pos<l;){if(93===(s=t.src.charCodeAt(t.pos))&&0===--i){r=!0;break}if(a=t.pos,t.md.inline.skipToken(t),91===s)if(a===t.pos-1)i++;else if(n)return t.pos=c,-1}return r&&(o=t.pos),t.pos=c,o}},function(t,e,n){"use strict";var i=n(0).isSpace,r=n(0).unescapeAll;t.exports=function(t,e,n){var s,a,o=e,l={ok:!1,pos:0,lines:0,str:""};if(60===t.charCodeAt(e)){for(e++;e<n;){if(10===(s=t.charCodeAt(e))||i(s))return l;if(62===s)return l.pos=e+1,l.str=r(t.slice(o+1,e)),l.ok=!0,l;92===s&&e+1<n?e+=2:e++}return l}for(a=0;e<n&&32!==(s=t.charCodeAt(e))&&!(s<32||127===s);)if(92===s&&e+1<n)e+=2;else{if(40===s&&a++,41===s){if(0===a)break;a--}e++}return o===e?l:0!==a?l:(l.str=r(t.slice(o,e)),l.lines=0,l.pos=e,l.ok=!0,l)}},function(t,e,n){"use strict";var i=n(0).unescapeAll;t.exports=function(t,e,n){var r,s,a=0,o=e,l={ok:!1,pos:0,lines:0,str:""};if(e>=n)return l;if(34!==(s=t.charCodeAt(e))&&39!==s&&40!==s)return l;for(e++,40===s&&(s=41);e<n;){if((r=t.charCodeAt(e))===s)return l.pos=e+1,l.lines=a,l.str=i(t.slice(o+1,e)),l.ok=!0,l;10===r?a++:92===r&&e+1<n&&(e++,10===t.charCodeAt(e)&&a++),e++}return l}},function(t,e,n){"use strict";var i=n(0).assign,r=n(0).unescapeAll,s=n(0).escapeHtml,a={};function o(){this.rules=i({},a)}a.code_inline=function(t,e,n,i,r){var a=t[e];return"<code"+r.renderAttrs(a)+">"+s(t[e].content)+"</code>"},a.code_block=function(t,e,n,i,r){var a=t[e];return"<pre"+r.renderAttrs(a)+"><code>"+s(t[e].content)+"</code></pre>\n"},a.fence=function(t,e,n,i,a){var o,l,c,u,p=t[e],h=p.info?r(p.info).trim():"",d="";return h&&(d=h.split(/\s+/g)[0]),0===(o=n.highlight&&n.highlight(p.content,d)||s(p.content)).indexOf("<pre")?o+"\n":h?(l=p.attrIndex("class"),c=p.attrs?p.attrs.slice():[],l<0?c.push(["class",n.langPrefix+d]):c[l][1]+=" "+n.langPrefix+d,u={attrs:c},"<pre><code"+a.renderAttrs(u)+">"+o+"</code></pre>\n"):"<pre><code"+a.renderAttrs(p)+">"+o+"</code></pre>\n"},a.image=function(t,e,n,i,r){var s=t[e];return s.attrs[s.attrIndex("alt")][1]=r.renderInlineAsText(s.children,n,i),r.renderToken(t,e,n)},a.hardbreak=function(t,e,n){return n.xhtmlOut?"<br />\n":"<br>\n"},a.softbreak=function(t,e,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},a.text=function(t,e){return s(t[e].content)},a.html_block=function(t,e){return t[e].content},a.html_inline=function(t,e){return t[e].content},o.prototype.renderAttrs=function(t){var e,n,i;if(!t.attrs)return"";for(i="",e=0,n=t.attrs.length;e<n;e++)i+=" "+s(t.attrs[e][0])+'="'+s(t.attrs[e][1])+'"';return i},o.prototype.renderToken=function(t,e,n){var i,r="",s=!1,a=t[e];return a.hidden?"":(a.block&&-1!==a.nesting&&e&&t[e-1].hidden&&(r+="\n"),r+=(-1===a.nesting?"</":"<")+a.tag,r+=this.renderAttrs(a),0===a.nesting&&n.xhtmlOut&&(r+=" /"),a.block&&(s=!0,1===a.nesting&&e+1<t.length&&("inline"===(i=t[e+1]).type||i.hidden?s=!1:-1===i.nesting&&i.tag===a.tag&&(s=!1))),r+=s?">\n":">")},o.prototype.renderInline=function(t,e,n){for(var i,r="",s=this.rules,a=0,o=t.length;a<o;a++)void 0!==s[i=t[a].type]?r+=s[i](t,a,e,n,this):r+=this.renderToken(t,a,e);return r},o.prototype.renderInlineAsText=function(t,e,n){for(var i="",r=0,s=t.length;r<s;r++)"text"===t[r].type?i+=t[r].content:"image"===t[r].type&&(i+=this.renderInlineAsText(t[r].children,e,n));return i},o.prototype.render=function(t,e,n){var i,r,s,a="",o=this.rules;for(i=0,r=t.length;i<r;i++)"inline"===(s=t[i].type)?a+=this.renderInline(t[i].children,e,n):void 0!==o[s]?a+=o[t[i].type](t,i,e,n,this):a+=this.renderToken(t,i,e,n);return a},t.exports=o},function(t,e,n){"use strict";var i=n(2),r=[["normalize",n(30)],["block",n(31)],["inline",n(32)],["linkify",n(33)],["replacements",n(34)],["smartquotes",n(35)]];function s(){this.ruler=new i;for(var t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1])}s.prototype.process=function(t){var e,n,i;for(e=0,n=(i=this.ruler.getRules("")).length;e<n;e++)i[e](t)},s.prototype.State=n(36),t.exports=s},function(t,e,n){"use strict";var i=/\r[\n\u0085]?|[\u2424\u2028\u0085]/g,r=/\u0000/g;t.exports=function(t){var e;e=(e=t.src.replace(i,"\n")).replace(r,""),t.src=e}},function(t,e,n){"use strict";t.exports=function(t){var e;t.inlineMode?((e=new t.Token("inline","",0)).content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}},function(t,e,n){"use strict";t.exports=function(t){var e,n,i,r=t.tokens;for(n=0,i=r.length;n<i;n++)"inline"===(e=r[n]).type&&t.md.inline.parse(e.content,t.md,t.env,e.children)}},function(t,e,n){"use strict";var i=n(0).arrayReplaceAt;function r(t){return/^<\/a\s*>/i.test(t)}t.exports=function(t){var e,n,s,a,o,l,c,u,p,h,d,g,f,m,y,C,v,A,b=t.tokens;if(t.md.options.linkify)for(n=0,s=b.length;n<s;n++)if("inline"===b[n].type&&t.md.linkify.pretest(b[n].content))for(f=0,e=(a=b[n].children).length-1;e>=0;e--)if("link_close"!==(l=a[e]).type){if("html_inline"===l.type&&(A=l.content,/^<a[>\s]/i.test(A)&&f>0&&f--,r(l.content)&&f++),!(f>0)&&"text"===l.type&&t.md.linkify.test(l.content)){for(p=l.content,v=t.md.linkify.match(p),c=[],g=l.level,d=0,u=0;u<v.length;u++)m=v[u].url,y=t.md.normalizeLink(m),t.md.validateLink(y)&&(C=v[u].text,C=v[u].schema?"mailto:"!==v[u].schema||/^mailto:/i.test(C)?t.md.normalizeLinkText(C):t.md.normalizeLinkText("mailto:"+C).replace(/^mailto:/,""):t.md.normalizeLinkText("http://"+C).replace(/^http:\/\//,""),(h=v[u].index)>d&&((o=new t.Token("text","",0)).content=p.slice(d,h),o.level=g,c.push(o)),(o=new t.Token("link_open","a",1)).attrs=[["href",y]],o.level=g++,o.markup="linkify",o.info="auto",c.push(o),(o=new t.Token("text","",0)).content=C,o.level=g,c.push(o),(o=new t.Token("link_close","a",-1)).level=--g,o.markup="linkify",o.info="auto",c.push(o),d=v[u].lastIndex);d<p.length&&((o=new t.Token("text","",0)).content=p.slice(d),o.level=g,c.push(o)),b[n].children=a=i(a,e,c)}}else for(e--;a[e].level!==l.level&&"link_open"!==a[e].type;)e--}},function(t,e,n){"use strict";var i=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,r=/\((c|tm|r|p)\)/i,s=/\((c|tm|r|p)\)/gi,a={c:"",r:"",p:"",tm:""};function o(t,e){return a[e.toLowerCase()]}function l(t){var e,n,i=0;for(e=t.length-1;e>=0;e--)"text"!==(n=t[e]).type||i||(n.content=n.content.replace(s,o)),"link_open"===n.type&&"auto"===n.info&&i--,"link_close"===n.type&&"auto"===n.info&&i++}function c(t){var e,n,r=0;for(e=t.length-1;e>=0;e--)"text"!==(n=t[e]).type||r||i.test(n.content)&&(n.content=n.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1$2").replace(/(^|\s)--(\s|$)/gm,"$1$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1$2")),"link_open"===n.type&&"auto"===n.info&&r--,"link_close"===n.type&&"auto"===n.info&&r++}t.exports=function(t){var e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&(r.test(t.tokens[e].content)&&l(t.tokens[e].children),i.test(t.tokens[e].content)&&c(t.tokens[e].children))}},function(t,e,n){"use strict";var i=n(0).isWhiteSpace,r=n(0).isPunctChar,s=n(0).isMdAsciiPunct,a=/['"]/,o=/['"]/g,l="";function c(t,e,n){return t.substr(0,e)+n+t.substr(e+1)}function u(t,e){var n,a,u,p,h,d,g,f,m,y,C,v,A,b,x,I,S,k,_,E,w;for(_=[],n=0;n<t.length;n++){for(a=t[n],g=t[n].level,S=_.length-1;S>=0&&!(_[S].level<=g);S--);if(_.length=S+1,"text"===a.type){h=0,d=(u=a.content).length;t:for(;h<d&&(o.lastIndex=h,p=o.exec(u));){if(x=I=!0,h=p.index+1,k="'"===p[0],m=32,p.index-1>=0)m=u.charCodeAt(p.index-1);else for(S=n-1;S>=0&&("softbreak"!==t[S].type&&"hardbreak"!==t[S].type);S--)if("text"===t[S].type){m=t[S].content.charCodeAt(t[S].content.length-1);break}if(y=32,h<d)y=u.charCodeAt(h);else for(S=n+1;S<t.length&&("softbreak"!==t[S].type&&"hardbreak"!==t[S].type);S++)if("text"===t[S].type){y=t[S].content.charCodeAt(0);break}if(C=s(m)||r(String.fromCharCode(m)),v=s(y)||r(String.fromCharCode(y)),A=i(m),(b=i(y))?x=!1:v&&(A||C||(x=!1)),A?I=!1:C&&(b||v||(I=!1)),34===y&&'"'===p[0]&&m>=48&&m<=57&&(I=x=!1),x&&I&&(x=!1,I=v),x||I){if(I)for(S=_.length-1;S>=0&&(f=_[S],!(_[S].level<g));S--)if(f.single===k&&_[S].level===g){f=_[S],k?(E=e.md.options.quotes[2],w=e.md.options.quotes[3]):(E=e.md.options.quotes[0],w=e.md.options.quotes[1]),a.content=c(a.content,p.index,w),t[f.token].content=c(t[f.token].content,f.pos,E),h+=w.length-1,f.token===n&&(h+=E.length-1),d=(u=a.content).length,_.length=S;continue t}x?_.push({token:n,pos:p.index,single:k,level:g}):I&&k&&(a.content=c(a.content,p.index,l))}else k&&(a.content=c(a.content,p.index,l))}}}}t.exports=function(t){var e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)"inline"===t.tokens[e].type&&a.test(t.tokens[e].content)&&u(t.tokens[e].children,t)}},function(t,e,n){"use strict";var i=n(3);function r(t,e,n){this.src=t,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=e}r.prototype.Token=i,t.exports=r},function(t,e,n){"use strict";var i=n(2),r=[["table",n(38),["paragraph","reference"]],["code",n(39)],["fence",n(40),["paragraph","reference","blockquote","list"]],["blockquote",n(41),["paragraph","reference","blockquote","list"]],["hr",n(42),["paragraph","reference","blockquote","list"]],["list",n(43),["paragraph","reference","blockquote"]],["reference",n(44)],["heading",n(45),["paragraph","reference","blockquote"]],["lheading",n(46)],["html_block",n(47),["paragraph","reference","blockquote"]],["paragraph",n(49)]];function s(){this.ruler=new i;for(var t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1],{alt:(r[t][2]||[]).slice()})}s.prototype.tokenize=function(t,e,n){for(var i,r=this.ruler.getRules(""),s=r.length,a=e,o=!1,l=t.md.options.maxNesting;a<n&&(t.line=a=t.skipEmptyLines(a),!(a>=n))&&!(t.sCount[a]<t.blkIndent);){if(t.level>=l){t.line=n;break}for(i=0;i<s&&!r[i](t,a,n,!1);i++);t.tight=!o,t.isEmpty(t.line-1)&&(o=!0),(a=t.line)<n&&t.isEmpty(a)&&(o=!0,a++,t.line=a)}},s.prototype.parse=function(t,e,n,i){var r;t&&(r=new this.State(t,e,n,i),this.tokenize(r,r.line,r.lineMax))},s.prototype.State=n(50),t.exports=s},function(t,e,n){"use strict";var i=n(0).isSpace;function r(t,e){var n=t.bMarks[e]+t.blkIndent,i=t.eMarks[e];return t.src.substr(n,i-n)}function s(t){var e,n=[],i=0,r=t.length,s=0,a=0,o=!1,l=0;for(e=t.charCodeAt(i);i<r;)96===e?o?(o=!1,l=i):s%2==0&&(o=!0,l=i):124!==e||s%2!=0||o||(n.push(t.substring(a,i)),a=i+1),92===e?s++:s=0,++i===r&&o&&(o=!1,i=l+1),e=t.charCodeAt(i);return n.push(t.substring(a)),n}t.exports=function(t,e,n,a){var o,l,c,u,p,h,d,g,f,m,y,C;if(e+2>n)return!1;if(p=e+1,t.sCount[p]<t.blkIndent)return!1;if(t.sCount[p]-t.blkIndent>=4)return!1;if((c=t.bMarks[p]+t.tShift[p])>=t.eMarks[p])return!1;if(124!==(o=t.src.charCodeAt(c++))&&45!==o&&58!==o)return!1;for(;c<t.eMarks[p];){if(124!==(o=t.src.charCodeAt(c))&&45!==o&&58!==o&&!i(o))return!1;c++}for(h=(l=r(t,e+1)).split("|"),f=[],u=0;u<h.length;u++){if(!(m=h[u].trim())){if(0===u||u===h.length-1)continue;return!1}if(!/^:?-+:?$/.test(m))return!1;58===m.charCodeAt(m.length-1)?f.push(58===m.charCodeAt(0)?"center":"right"):58===m.charCodeAt(0)?f.push("left"):f.push("")}if(-1===(l=r(t,e).trim()).indexOf("|"))return!1;if(t.sCount[e]-t.blkIndent>=4)return!1;if((d=(h=s(l.replace(/^\||\|$/g,""))).length)>f.length)return!1;if(a)return!0;for((g=t.push("table_open","table",1)).map=y=[e,0],(g=t.push("thead_open","thead",1)).map=[e,e+1],(g=t.push("tr_open","tr",1)).map=[e,e+1],u=0;u<h.length;u++)(g=t.push("th_open","th",1)).map=[e,e+1],f[u]&&(g.attrs=[["style","text-align:"+f[u]]]),(g=t.push("inline","",0)).content=h[u].trim(),g.map=[e,e+1],g.children=[],g=t.push("th_close","th",-1);for(g=t.push("tr_close","tr",-1),g=t.push("thead_close","thead",-1),(g=t.push("tbody_open","tbody",1)).map=C=[e+2,0],p=e+2;p<n&&!(t.sCount[p]<t.blkIndent)&&-1!==(l=r(t,p).trim()).indexOf("|")&&!(t.sCount[p]-t.blkIndent>=4);p++){for(h=s(l.replace(/^\||\|$/g,"")),g=t.push("tr_open","tr",1),u=0;u<d;u++)g=t.push("td_open","td",1),f[u]&&(g.attrs=[["style","text-align:"+f[u]]]),(g=t.push("inline","",0)).content=h[u]?h[u].trim():"",g.children=[],g=t.push("td_close","td",-1);g=t.push("tr_close","tr",-1)}return g=t.push("tbody_close","tbody",-1),g=t.push("table_close","table",-1),y[1]=C[1]=p,t.line=p,!0}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i,r,s;if(t.sCount[e]-t.blkIndent<4)return!1;for(r=i=e+1;i<n;)if(t.isEmpty(i))i++;else{if(!(t.sCount[i]-t.blkIndent>=4))break;r=++i}return t.line=r,(s=t.push("code_block","code",0)).content=t.getLines(e,r,4+t.blkIndent,!0),s.map=[e,t.line],!0}},function(t,e,n){"use strict";t.exports=function(t,e,n,i){var r,s,a,o,l,c,u,p=!1,h=t.bMarks[e]+t.tShift[e],d=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(h+3>d)return!1;if(126!==(r=t.src.charCodeAt(h))&&96!==r)return!1;if(l=h,(s=(h=t.skipChars(h,r))-l)<3)return!1;if(u=t.src.slice(l,h),(a=t.src.slice(h,d)).indexOf(String.fromCharCode(r))>=0)return!1;if(i)return!0;for(o=e;!(++o>=n)&&!((h=l=t.bMarks[o]+t.tShift[o])<(d=t.eMarks[o])&&t.sCount[o]<t.blkIndent);)if(t.src.charCodeAt(h)===r&&!(t.sCount[o]-t.blkIndent>=4||(h=t.skipChars(h,r))-l<s||(h=t.skipSpaces(h))<d)){p=!0;break}return s=t.sCount[e],t.line=o+(p?1:0),(c=t.push("fence","code",0)).info=a,c.content=t.getLines(e+1,o,s,!0),c.markup=u,c.map=[e,t.line],!0}},function(t,e,n){"use strict";var i=n(0).isSpace;t.exports=function(t,e,n,r){var s,a,o,l,c,u,p,h,d,g,f,m,y,C,v,A,b,x,I,S,k=t.lineMax,_=t.bMarks[e]+t.tShift[e],E=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(62!==t.src.charCodeAt(_++))return!1;if(r)return!0;for(l=d=t.sCount[e]+_-(t.bMarks[e]+t.tShift[e]),32===t.src.charCodeAt(_)?(_++,l++,d++,s=!1,A=!0):9===t.src.charCodeAt(_)?(A=!0,(t.bsCount[e]+d)%4==3?(_++,l++,d++,s=!1):s=!0):A=!1,g=[t.bMarks[e]],t.bMarks[e]=_;_<E&&(a=t.src.charCodeAt(_),i(a));)9===a?d+=4-(d+t.bsCount[e]+(s?1:0))%4:d++,_++;for(f=[t.bsCount[e]],t.bsCount[e]=t.sCount[e]+1+(A?1:0),u=_>=E,C=[t.sCount[e]],t.sCount[e]=d-l,v=[t.tShift[e]],t.tShift[e]=_-t.bMarks[e],x=t.md.block.ruler.getRules("blockquote"),y=t.parentType,t.parentType="blockquote",S=!1,h=e+1;h<n&&(t.sCount[h]<t.blkIndent&&(S=!0),!((_=t.bMarks[h]+t.tShift[h])>=(E=t.eMarks[h])));h++)if(62!==t.src.charCodeAt(_++)||S){if(u)break;for(b=!1,o=0,c=x.length;o<c;o++)if(x[o](t,h,n,!0)){b=!0;break}if(b){t.lineMax=h,0!==t.blkIndent&&(g.push(t.bMarks[h]),f.push(t.bsCount[h]),v.push(t.tShift[h]),C.push(t.sCount[h]),t.sCount[h]-=t.blkIndent);break}g.push(t.bMarks[h]),f.push(t.bsCount[h]),v.push(t.tShift[h]),C.push(t.sCount[h]),t.sCount[h]=-1}else{for(l=d=t.sCount[h]+_-(t.bMarks[h]+t.tShift[h]),32===t.src.charCodeAt(_)?(_++,l++,d++,s=!1,A=!0):9===t.src.charCodeAt(_)?(A=!0,(t.bsCount[h]+d)%4==3?(_++,l++,d++,s=!1):s=!0):A=!1,g.push(t.bMarks[h]),t.bMarks[h]=_;_<E&&(a=t.src.charCodeAt(_),i(a));)9===a?d+=4-(d+t.bsCount[h]+(s?1:0))%4:d++,_++;u=_>=E,f.push(t.bsCount[h]),t.bsCount[h]=t.sCount[h]+1+(A?1:0),C.push(t.sCount[h]),t.sCount[h]=d-l,v.push(t.tShift[h]),t.tShift[h]=_-t.bMarks[h]}for(m=t.blkIndent,t.blkIndent=0,(I=t.push("blockquote_open","blockquote",1)).markup=">",I.map=p=[e,0],t.md.block.tokenize(t,e,h),(I=t.push("blockquote_close","blockquote",-1)).markup=">",t.lineMax=k,t.parentType=y,p[1]=t.line,o=0;o<v.length;o++)t.bMarks[o+e]=g[o],t.tShift[o+e]=v[o],t.sCount[o+e]=C[o],t.bsCount[o+e]=f[o];return t.blkIndent=m,!0}},function(t,e,n){"use strict";var i=n(0).isSpace;t.exports=function(t,e,n,r){var s,a,o,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(42!==(s=t.src.charCodeAt(c++))&&45!==s&&95!==s)return!1;for(a=1;c<u;){if((o=t.src.charCodeAt(c++))!==s&&!i(o))return!1;o===s&&a++}return!(a<3)&&(!!r||(t.line=e+1,(l=t.push("hr","hr",0)).map=[e,t.line],l.markup=Array(a+1).join(String.fromCharCode(s)),!0))}},function(t,e,n){"use strict";var i=n(0).isSpace;function r(t,e){var n,r,s,a;return r=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],42!==(n=t.src.charCodeAt(r++))&&45!==n&&43!==n?-1:r<s&&(a=t.src.charCodeAt(r),!i(a))?-1:r}function s(t,e){var n,r=t.bMarks[e]+t.tShift[e],s=r,a=t.eMarks[e];if(s+1>=a)return-1;if((n=t.src.charCodeAt(s++))<48||n>57)return-1;for(;;){if(s>=a)return-1;if(!((n=t.src.charCodeAt(s++))>=48&&n<=57)){if(41===n||46===n)break;return-1}if(s-r>=10)return-1}return s<a&&(n=t.src.charCodeAt(s),!i(n))?-1:s}t.exports=function(t,e,n,i){var a,o,l,c,u,p,h,d,g,f,m,y,C,v,A,b,x,I,S,k,_,E,w,P,T,D,M,O,F=!1,N=!0;if(t.sCount[e]-t.blkIndent>=4)return!1;if(i&&"paragraph"===t.parentType&&t.tShift[e]>=t.blkIndent&&(F=!0),(w=s(t,e))>=0){if(h=!0,T=t.bMarks[e]+t.tShift[e],C=Number(t.src.substr(T,w-T-1)),F&&1!==C)return!1}else{if(!((w=r(t,e))>=0))return!1;h=!1}if(F&&t.skipSpaces(w)>=t.eMarks[e])return!1;if(y=t.src.charCodeAt(w-1),i)return!0;for(m=t.tokens.length,h?(O=t.push("ordered_list_open","ol",1),1!==C&&(O.attrs=[["start",C]])):O=t.push("bullet_list_open","ul",1),O.map=f=[e,0],O.markup=String.fromCharCode(y),A=e,P=!1,M=t.md.block.ruler.getRules("list"),S=t.parentType,t.parentType="list";A<n;){for(E=w,v=t.eMarks[A],p=b=t.sCount[A]+w-(t.bMarks[e]+t.tShift[e]);E<v;){if(9===(a=t.src.charCodeAt(E)))b+=4-(b+t.bsCount[A])%4;else{if(32!==a)break;b++}E++}if((u=(o=E)>=v?1:b-p)>4&&(u=1),c=p+u,(O=t.push("list_item_open","li",1)).markup=String.fromCharCode(y),O.map=d=[e,0],x=t.blkIndent,_=t.tight,k=t.tShift[e],I=t.sCount[e],t.blkIndent=c,t.tight=!0,t.tShift[e]=o-t.bMarks[e],t.sCount[e]=b,o>=v&&t.isEmpty(e+1)?t.line=Math.min(t.line+2,n):t.md.block.tokenize(t,e,n,!0),t.tight&&!P||(N=!1),P=t.line-e>1&&t.isEmpty(t.line-1),t.blkIndent=x,t.tShift[e]=k,t.sCount[e]=I,t.tight=_,(O=t.push("list_item_close","li",-1)).markup=String.fromCharCode(y),A=e=t.line,d[1]=A,o=t.bMarks[e],A>=n)break;if(t.sCount[A]<t.blkIndent)break;for(D=!1,l=0,g=M.length;l<g;l++)if(M[l](t,A,n,!0)){D=!0;break}if(D)break;if(h){if((w=s(t,A))<0)break}else if((w=r(t,A))<0)break;if(y!==t.src.charCodeAt(w-1))break}return(O=h?t.push("ordered_list_close","ol",-1):t.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(y),f[1]=A,t.line=A,t.parentType=S,N&&function(t,e){var n,i,r=t.level+2;for(n=e+2,i=t.tokens.length-2;n<i;n++)t.tokens[n].level===r&&"paragraph_open"===t.tokens[n].type&&(t.tokens[n+2].hidden=!0,t.tokens[n].hidden=!0,n+=2)}(t,m),!0}},function(t,e,n){"use strict";var i=n(0).normalizeReference,r=n(0).isSpace;t.exports=function(t,e,n,s){var a,o,l,c,u,p,h,d,g,f,m,y,C,v,A,b,x=0,I=t.bMarks[e]+t.tShift[e],S=t.eMarks[e],k=e+1;if(t.sCount[e]-t.blkIndent>=4)return!1;if(91!==t.src.charCodeAt(I))return!1;for(;++I<S;)if(93===t.src.charCodeAt(I)&&92!==t.src.charCodeAt(I-1)){if(I+1===S)return!1;if(58!==t.src.charCodeAt(I+1))return!1;break}for(c=t.lineMax,A=t.md.block.ruler.getRules("reference"),f=t.parentType,t.parentType="reference";k<c&&!t.isEmpty(k);k++)if(!(t.sCount[k]-t.blkIndent>3||t.sCount[k]<0)){for(v=!1,p=0,h=A.length;p<h;p++)if(A[p](t,k,c,!0)){v=!0;break}if(v)break}for(S=(C=t.getLines(e,k,t.blkIndent,!1).trim()).length,I=1;I<S;I++){if(91===(a=C.charCodeAt(I)))return!1;if(93===a){g=I;break}10===a?x++:92===a&&++I<S&&10===C.charCodeAt(I)&&x++}if(g<0||58!==C.charCodeAt(g+1))return!1;for(I=g+2;I<S;I++)if(10===(a=C.charCodeAt(I)))x++;else if(!r(a))break;if(!(m=t.md.helpers.parseLinkDestination(C,I,S)).ok)return!1;if(u=t.md.normalizeLink(m.str),!t.md.validateLink(u))return!1;for(o=I=m.pos,l=x+=m.lines,y=I;I<S;I++)if(10===(a=C.charCodeAt(I)))x++;else if(!r(a))break;for(m=t.md.helpers.parseLinkTitle(C,I,S),I<S&&y!==I&&m.ok?(b=m.str,I=m.pos,x+=m.lines):(b="",I=o,x=l);I<S&&(a=C.charCodeAt(I),r(a));)I++;if(I<S&&10!==C.charCodeAt(I)&&b)for(b="",I=o,x=l;I<S&&(a=C.charCodeAt(I),r(a));)I++;return!(I<S&&10!==C.charCodeAt(I))&&(!!(d=i(C.slice(1,g)))&&(!!s||(void 0===t.env.references&&(t.env.references={}),void 0===t.env.references[d]&&(t.env.references[d]={title:b,href:u}),t.parentType=f,t.line=e+x+1,!0)))}},function(t,e,n){"use strict";var i=n(0).isSpace;t.exports=function(t,e,n,r){var s,a,o,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(35!==(s=t.src.charCodeAt(c))||c>=u)return!1;for(a=1,s=t.src.charCodeAt(++c);35===s&&c<u&&a<=6;)a++,s=t.src.charCodeAt(++c);return!(a>6||c<u&&!i(s))&&(!!r||(u=t.skipSpacesBack(u,c),(o=t.skipCharsBack(u,35,c))>c&&i(t.src.charCodeAt(o-1))&&(u=o),t.line=e+1,(l=t.push("heading_open","h"+String(a),1)).markup="########".slice(0,a),l.map=[e,t.line],(l=t.push("inline","",0)).content=t.src.slice(c,u).trim(),l.map=[e,t.line],l.children=[],(l=t.push("heading_close","h"+String(a),-1)).markup="########".slice(0,a),!0))}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i,r,s,a,o,l,c,u,p,h,d=e+1,g=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;for(h=t.parentType,t.parentType="paragraph";d<n&&!t.isEmpty(d);d++)if(!(t.sCount[d]-t.blkIndent>3)){if(t.sCount[d]>=t.blkIndent&&(l=t.bMarks[d]+t.tShift[d])<(c=t.eMarks[d])&&(45===(p=t.src.charCodeAt(l))||61===p)&&(l=t.skipChars(l,p),(l=t.skipSpaces(l))>=c)){u=61===p?1:2;break}if(!(t.sCount[d]<0)){for(r=!1,s=0,a=g.length;s<a;s++)if(g[s](t,d,n,!0)){r=!0;break}if(r)break}}return!!u&&(i=t.getLines(e,d,t.blkIndent,!1).trim(),t.line=d+1,(o=t.push("heading_open","h"+String(u),1)).markup=String.fromCharCode(p),o.map=[e,t.line],(o=t.push("inline","",0)).content=i,o.map=[e,t.line-1],o.children=[],(o=t.push("heading_close","h"+String(u),-1)).markup=String.fromCharCode(p),t.parentType=h,!0)}},function(t,e,n){"use strict";var i=n(48),r=n(10).HTML_OPEN_CLOSE_TAG_RE,s=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+i.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(r.source+"\\s*$"),/^$/,!1]];t.exports=function(t,e,n,i){var r,a,o,l,c=t.bMarks[e]+t.tShift[e],u=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;if(!t.md.options.html)return!1;if(60!==t.src.charCodeAt(c))return!1;for(l=t.src.slice(c,u),r=0;r<s.length&&!s[r][0].test(l);r++);if(r===s.length)return!1;if(i)return s[r][2];if(a=e+1,!s[r][1].test(l))for(;a<n&&!(t.sCount[a]<t.blkIndent);a++)if(c=t.bMarks[a]+t.tShift[a],u=t.eMarks[a],l=t.src.slice(c,u),s[r][1].test(l)){0!==l.length&&a++;break}return t.line=a,(o=t.push("html_block","",0)).map=[e,a],o.content=t.getLines(e,a,t.blkIndent,!0),!0}},function(t,e,n){"use strict";t.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(t,e,n){"use strict";t.exports=function(t,e){var n,i,r,s,a,o,l=e+1,c=t.md.block.ruler.getRules("paragraph"),u=t.lineMax;for(o=t.parentType,t.parentType="paragraph";l<u&&!t.isEmpty(l);l++)if(!(t.sCount[l]-t.blkIndent>3||t.sCount[l]<0)){for(i=!1,r=0,s=c.length;r<s;r++)if(c[r](t,l,u,!0)){i=!0;break}if(i)break}return n=t.getLines(e,l,t.blkIndent,!1).trim(),t.line=l,(a=t.push("paragraph_open","p",1)).map=[e,t.line],(a=t.push("inline","",0)).content=n,a.map=[e,t.line],a.children=[],a=t.push("paragraph_close","p",-1),t.parentType=o,!0}},function(t,e,n){"use strict";var i=n(3),r=n(0).isSpace;function s(t,e,n,i){var s,a,o,l,c,u,p,h;for(this.src=t,this.md=e,this.env=n,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.parentType="root",this.level=0,this.result="",h=!1,o=l=u=p=0,c=(a=this.src).length;l<c;l++){if(s=a.charCodeAt(l),!h){if(r(s)){u++,9===s?p+=4-p%4:p++;continue}h=!0}10!==s&&l!==c-1||(10!==s&&l++,this.bMarks.push(o),this.eMarks.push(l),this.tShift.push(u),this.sCount.push(p),this.bsCount.push(0),h=!1,u=0,p=0,o=l+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}s.prototype.push=function(t,e,n){var r=new i(t,e,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r},s.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]},s.prototype.skipEmptyLines=function(t){for(var e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t},s.prototype.skipSpaces=function(t){for(var e,n=this.src.length;t<n&&(e=this.src.charCodeAt(t),r(e));t++);return t},s.prototype.skipSpacesBack=function(t,e){if(t<=e)return t;for(;t>e;)if(!r(this.src.charCodeAt(--t)))return t+1;return t},s.prototype.skipChars=function(t,e){for(var n=this.src.length;t<n&&this.src.charCodeAt(t)===e;t++);return t},s.prototype.skipCharsBack=function(t,e,n){if(t<=n)return t;for(;t>n;)if(e!==this.src.charCodeAt(--t))return t+1;return t},s.prototype.getLines=function(t,e,n,i){var s,a,o,l,c,u,p,h=t;if(t>=e)return"";for(u=new Array(e-t),s=0;h<e;h++,s++){for(a=0,p=l=this.bMarks[h],c=h+1<e||i?this.eMarks[h]+1:this.eMarks[h];l<c&&a<n;){if(o=this.src.charCodeAt(l),r(o))9===o?a+=4-(a+this.bsCount[h])%4:a++;else{if(!(l-p<this.tShift[h]))break;a++}l++}u[s]=a>n?new Array(a-n+1).join(" ")+this.src.slice(l,c):this.src.slice(l,c)}return u.join("")},s.prototype.Token=i,t.exports=s},function(t,e,n){"use strict";var i=n(2),r=[["text",n(52)],["newline",n(53)],["escape",n(54)],["backticks",n(55)],["strikethrough",n(11).tokenize],["emphasis",n(12).tokenize],["link",n(56)],["image",n(57)],["autolink",n(58)],["html_inline",n(59)],["entity",n(60)]],s=[["balance_pairs",n(61)],["strikethrough",n(11).postProcess],["emphasis",n(12).postProcess],["text_collapse",n(62)]];function a(){var t;for(this.ruler=new i,t=0;t<r.length;t++)this.ruler.push(r[t][0],r[t][1]);for(this.ruler2=new i,t=0;t<s.length;t++)this.ruler2.push(s[t][0],s[t][1])}a.prototype.skipToken=function(t){var e,n,i=t.pos,r=this.ruler.getRules(""),s=r.length,a=t.md.options.maxNesting,o=t.cache;if(void 0===o[i]){if(t.level<a)for(n=0;n<s&&(t.level++,e=r[n](t,!0),t.level--,!e);n++);else t.pos=t.posMax;e||t.pos++,o[i]=t.pos}else t.pos=o[i]},a.prototype.tokenize=function(t){for(var e,n,i=this.ruler.getRules(""),r=i.length,s=t.posMax,a=t.md.options.maxNesting;t.pos<s;){if(t.level<a)for(n=0;n<r&&!(e=i[n](t,!1));n++);if(e){if(t.pos>=s)break}else t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()},a.prototype.parse=function(t,e,n,i){var r,s,a,o=new this.State(t,e,n,i);for(this.tokenize(o),a=(s=this.ruler2.getRules("")).length,r=0;r<a;r++)s[r](o)},a.prototype.State=n(63),t.exports=a},function(t,e,n){"use strict";function i(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}t.exports=function(t,e){for(var n=t.pos;n<t.posMax&&!i(t.src.charCodeAt(n));)n++;return n!==t.pos&&(e||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}},function(t,e,n){"use strict";var i=n(0).isSpace;t.exports=function(t,e){var n,r,s=t.pos;if(10!==t.src.charCodeAt(s))return!1;for(n=t.pending.length-1,r=t.posMax,e||(n>=0&&32===t.pending.charCodeAt(n)?n>=1&&32===t.pending.charCodeAt(n-1)?(t.pending=t.pending.replace(/ +$/,""),t.push("hardbreak","br",0)):(t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0)):t.push("softbreak","br",0)),s++;s<r&&i(t.src.charCodeAt(s));)s++;return t.pos=s,!0}},function(t,e,n){"use strict";for(var i=n(0).isSpace,r=[],s=0;s<256;s++)r.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(t){r[t.charCodeAt(0)]=1})),t.exports=function(t,e){var n,s=t.pos,a=t.posMax;if(92!==t.src.charCodeAt(s))return!1;if(++s<a){if((n=t.src.charCodeAt(s))<256&&0!==r[n])return e||(t.pending+=t.src[s]),t.pos+=2,!0;if(10===n){for(e||t.push("hardbreak","br",0),s++;s<a&&(n=t.src.charCodeAt(s),i(n));)s++;return t.pos=s,!0}}return e||(t.pending+="\\"),t.pos++,!0}},function(t,e,n){"use strict";t.exports=function(t,e){var n,i,r,s,a,o,l=t.pos;if(96!==t.src.charCodeAt(l))return!1;for(n=l,l++,i=t.posMax;l<i&&96===t.src.charCodeAt(l);)l++;for(r=t.src.slice(n,l),s=a=l;-1!==(s=t.src.indexOf("`",a));){for(a=s+1;a<i&&96===t.src.charCodeAt(a);)a++;if(a-s===r.length)return e||((o=t.push("code_inline","code",0)).markup=r,o.content=t.src.slice(l,s).replace(/[ \n]+/g," ").trim()),t.pos=a,!0}return e||(t.pending+=r),t.pos+=r.length,!0}},function(t,e,n){"use strict";var i=n(0).normalizeReference,r=n(0).isSpace;t.exports=function(t,e){var n,s,a,o,l,c,u,p,h,d="",g=t.pos,f=t.posMax,m=t.pos,y=!0;if(91!==t.src.charCodeAt(t.pos))return!1;if(l=t.pos+1,(o=t.md.helpers.parseLinkLabel(t,t.pos,!0))<0)return!1;if((c=o+1)<f&&40===t.src.charCodeAt(c)){for(y=!1,c++;c<f&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);if(c>=f)return!1;for(m=c,(u=t.md.helpers.parseLinkDestination(t.src,c,t.posMax)).ok&&(d=t.md.normalizeLink(u.str),t.md.validateLink(d)?c=u.pos:d=""),m=c;c<f&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);if(u=t.md.helpers.parseLinkTitle(t.src,c,t.posMax),c<f&&m!==c&&u.ok)for(h=u.str,c=u.pos;c<f&&(s=t.src.charCodeAt(c),r(s)||10===s);c++);else h="";(c>=f||41!==t.src.charCodeAt(c))&&(y=!0),c++}if(y){if(void 0===t.env.references)return!1;if(c<f&&91===t.src.charCodeAt(c)?(m=c+1,(c=t.md.helpers.parseLinkLabel(t,c))>=0?a=t.src.slice(m,c++):c=o+1):c=o+1,a||(a=t.src.slice(l,o)),!(p=t.env.references[i(a)]))return t.pos=g,!1;d=p.href,h=p.title}return e||(t.pos=l,t.posMax=o,t.push("link_open","a",1).attrs=n=[["href",d]],h&&n.push(["title",h]),t.md.inline.tokenize(t),t.push("link_close","a",-1)),t.pos=c,t.posMax=f,!0}},function(t,e,n){"use strict";var i=n(0).normalizeReference,r=n(0).isSpace;t.exports=function(t,e){var n,s,a,o,l,c,u,p,h,d,g,f,m,y="",C=t.pos,v=t.posMax;if(33!==t.src.charCodeAt(t.pos))return!1;if(91!==t.src.charCodeAt(t.pos+1))return!1;if(c=t.pos+2,(l=t.md.helpers.parseLinkLabel(t,t.pos+1,!1))<0)return!1;if((u=l+1)<v&&40===t.src.charCodeAt(u)){for(u++;u<v&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);if(u>=v)return!1;for(m=u,(h=t.md.helpers.parseLinkDestination(t.src,u,t.posMax)).ok&&(y=t.md.normalizeLink(h.str),t.md.validateLink(y)?u=h.pos:y=""),m=u;u<v&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);if(h=t.md.helpers.parseLinkTitle(t.src,u,t.posMax),u<v&&m!==u&&h.ok)for(d=h.str,u=h.pos;u<v&&(s=t.src.charCodeAt(u),r(s)||10===s);u++);else d="";if(u>=v||41!==t.src.charCodeAt(u))return t.pos=C,!1;u++}else{if(void 0===t.env.references)return!1;if(u<v&&91===t.src.charCodeAt(u)?(m=u+1,(u=t.md.helpers.parseLinkLabel(t,u))>=0?o=t.src.slice(m,u++):u=l+1):u=l+1,o||(o=t.src.slice(c,l)),!(p=t.env.references[i(o)]))return t.pos=C,!1;y=p.href,d=p.title}return e||(a=t.src.slice(c,l),t.md.inline.parse(a,t.md,t.env,f=[]),(g=t.push("image","img",0)).attrs=n=[["src",y],["alt",""]],g.children=f,g.content=a,d&&n.push(["title",d])),t.pos=u,t.posMax=v,!0}},function(t,e,n){"use strict";var i=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,r=/^<([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)>/;t.exports=function(t,e){var n,s,a,o,l,c,u=t.pos;return 60===t.src.charCodeAt(u)&&(!((n=t.src.slice(u)).indexOf(">")<0)&&(r.test(n)?(o=(s=n.match(r))[0].slice(1,-1),l=t.md.normalizeLink(o),!!t.md.validateLink(l)&&(e||((c=t.push("link_open","a",1)).attrs=[["href",l]],c.markup="autolink",c.info="auto",(c=t.push("text","",0)).content=t.md.normalizeLinkText(o),(c=t.push("link_close","a",-1)).markup="autolink",c.info="auto"),t.pos+=s[0].length,!0)):!!i.test(n)&&(o=(a=n.match(i))[0].slice(1,-1),l=t.md.normalizeLink("mailto:"+o),!!t.md.validateLink(l)&&(e||((c=t.push("link_open","a",1)).attrs=[["href",l]],c.markup="autolink",c.info="auto",(c=t.push("text","",0)).content=t.md.normalizeLinkText(o),(c=t.push("link_close","a",-1)).markup="autolink",c.info="auto"),t.pos+=a[0].length,!0))))}},function(t,e,n){"use strict";var i=n(10).HTML_TAG_RE;t.exports=function(t,e){var n,r,s,a=t.pos;return!!t.md.options.html&&(s=t.posMax,!(60!==t.src.charCodeAt(a)||a+2>=s)&&(!(33!==(n=t.src.charCodeAt(a+1))&&63!==n&&47!==n&&!function(t){var e=32|t;return e>=97&&e<=122}(n))&&(!!(r=t.src.slice(a).match(i))&&(e||(t.push("html_inline","",0).content=t.src.slice(a,a+r[0].length)),t.pos+=r[0].length,!0))))}},function(t,e,n){"use strict";var i=n(5),r=n(0).has,s=n(0).isValidEntityCode,a=n(0).fromCodePoint,o=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,l=/^&([a-z][a-z0-9]{1,31});/i;t.exports=function(t,e){var n,c,u=t.pos,p=t.posMax;if(38!==t.src.charCodeAt(u))return!1;if(u+1<p)if(35===t.src.charCodeAt(u+1)){if(c=t.src.slice(u).match(o))return e||(n="x"===c[1][0].toLowerCase()?parseInt(c[1].slice(1),16):parseInt(c[1],10),t.pending+=s(n)?a(n):a(65533)),t.pos+=c[0].length,!0}else if((c=t.src.slice(u).match(l))&&r(i,c[1]))return e||(t.pending+=i[c[1]]),t.pos+=c[0].length,!0;return e||(t.pending+="&"),t.pos++,!0}},function(t,e,n){"use strict";t.exports=function(t){var e,n,i,r,s=t.delimiters,a=t.delimiters.length;for(e=0;e<a;e++)if((i=s[e]).close)for(n=e-i.jump-1;n>=0;){if((r=s[n]).open&&r.marker===i.marker&&r.end<0&&r.level===i.level)if(!((r.close||i.open)&&void 0!==r.length&&void 0!==i.length&&(r.length+i.length)%3==0)){i.jump=e-n,i.open=!1,r.end=e,r.jump=0;break}n-=r.jump+1}}},function(t,e,n){"use strict";t.exports=function(t){var e,n,i=0,r=t.tokens,s=t.tokens.length;for(e=n=0;e<s;e++)i+=r[e].nesting,r[e].level=i,"text"===r[e].type&&e+1<s&&"text"===r[e+1].type?r[e+1].content=r[e].content+r[e+1].content:(e!==n&&(r[n]=r[e]),n++);e!==n&&(r.length=n)}},function(t,e,n){"use strict";var i=n(3),r=n(0).isWhiteSpace,s=n(0).isPunctChar,a=n(0).isMdAsciiPunct;function o(t,e,n,i){this.src=t,this.env=n,this.md=e,this.tokens=i,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[]}o.prototype.pushPending=function(){var t=new i("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t},o.prototype.push=function(t,e,n){this.pending&&this.pushPending();var r=new i(t,e,n);return n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.pendingLevel=this.level,this.tokens.push(r),r},o.prototype.scanDelims=function(t,e){var n,i,o,l,c,u,p,h,d,g=t,f=!0,m=!0,y=this.posMax,C=this.src.charCodeAt(t);for(n=t>0?this.src.charCodeAt(t-1):32;g<y&&this.src.charCodeAt(g)===C;)g++;return o=g-t,i=g<y?this.src.charCodeAt(g):32,p=a(n)||s(String.fromCharCode(n)),d=a(i)||s(String.fromCharCode(i)),u=r(n),(h=r(i))?f=!1:d&&(u||p||(f=!1)),u?m=!1:p&&(h||d||(m=!1)),e?(l=f,c=m):(l=f&&(!m||p),c=m&&(!f||d)),{can_open:l,can_close:c,length:o}},o.prototype.Token=i,t.exports=o},function(t,e,n){"use strict";function i(t){return Array.prototype.slice.call(arguments,1).forEach((function(e){e&&Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t}function r(t){return Object.prototype.toString.call(t)}function s(t){return"[object Function]"===r(t)}function a(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var o={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var l={"http:":{validate:function(t,e,n){var i=t.slice(e);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(i)?i.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,n){var i=t.slice(e);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(i)?e>=3&&":"===t[e-3]?0:e>=3&&"/"===t[e-3]?0:i.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,n){var i=t.slice(e);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(i)?i.match(n.re.mailto)[0].length:0}}},c="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",u="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function p(t){var e=t.re=n(65)(t.__opts__),i=t.__tlds__.slice();function o(t){return t.replace("%TLDS%",e.src_tlds)}t.onCompile(),t.__tlds_replaced__||i.push(c),i.push(e.src_xn),e.src_tlds=i.join("|"),e.email_fuzzy=RegExp(o(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(o(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(o(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(o(e.tpl_host_fuzzy_test),"i");var l=[];function u(t,e){throw new Error('(LinkifyIt) Invalid schema "'+t+'": '+e)}t.__compiled__={},Object.keys(t.__schemas__).forEach((function(e){var n=t.__schemas__[e];if(null!==n){var i={validate:null,link:null};if(t.__compiled__[e]=i,"[object Object]"===r(n))return!function(t){return"[object RegExp]"===r(t)}(n.validate)?s(n.validate)?i.validate=n.validate:u(e,n):i.validate=function(t){return function(e,n){var i=e.slice(n);return t.test(i)?i.match(t)[0].length:0}}(n.validate),void(s(n.normalize)?i.normalize=n.normalize:n.normalize?u(e,n):i.normalize=function(t,e){e.normalize(t)});!function(t){return"[object String]"===r(t)}(n)?u(e,n):l.push(e)}})),l.forEach((function(e){t.__compiled__[t.__schemas__[e]]&&(t.__compiled__[e].validate=t.__compiled__[t.__schemas__[e]].validate,t.__compiled__[e].normalize=t.__compiled__[t.__schemas__[e]].normalize)})),t.__compiled__[""]={validate:null,normalize:function(t,e){e.normalize(t)}};var p=Object.keys(t.__compiled__).filter((function(e){return e.length>0&&t.__compiled__[e]})).map(a).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+p+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+e.src_ZPCc+"))("+p+")","ig"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),function(t){t.__index__=-1,t.__text_cache__=""}(t)}function h(t,e){var n=t.__index__,i=t.__last_index__,r=t.__text_cache__.slice(n,i);this.schema=t.__schema__.toLowerCase(),this.index=n+e,this.lastIndex=i+e,this.raw=r,this.text=r,this.url=r}function d(t,e){var n=new h(t,e);return t.__compiled__[n.schema].normalize(n,t),n}function g(t,e){if(!(this instanceof g))return new g(t,e);var n;e||(n=t,Object.keys(n||{}).reduce((function(t,e){return t||o.hasOwnProperty(e)}),!1)&&(e=t,t={})),this.__opts__=i({},o,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=i({},l,t),this.__compiled__={},this.__tlds__=u,this.__tlds_replaced__=!1,this.re={},p(this)}g.prototype.add=function(t,e){return this.__schemas__[t]=e,p(this),this},g.prototype.set=function(t){return this.__opts__=i(this.__opts__,t),this},g.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;var e,n,i,r,s,a,o,l;if(this.re.schema_test.test(t))for((o=this.re.schema_search).lastIndex=0;null!==(e=o.exec(t));)if(r=this.testSchemaAt(t,e[2],o.lastIndex)){this.__schema__=e[2],this.__index__=e.index+e[1].length,this.__last_index__=e.index+e[0].length+r;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=t.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(s=n.index+n[1].length,(this.__index__<0||s<this.__index__)&&(this.__schema__="",this.__index__=s,this.__last_index__=n.index+n[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&t.indexOf("@")>=0&&null!==(i=t.match(this.re.email_fuzzy))&&(s=i.index+i[1].length,a=i.index+i[0].length,(this.__index__<0||s<this.__index__||s===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=s,this.__last_index__=a)),this.__index__>=0},g.prototype.pretest=function(t){return this.re.pretest.test(t)},g.prototype.testSchemaAt=function(t,e,n){return this.__compiled__[e.toLowerCase()]?this.__compiled__[e.toLowerCase()].validate(t,n,this):0},g.prototype.match=function(t){var e=0,n=[];this.__index__>=0&&this.__text_cache__===t&&(n.push(d(this,e)),e=this.__last_index__);for(var i=e?t.slice(e):t;this.test(i);)n.push(d(this,e)),i=i.slice(this.__last_index__),e+=this.__last_index__;return n.length?n:null},g.prototype.tlds=function(t,e){return t=Array.isArray(t)?t:[t],e?(this.__tlds__=this.__tlds__.concat(t).sort().filter((function(t,e,n){return t!==n[e-1]})).reverse(),p(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,p(this),this)},g.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),"mailto:"!==t.schema||/^mailto:/i.test(t.url)||(t.url="mailto:"+t.url)},g.prototype.onCompile=function(){},t.exports=g},function(t,e,n){"use strict";t.exports=function(t){var e={};e.src_Any=n(7).source,e.src_Cc=n(8).source,e.src_Z=n(9).source,e.src_P=n(1).source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");return e.src_pseudo_letter="(?:(?![><]|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|[><]|"+e.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|[><]|[()[\\]{}.,\"'?!\\-]).|\\[(?:(?!"+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-]).|\\.{2,4}[a-zA-Z0-9%/]|\\.(?!"+e.src_ZCc+"|[.]).|"+(t&&t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+"\\,(?!"+e.src_ZCc+").|\\!(?!"+e.src_ZCc+"|[!]).|\\?(?!"+e.src_ZCc+"|[?]).)+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy='(^|[><]|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+e.src_ZPCc+"))((?![$+<=>^`|])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}},function(t,e,n){(function(t,i){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){e&&e.nodeType,t&&t.nodeType;var a="object"==typeof i&&i;a.global!==a&&a.window!==a&&a.self;var o,l=2147483647,c=36,u=1,p=26,h=38,d=700,g=72,f=128,m="-",y=/^xn--/,C=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=c-u,x=Math.floor,I=String.fromCharCode;function S(t){throw new RangeError(A[t])}function k(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function _(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+k((t=t.replace(v,".")).split("."),e).join(".")}function E(t){for(var e,n,i=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function w(t){return k(t,(function(t){var e="";return t>65535&&(e+=I((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=I(t)})).join("")}function P(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function T(t,e,n){var i=0;for(t=n?x(t/d):t>>1,t+=x(t/e);t>b*p>>1;i+=c)t=x(t/b);return x(i+(b+1)*t/(t+h))}function D(t){var e,n,i,r,s,a,o,h,d,y,C,v=[],A=t.length,b=0,I=f,k=g;for((n=t.lastIndexOf(m))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&S("not-basic"),v.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<A;){for(s=b,a=1,o=c;r>=A&&S("invalid-input"),((h=(C=t.charCodeAt(r++))-48<10?C-22:C-65<26?C-65:C-97<26?C-97:c)>=c||h>x((l-b)/a))&&S("overflow"),b+=h*a,!(h<(d=o<=k?u:o>=k+p?p:o-k));o+=c)a>x(l/(y=c-d))&&S("overflow"),a*=y;k=T(b-s,e=v.length+1,0==s),x(b/e)>l-I&&S("overflow"),I+=x(b/e),b%=e,v.splice(b++,0,I)}return w(v)}function M(t){var e,n,i,r,s,a,o,h,d,y,C,v,A,b,k,_=[];for(v=(t=E(t)).length,e=f,n=0,s=g,a=0;a<v;++a)(C=t[a])<128&&_.push(I(C));for(i=r=_.length,r&&_.push(m);i<v;){for(o=l,a=0;a<v;++a)(C=t[a])>=e&&C<o&&(o=C);for(o-e>x((l-n)/(A=i+1))&&S("overflow"),n+=(o-e)*A,e=o,a=0;a<v;++a)if((C=t[a])<e&&++n>l&&S("overflow"),C==e){for(h=n,d=c;!(h<(y=d<=s?u:d>=s+p?p:d-s));d+=c)k=h-y,b=c-y,_.push(I(P(y+k%b,0))),h=x(k/b);_.push(I(P(h,0))),s=T(n,A,i==r),n=0,++i}++n,++e}return _.join("")}o={version:"1.4.1",ucs2:{decode:E,encode:w},decode:D,encode:M,toASCII:function(t){return _(t,(function(t){return C.test(t)?"xn--"+M(t):t}))},toUnicode:function(t){return _(t,(function(t){return y.test(t)?D(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}()}).call(this,n(67)(t),n(68))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";t.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}}},function(t,e,n){"use strict";t.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}}},function(t,e,n){"use strict";t.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}}},function(t,e,n){const i=n(73).initialize,r=n(74).initialize,s=()=>{i(),r()};e.initialize=s},function(t,e,n){const i=n(4).CardElement,r=()=>{const t=i.prototype.render;i.prototype.render=function(e){const n=t.call(this,e);return n&&this.id&&(n.id=this.id),n}},s=()=>{r()};e.initialize=s},function(t,e,n){const i=n(4).ColumnSet,r=()=>{i.prototype.insertItemAt=function(t,e,n){if(t.parent&&!n)throw new Error("The element already belongs to another container.");e<0||e>=this._columns.length?this._columns.push(t):this._columns.splice(e,0,t),t.setParent(this)}},s=()=>{i.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._columns.indexOf(e),!1)}},a=()=>{i.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._columns.indexOf(e)+1,!1)}},o=()=>{r(),s(),a()};e.initialize=o},function(t,e,n){var i=null;class r{constructor(t){i=this,this.supportMoreAction=!1,this.supportInvokeAddinAction=!0,this.supportDisplayAppointmentFormAction=!0,this.supportDisplayMessageFormAction=!0,this.supportTransactionAction=!1,this.supportImageProxy=!0,this.supportAttachmentImageProxy=!0,this.supportMessageCard=!0,this.supportDynamicTextArea=!1,this.supportReverseRowForChoiceSet=!1,this.supportInlineShowCard=!0,this.supportDynamicTheming=!0,this.resolveDependencies(),this.themeConfigs=[],this.themeConfigs.push(new this.ThemeClass(this.constants.DefaultStyle,{choiceSetInputValueSeparator:";",supportsInteractivity:!0,fontFamily:"Segoe UI",fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},lineHeights:{small:18,default:20,medium:21,large:23,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0A8533",subtle:"#0A8533"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#E4252B",subtle:"#F17A7D"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0a8031",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#DA1B21",subtle:"#F17A7D"}},backgroundColor:"#F8F8F8"}},spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#E1E1E1"},actions:{maxActions:5,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:8}},this.constants.WinClient,null,!0,!0,!0,!0,!0,!0,!1)),this.themeConfigs.push(new this.ThemeClass(this.constants.CompactProperty,{choiceSetInputValueSeparator:";",supportsInteractivity:!0,fontFamily:"Segoe UI",fontSizes:{small:10,default:12,medium:14,large:16,extraLarge:18},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:16,medium:32,large:64},containerStyles:{default:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0A8533",subtle:"#0A8533"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#E4252B",subtle:"#F17A7D"}},backgroundColor:"#eaeaea"},emphasis:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0a8031",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#DA1B21",subtle:"#F17A7D"}},backgroundColor:"#F8F8F8"}},spacing:{small:10,default:12,medium:14,large:16,extraLarge:18,padding:8},separator:{lineThickness:1,lineColor:"#E1E1E1"},actions:{maxActions:5,spacing:"Default",buttonSpacing:20,showCard:{actionMode:"Inline",inlineTopMargin:10,style:"emphasis"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:8}},this.constants.WinClient,"messageCardCompact",!1,!1,!1,!1,!0,!0,!1)),this.adaptiveCardHostConfig={choiceSetInputValueSeparator:",",supportsInteractivity:!0,fontFamily:"Segoe UI",spacing:{small:8,default:16,medium:16,large:24,extraLarge:32,padding:16},separator:{lineThickness:1,lineColor:"#E1E1E1"},fontSizes:{small:12,default:14,medium:16,large:18,extraLarge:20},lineHeights:{small:18,default:20,medium:21,large:23,extraLarge:24},fontWeights:{lighter:300,default:400,bolder:500},imageSizes:{small:40,medium:160,large:320},containerStyles:{default:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0A8533",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#E4252B",subtle:"#F17A7D"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#FFFFFF"},emphasis:{foregroundColors:{default:{default:"#212121",subtle:"#8e8e93"},dark:{default:"#1F1F1F",subtle:"#707070"},light:{default:"#707070",subtle:"#8e8e93"},accent:{default:"#0078d7",subtle:"#69afe5"},good:{default:"#0a8031",subtle:"#5BA975"},warning:{default:"#FFA800",subtle:"#F2BE4D"},attention:{default:"#DA1B21",subtle:"#F17A7D"},hyperlink:{default:"#005A9E",subtle:"#005A9E"},white:{default:"#FFFFFF",subtle:"#FFFFFF"}},backgroundColor:"#F8F8F8"}},actions:{maxActions:5,spacing:"",buttonSpacing:8,showCard:{actionMode:"Inline",style:"default"},preExpandSingleShowCardAction:!0,actionsOrientation:"Horizontal"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"Medium",maxImageHeight:102},factSet:{title:{size:"Default",color:"Default",isSubtle:!0,weight:"Lighter",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:8}},this.spinnerUrl="https://messagecarddemo.blob.core.windows.net/messagecard/LoadingSpinner_iOS.gif",this.successStatusImageUrl="https://messagecarddemo.blob.core.windows.net/messagecard/success_iOS.png",this.errorStatusImageUrl="https://messagecarddemo.blob.core.windows.net/messagecard/error_iOS.png",this.imageAttachmentBaseUrl="cid:",this.imageAttachmentProxyUrl="http://0.0.0.0/img?src=",this.imageProxyUrl="http://0.0.0.0/imgproxy?src=",this.choiceInputDefaultPlaceHolderText="Select an option",this.dateInputDefaultPlaceHolderText="Select a date",this.numberInputDefaultPlaceHolderText="Enter a number",this.textInputDefaultPlaceHolderText="Type here",this.VALUE_TOO_SMALL_STRING_KEY="The number in '{0}' must be greater than {1}",this.VALUE_TOO_LARGE_STRING_KEY="The number in '{0}' must be less than {1}",this.bodyPadding=12,this.containerPadding=16,this.factKeyTopPadding=16,this.factValueTopPadding=4,this.checkboxRightMargin=8,this.imageMargin=4,this.context=t,this.containerWidth=this.getContainerWidth(),this.setHostCapabilities(),this.snackBarTimer=null}setHostCapabilities(){this.capabilities=new AdaptiveCards.HostCapabilities,this.capabilities.parse({AADAuthentication:"*"},null)}resolveDependencies(){this.ImageClass=n(76).Image,this.FactSetClass=n(77).FactSet,this.ImageSetClass=n(78).ImageSet,this.NumberInputClass=n(79).NumberInput,this.TextInputClass=n(80).TextInput,this.HttpActionClass=n(81).HttpAction,this.ToggleVisibilityActionClass=n(82).ToggleVisibilityAction,this.InvokeAddinActionClass=n(83).InvokeAddinAction,this.DisplayAppointmentFormActionClass=n(84).DisplayAppointmentFormAction,this.DisplayMessageFormActionClass=n(85).DisplayMessageFormAction,this.TransactionActionClass=n(86).TransactionAction,this.ThemeClass=n(87).Theme,this.UtilsClass=n(13).Utils,this.Separator=n(88).Separator,this.ToggleInputClass=n(89).ToggleInput,this.DateInputClass=n(90).DateInput,this.ChoiceSetInputClass=n(91).ChoiceSetInput,this.constants=this.UtilsClass.Constants,AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Separator",(function(){return new i.Separator(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Image",(function(){return new i.ImageClass})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("ImageSet",(function(){return new i.ImageSetClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.unregisterType("Input.Time"),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Input.Text",(function(){return new i.TextInputClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Input.Number",(function(){return new i.NumberInputClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("FactSet",(function(){return new i.FactSetClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("ImageSet",(function(){return new i.ImageSetClass(i)})),AdaptiveCards.AdaptiveCard.actionTypeRegistry.unregisterType("Action.Submit"),AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.Http",(function(){return new i.HttpActionClass(i)})),AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.ToggleVisibility",(function(){return new i.ToggleVisibilityActionClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Input.Toggle",(function(){return new i.ToggleInputClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Input.ChoiceSet",(function(){return new i.ChoiceSetInputClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Input.Date",(function(){return new i.DateInputClass(i)})),this.supportInvokeAddinAction&&AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.InvokeAddInCommand",(function(){return new i.InvokeAddinActionClass(i)})),this.supportDisplayAppointmentFormAction&&AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.DisplayAppointmentForm",(function(){return new i.DisplayAppointmentFormActionClass(i)})),this.supportDisplayMessageFormAction&&AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.DisplayMessageForm",(function(){return new i.DisplayMessageFormActionClass(i)})),this.supportTransactionAction&&AdaptiveCards.AdaptiveCard.actionTypeRegistry.registerType("Action.Transaction",(function(){return new i.TransactionActionClass(i)})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("ActionSet",(function(){return new AdaptiveCards.ActionSet})),AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType("Column",(function(){return new AdaptiveCards.Column}))}getElementInstance(t){var e=null;switch(t){case this.constants.ImageSet:e=new this.ImageSetClass(this);break;case this.constants.FactSet:e=new this.FactSetClass(this);break;case this.constants.HttpAction:e=new this.HttpActionClass(this);break;case this.constants.Separator:e=new this.Separator(this);break;case this.constants.InvokeAddinCommandAction:e=new this.InvokeAddinActionClass(this);break;case this.constants.DisplayAppointmentFormAction:e=new this.DisplayAppointmentFormActionClass(this);break;case this.constants.DisplayMessageFormAction:e=new this.DisplayMessageFormActionClass(this);break;case this.constants.DateInput:e=new this.DateInputClass(this);break;case this.constants.ChoiceSetInput:e=new this.ChoiceSetInputClass(this)}return e}getThemeConfigs(){return this.themeConfigs}getACHostConfigs(t){try{if(this.supportDynamicTheming&&null!=t&&(t.stylesheet&&this.UtilsClass.applyCSS(t.stylesheet),t.hostConfig)){let e=t.hostConfig;if(e)return[e]}}catch(t){}return[this.adaptiveCardHostConfig]}getContainerWidth(){return(window.innerWidth||document.body.clientWidth)-2*this.bodyPadding-2*this.containerPadding-4}processData(t){return t}postRender(){this.notifyHeightChange()}storeClientTelemetryProperties(t){this.postWebViewMessage("storeClientTelemetryProperties",JSON.stringify(t))}onToggleClicked(){}setComponentVisibility(t,e,n,i){var r=document.getElementById("actionable-message"),s=document.getElementById("mainframe"),a=document.getElementById("amWrapperDiv");if(a&&i)if(this.context&&this.context.hostConfig){var o="640px",l="center";this.context.hostConfig.cardMaximumWidth&&"number"==typeof(o=this.context.hostConfig.cardMaximumWidth)&&(o+="px"),this.context.hostConfig.cardHorizontalAlignment&&(l=this.context.hostConfig.cardHorizontalAlignment),this.context.hostConfig.cardHostBackgroundColor&&a.parentElement&&(a.parentElement.style.backgroundColor=this.context.hostConfig.cardHostBackgroundColor),a.style.maxWidth=o,"center"===l&&(a.style.margin="auto")}else a.classList.add("am-wrapper");a&&(a.style.display=t?"block":"none"),r&&(r.style.display=t?"block":"none"),s&&(s.style.display=n?"block":"none"),!1===t&&this.postWebViewMessage("hideCardAndShowBody")}displayLoginMessage(t,e,n){}displaySnackMessage(t,e){var n=5e3;this.context&&this.context.snackbarTimeout&&"number"==typeof this.context.snackbarTimeout&&(n=this.context.snackbarTimeout);var i=document.getElementById("amSnackBar");i.innerHTML="",i.classList="",i.classList.add("amsnackbar");var r=document.getElementById("amSnackBarSpan");r||(r=document.createElement("span")),r.classList="",r.id="amSnackBarSpan",e?r.classList.add("success-icon"):r.classList.add("error-icon"),i.appendChild(r);var s=document.getElementById("snackMessage");s||(s=document.createElement("span")),s.id="snackMessage",s.setAttribute("style","padding-left:8px;"),s.innerHTML=t,i.appendChild(s),i.classList.add("show"),this.snackBarTimer&&(clearTimeout(this.snackBarTimer),this.snackBarTimer=null),this.snackBarTimer=setTimeout((function(){i.classList.add("fadeout-hide"),i.classList.remove("show")}),n)}executeAction(t,e,n){try{var i={[this.constants.PotentialActionProperty]:t.potentialAction,[this.constants.IsAutoInvokeAction]:t.isAutoInvokeAction,[this.constants.IsAdaptiveCardAction]:e};t.data&&Array.isArray(t.data)&&(i[this.constants.DataProperty]=JSON.stringify(t.data)),this.postWebViewMessage("onActionSubmit",JSON.stringify(i))}catch(t){}}executeAuthFlowForHttpAction(t,e,n,i){try{var r={[this.constants.PotentialActionProperty]:t.potentialAction,[this.constants.ErrorProperty]:e,[this.constants.InvokeAuthFlow]:!0,[this.constants.AuthenticationUrl]:n,[this.constants.DisplayMessageProperty]:i};t.data&&Array.isArray(t.data)&&(r[this.constants.DataProperty]=JSON.stringify(t.data)),this.postWebViewMessage("onActionSubmit",JSON.stringify(r))}catch(t){}}executePleaseLoginAction(t){if(t){var e={[this.constants.PotentialActionProperty]:{"@type":"ConnectorsLoginAction",loginUrl:t},[this.constants.IsAutoInvokeAction]:!1,[this.constants.IsAdaptiveCardAction]:!1};this.postWebViewMessage("onActionSubmit",JSON.stringify(e))}}updateExplicitMessageCardProperty(){}logEventTelemetry(t){let e={eventName:t};this.postWebViewMessage("logEventTelemetry",JSON.stringify(e))}logEventTelemetryWithActionId(t,e){let n={eventName:t,actionId:e};this.postWebViewMessage("logEventTelemetry",JSON.stringify(n))}logTimeStamp(t,e){}logException(t){}notifyHeightChange(){var t=document&&document.documentElement?document.documentElement.offsetHeight:0,e={[this.constants.HeightProperty]:t};this.postWebViewMessage("notifyHeightChange",JSON.stringify(e))}notifyRefreshCardResponse(t){this.postWebViewMessage("handleRefreshCard",JSON.stringify(t))}logInitialCardProcessingEnd(){this.postWebViewMessage("logInitialCardProcessingEnd")}logInitialCardRenderingEnd(){this.postWebViewMessage("logInitialCardRenderingEnd")}logFinalCardProcessingEnd(){this.postWebViewMessage("logFinalCardProcessingEnd")}logFinalCardRenderingEnd(){this.postWebViewMessage("logFinalCardRenderingEnd")}executeShowCardAction(t,e,n){try{var i={[this.constants.PotentialActionProperty]:t.potentialAction,[this.constants.IsAutoInvokeAction]:t.isAutoInvokeAction,[this.constants.IsAdaptiveCardAction]:e,[this.constants.IsShowCardExpanded]:n};null!=t.data&&t.data.length>0&&(i[this.constants.DataProperty]=JSON.stringify(t.data)),this.postWebViewMessage("onActionSubmit",JSON.stringify(i))}catch(t){}}webview(){const t=window&&window.chrome;return t&&t.webview}postWebViewMessage(t,e){const n=this.webview();n&&"function"==typeof n.postMessage&&window.chrome.webview.postMessage({notificationType:t,asyncContext:e})}getImageProxyUrl(){return this.imageProxyUrl}}e.ClientManager=r},function(t,e,n){class i extends AdaptiveCards.Image{constructor(){super()}internalRender(){var t=super.internalRender();if(!t)return t;var e=t.children[0];e.alt&&"undefined"!==e.alt||(e.alt="User defined image"),t.removeChild(t.lastChild);var n=document.createElement("div");return n.style.display="flex",n.style.alignItems="flex-start",n.style.width="100%",n.style.justifyContent=t.style.justifyContent,n.style.boxSizing=t.style.boxSizing,n.style.flex=t.style.flex,n.appendChild(e),t.appendChild(n),t}}e.Image=i},function(t,e,n){class i extends AdaptiveCards.FactSet{constructor(t){super(),this.clientManagerInstance=t}parse(t){if(this.facts=[],null!=t.facts){var e=t.facts;this.facts=[];for(var n=0;n<e.length;n++)if(e[n].title&&e[n].value){var i=new AdaptiveCards.Fact;i.name=e[n].title,i.value=e[n].value,i.speak=e[n].speak,this.facts.push(i)}}}}e.FactSet=i},function(t,e,n){class i extends AdaptiveCards.ImageSet{constructor(t){super(),this.clientManagerInstance=t}parse(t,e){if(this.imageSize=AdaptiveCards.getEnumValueOrDefault(AdaptiveCards.Size,t.imageSize,AdaptiveCards.Size.Medium),t.images){var n=t.images;this._images=[];for(var i=0;i<n.length;i++){var r=new this.clientManagerInstance.ImageClass;r.parse(n[i],e),this.addImage(r)}}}internalRender(){var t=null,e=(this.clientManagerInstance.getContainerWidth()-8)/2;if(this._images.length>0){(t=document.createElement("div")).style.margin="-"+this.clientManagerInstance.imageMargin+"px",t.style.display="flex",t.style.flexWrap="wrap";for(var n=0;n<this._images.length;n++){this._images[n].size=this.imageSize;var i=this._images[n].render();i.style.display="inline-flex";var r=i.children[0].children[0];switch(i.style.margin=this.clientManagerInstance.imageMargin+"px",r.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px",this.imageSize){case AdaptiveCards.Size.Auto:r.style.width="auto",r.style.maxWidth=e+"px";break;case AdaptiveCards.Size.Stretch:r.style.width=e+"px",r.style.maxWidth=e+"px"}t.appendChild(i)}}return t}}e.ImageSet=i},function(t,e,n){class i extends AdaptiveCards.NumberInput{constructor(t){super(),this.clientManagerInstance=t,this.utils=this.clientManagerInstance.UtilsClass}openNumberPop(){if(null!=this.clientManagerInstance){var t={id:this.id,placeholder:this.placeholder,isRequired:this.isRequired,min:this.min,max:this.max,value:this.value};this.clientManagerInstance.openNumberPop(t)}}setNumber(t){this._numberInputElement.value=t,this.handleInputChanged&&this.handleInputChanged()}internalRender(){var t=this;this.placeholder=this.placeholder||this.clientManagerInstance.numberInputDefaultPlaceHolderText,this.isRequired&&(this.placeholder=this.placeholder+"*");var e=super.internalRender();return e.addEventListener("keydown",(function(t){var e;e=t.key,!Number.isNaN(parseInt(e))||function(e){if(8===e||9===e||13===e||27===e||e>=35&&e<=40||46===e)return!0;if(189===e){return t.target.validity.valid&&!t.target.value.length}return!1}(t.keyCode)||function(t){return(t.ctrlKey||t.metaKey)&&(67===t.keyCode||88===t.keyCode||86===t.keyCode)}(t)||t.preventDefault()})),e.addEventListener("paste",(function(t){var e=t.clipboardData.getData("text/plain");Number.isNaN(parseInt(e))&&t.preventDefault()})),e.addEventListener("input",(function(n){var i=parseInt(n.target.getAttribute("min")),r=parseInt(n.target.getAttribute("max"));const s=n.target.validity.valid,a=n.target.value.length,o=s&&!a,l=!s&&n.target.validity.badInput,c=!s&&(n.target.validity.rangeOverflow||n.target.validity.rangeUnderflow);var u;o||!l&&!c?((u=t.inputElement.querySelector("#numberErrorElement"))&&(e.classList.remove("error"),u.remove()),t.hasSomeError=!0):(e.classList.add("error"),null===(u=t.inputElement.querySelector("#numberErrorElement"))&&((u=document.createElement("div")).id="numberErrorElement",u.className="numberErrorElement",t.inputElement.appendChild(u),t.hasSomeError=!0),u.innerText=c?"Select a value between "+i+" and "+r:"Please enter a valid number")})),this.getRestoredState(e),this.inputElement=document.createElement("div"),!this.clientManagerInstance.supportInputPop||this.clientManagerInstance.context&&this.clientManagerInstance.context.isShowCardJson||(this.handleInputChanged=e.oninput,e.readOnly="true",e.onfocus=function(){e.blur(),t.openNumberPop()},this.inputElement.numberInputInstance=this),this.clientManagerInstance.showPlaceholderDivOnInputFocus&&(this.placeHolderElement=document.createElement("span"),this.placeHolderElement.className="ac-placeHolder",this.placeHolderElement.innerText=this.placeholder,this.placeHolderElement.style.display=this.value?"block":"none",this.inputElement.appendChild(this.placeHolderElement)),this.inputElement.appendChild(e),this.inputElement}ValueInRange(t){let e=!1;if(!Number.isNaN(t)){var n=parseInt(this.min),i=parseInt(this.max);e=Number.isNaN(n)||Number.isNaN(i)?Number.isNaN(n)?!!Number.isNaN(i)||t<=i:t>=n:t>=n&&t<=i}return e}validate(){if(!this.value&&!this.isRequired)return[];var t=Number(this.value),e=this.min?Number(this.min):void 0,n=this.max?Number(this.max):void 0;this.placeholder;return e&&t<e?[{error:AdaptiveCards.ValidationError.InvalidPropertyValue,message:this.utils.format(this.clientManagerInstance.VALUE_TOO_SMALL_STRING_KEY,this.placeholder,e)}]:n&&t>n?[{error:AdaptiveCards.ValidationError.InvalidPropertyValue,message:this.utils.format(this.clientManagerInstance.VALUE_TOO_LARGE_STRING_KEY,this.placeholder,n)}]:[]}getRestoredState(t){this.clientManagerInstance.restoredInputs&&this.clientManagerInstance.restoredInputs.hasOwnProperty(this.id)&&(t.value=this.clientManagerInstance.restoredInputs[this.id])}}e.NumberInput=i},function(t,e,n){class i extends AdaptiveCards.TextInput{constructor(t){super(),this.clientManagerInstance=t}openTextPop(t){if(null!=this.clientManagerInstance){this.actualValue=this.actualValue?this.actualValue:this.value;var e={id:this.id,placeholder:this.placeholder,isRequired:this.isRequired,isMultiline:t,maxLength:this.maxLength,style:this.style,value:this.actualValue};this.clientManagerInstance.openTextPop(e)}}setText(t,e){this.actualValue=t,this._inputElement.value=e,this.handleInputChanged&&this.handleInputChanged()}internalRender(){var t=this,e=this.isMultiline;this.placeholder=this.placeholder||this.clientManagerInstance.textInputDefaultPlaceHolderText,this.isRequired&&(this.placeholder=this.placeholder+"*"),!this.clientManagerInstance.supportInputPop||this.clientManagerInstance.context&&this.clientManagerInstance.context.isShowCardJson||(this.isMultiline=!1);var n=super.internalRender();this.getRestoredState(n);var i=document.createElement("div");if(!this.clientManagerInstance.supportInputPop||this.clientManagerInstance.context&&this.clientManagerInstance.context.isShowCardJson||(this.handleInputChanged=n.oninput,n.readOnly="true",n.onfocus=function(){n.blur(),t.openTextPop(e)},i.textInputInstance=this),this.clientManagerInstance.showPlaceholderDivOnInputFocus&&(this.placeHolderElement=document.createElement("span"),this.placeHolderElement.className="ac-placeHolder",this.placeHolderElement.innerText=this.placeholder,this.placeHolderElement.style.display=this.value?"block":"none",i.appendChild(this.placeHolderElement)),this.clientManagerInstance.supportDynamicTextArea&&this.isMultiline){n.rows="1",n.style.overflowY="hidden",n.resize="none",n.style.boxSizing="border-box";document.addEventListener("input",(function(e){"textarea"===e.target.tagName.toLowerCase()&&(n.style.height=0,t.autoExpand(e.target,41,90))}),!1)}return i.appendChild(n),i}autoExpand(t,e,n){var i=parseInt(window.getComputedStyle(t).height)-t.clientHeight;t.style.height=0,t.style.overflowY="hidden";var r=t.scrollHeight+i;r<e&&(r=e),r>n&&(t.style.overflowY="visible",r=n),t.style.height=r+"px"}getRestoredState(t){this.clientManagerInstance.restoredInputs&&this.clientManagerInstance.restoredInputs.hasOwnProperty(this.id)&&(this.actualValue=this.clientManagerInstance.restoredInputs[this.id],t.value=this.clientManagerInstance.UtilsClass.replaceAll(this.actualValue,"\n"," "))}}e.TextInput=i},function(t,e,n){class i extends AdaptiveCards.HttpAction{constructor(t){super(),this.hideCardOnInvoke=!1,this.constants=t.constants,this.inputIds=[]}parse(t){super.parse(t),this.inputIds=this.extractInputIds(t)}parseMessageCardAction(t){if(this.method="POST",this.body=t[this.constants.BodyProperty],this.title=t[this.constants.NameProperty],this.url=t[this.constants.TargetProperty],this.id=t[this.constants.IdProperty],this.isPrimary=t[this.constants.IsPrimaryAction]||!1,null!=t[this.constants.HeadersProperty])for(var e=t[this.constants.HeadersProperty],n=0;n<e.length;n++){var i=new AdaptiveCards.HttpHeader;i.name=e[n][this.constants.NameProperty],i.value=e[n][this.constants.ValueProperty],this.headers.push(i)}null!=t[this.constants.BodyContentTypeProperty]&&(this.bodyContentType=t[this.constants.BodyContentTypeProperty]),null!=t[this.constants.HideCardOnInvokeProperty]&&(this.hideCardOnInvoke=t[this.constants.HideCardOnInvokeProperty]),this.inputIds=this.extractInputIds(t)}prepare(t){this.data=[];for(var e=0;e<t.length;e++)if(-1!=this.inputIds.indexOf(t[e].id)){var n=null;if(null!=t[e].value){n=t[e].actualValue?t[e].actualValue:t[e].value;var i=t[e].validate(),r={id:t[e].id,value:n};i&&i.length>0&&(r.validationErrors=i),this.data.push(r)}}}extractInputIds(t){for(var e,n=/\{{2}([a-z0-9_$@-]+).value\}{2}/gi,i=[];null!=(e=n.exec(t.url));)i.push(e[1]);for(;null!=(e=n.exec(t.body));)i.push(e[1]);if(null!=t.headers)for(var r=t.headers,s=0;s<r.length;s++){var a=r[s];if(a.value)for(;null!=(e=n.exec(a.value));)i.push(e[1])}return i}}e.HttpAction=i},function(t,e,n){class i extends AdaptiveCards.Action{constructor(t){super(),this.targetElements=[],this.constants=t.constants,this.ClientManagerInstance=t}getJsonTypeName(){return"Action.ToggleVisibility"}parse(t){super.parse(t),this.targetElements=t[this.constants.TargetElements]}execute(){super.execute();var t=this.id?this.id:"";if(this.ClientManagerInstance.logEventTelemetryWithActionId(this.constants.ToggleVisibilityClicked,t),this.targetElements){for(var e=0;e<this.targetElements.length;e++){var n,i=this.targetElements[e];"string"==typeof i?(n=this.parent.getRootElement().getElementById(i))&&(n.isVisible=!n.isVisible):"object"==typeof i&&i.hasOwnProperty(this.constants.ElementId)&&i.hasOwnProperty(this.constants.IsVisible)&&(n=this.parent.getRootElement().getElementById(i[this.constants.ElementId]))&&(n.isVisible=i.isVisible)}this.ClientManagerInstance.notifyHeightChange()}}}e.ToggleVisibilityAction=i},function(t,e,n){class i extends AdaptiveCards.Action{constructor(t){super(),this.constants=t.constants}getJsonTypeName(){return"Action.InvokeAddInCommand"}parse(t){super.parse(t),this.addinId=t[this.constants.AddInId],this.desktopCommandId=t[this.constants.DesktopCommandId],this.initializationContext=t[this.constants.InitializationContext]}}e.InvokeAddinAction=i},function(t,e,n){class i extends AdaptiveCards.Action{constructor(t){super(),this.constants=t.constants}getJsonTypeName(){return"Action.DisplayAppointmentForm"}parse(t){super.parse(t),this.itemId=t[this.constants.ItemId]}}e.DisplayAppointmentFormAction=i},function(t,e,n){class i extends AdaptiveCards.Action{constructor(t){super(),this.constants=t.constants}getJsonTypeName(){return"Action.DisplayMessageForm"}parse(t){super.parse(t),this.itemId=t[this.constants.ItemId]}}e.DisplayMessageFormAction=i},function(t,e,n){class i extends AdaptiveCards.Action{constructor(t){super(),this.constants=t.constants}getJsonTypeName(){return"Action.Transaction"}parse(t){super.parse(t),t[this.constants.InitializationContext]&&(this.merchantId=t[this.constants.InitializationContext][this.constants.MerchantId],this.displayId=t[this.constants.InitializationContext][this.constants.DisplayId],this.productContext=t[this.constants.InitializationContext][this.constants.ProductContext])}}e.TransactionAction=i},function(t,e,n){class i{constructor(t,e,n,i,r,s,a,o,l,c,u){this.style=t,this.hostConfig=e,this.client=n,this.cssPrefix=i,this.allowCardTitle=r,this.allowFacts=s,this.allowHeroImage=a,this.allowImages=o,this.allowActionCard=l,this.allowAutoInvokeAction=c,this.allowDisplayMoreAction=u}}e.Theme=i},function(t,e,n){class i extends AdaptiveCards.CardElement{constructor(t){super(),this.thickness=.5}getJsonTypeName(){return"Separator"}internalRender(){var t=document.createElement("div");return t.style.paddingTop="0.25px",t.style.paddingBottom="0.25px",t.style.borderTop=this.thickness+"px solid rgb(225, 225, 225)",t.style.marginRight="-16px",t.style.marginLeft="-16px",t}}e.Separator=i},function(t,e,n){class i extends AdaptiveCards.ToggleInput{constructor(t){super(),this.clientManagerInstance=t}internalRender(){var t=this,e=document.createElement("div");e.style.alignItems="center",e.className=this.hostConfig.makeCssClassName("ac-toggleinput"),e.style.width="100%",e.style.display="flex",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this._checkboxInputElement.setAttribute("aria-label",this.title?this.title:this.getJsonTypeName()),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){t.valueChanged()};var n=null;if(this.title){var i=new AdaptiveCards.TextBlock;i.hostConfig=this.hostConfig,i.text=this.title,i.useMarkdown=AdaptiveCards.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox,i.wrap=!0,(n=i.render()).style.display="inline-block",n.style.flex="1 1 auto",n.style.verticalAlign="middle",n.style.paddingLeft="8px"}if(this._checkboxInputElement.style.marginRight=this.clientManagerInstance.checkboxRightMargin+"px",t.isRequired){var r=document.createElement("span");r.classList.add("required-asteriks"),r.innerHTML="*",e.appendChild(r)}return e.appendChild(this._checkboxInputElement),this.title&&e.appendChild(n),e}}e.ToggleInput=i},function(t,e,n){class i extends AdaptiveCards.DateInput{constructor(t){super(),this.clientManagerInstance=t}parse(t){super.parse(t),this.min=t.min,this.max=t.max}internalRender(){let t=super.internalRender();var e=this;return this.defaultValue?this.selectedDate=this.clientManagerInstance.UtilsClass.formatDate(this.defaultValue):this.selectedDate=null,this.placeholder=this.placeholder||this.clientManagerInstance.dateInputDefaultPlaceHolderText,t.setAttribute("aria-label",this.getAriaLabel(this.placeholder,this.selectedDate?this.selectedDate:"")),this.isRequired&&(this.placeholder=this.placeholder+"*"),this.min&&t.setAttribute("min",this.min),this.max&&t.setAttribute("max",this.max),t.onchange=function(){e.valueChanged()},t}getAriaLabel(t,e){return"Date Input "+t+" "+e+" Use numeric keys or arrow keys to change value. Use tab or arrow keys to move to next field"}}e.DateInput=i},function(t,e,n){class i extends AdaptiveCards.ChoiceSetInput{constructor(t){super(),this.clientManagerInstance=t}internalRender(){var t=this;if(this.isMultiSelect){var e,n=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;(e=document.createElement("div")).className="ac-input ac-multiInput",e.style.width="100%",this._toggleInputs=[];const t=this.choices.length;var i=!1;1===t&&this.isRequired&&(i=!0);for(a=0;a<t;a++)e.appendChild(this.getCheckboxElement(this.choices[a],n,i));return this.isRequired&&!i&&(this.isRequiredElement=document.createElement("span"),this.isRequiredElement.className="ac-requiredPlaceHolder",this.isRequiredElement.innerText="*Required",this.isRequiredElement.style.marginTop="8px",this.isRequiredElement.style.marginBottom="8px",e.appendChild(this.isRequiredElement)),e}if(this.isCompact){var r=this.placeholder||this.clientManagerInstance.choiceInputDefaultPlaceHolderText;this.isRequired&&(r+="*"),this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dropdown"),this._selectElement.style.width="100%";var s=document.createElement("option");s.selected=!0,s.disabled=!0,s.hidden=!0,s.value="",r&&(s.text=r),this._selectElement.appendChild(s);for(var a=0;a<this.choices.length;a++){var o=document.createElement("option");o.value=this.choices[a].value,o.text=this.choices[a].title,o.setAttribute("aria-label",this.choices[a].title),this.choices[a].value==this.defaultValue&&(o.selected=!0),this._selectElement.appendChild(o)}return this._selectElement.onchange=function(){t.valueChanged()},this._selectElement}(e=document.createElement("div")).className="ac-input ac-singleInput",e.style.width="100%",this._toggleInputs=[];for(var a=0;a<this.choices.length;a++)e.appendChild(this.getRadioElement(this.choices[a]));return this.isRequired&&(this.isRequiredElement=document.createElement("span"),this.isRequiredElement.className="ac-requiredPlaceHolder",this.isRequiredElement.innerText="*Required",this.isRequiredElement.style.marginTop="8px",this.isRequiredElement.style.marginBottom="8px",e.appendChild(this.isRequiredElement)),e}get value(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return null;var t="";for(e=0;e<this._toggleInputs.length;e++)this._toggleInputs[e].checked&&(""!=t&&(t+=this.hostConfig.choiceSetInputValueSeparator),t+=this._toggleInputs[e].value);return""==t?null:t}if(this.isCompact)return this._selectElement?this._selectElement.value:null;if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var e=0;e<this._toggleInputs.length;e++)if(this._toggleInputs[e].checked)return this._toggleInputs[e].value;return null}getCheckboxElement(t,e,n){var i=this,r=document.createElement("input");r.type="checkbox",r.style.margin="0",r.style.display="inline-block",r.style.verticalAlign="middle",r.value=t.value,r.style.flex="0 0 auto",r.style.marginRight=this.clientManagerInstance.checkboxRightMargin+"px",r.setAttribute("aria-label",t.title),r.style.marginTop="8px",r.style.marginBottom="8px",r.onchange=r.onclick,r.onclick=function(t){t.stopPropagation(),i.valueChanged()},e&&e.indexOf(t.value)>=0&&(r.checked=!0),this._toggleInputs.push(r);var s=new AdaptiveCards.TextBlock;s.hostConfig=this.hostConfig,s.text=t.title,s.useMarkdown=AdaptiveCards.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox,s.wrap=!0;var a=s.render();a.style.display="inline-block",a.style.flex="1 1 auto",a.style.verticalAlign="middle",a.style.marginRight="16px",a.style.marginLeft="10px",a.style.paddingLeft="2px";var o=document.createElement("div");if(o.style.display="flex",this.clientManagerInstance.checkboxPaddding&&(o.style.paddingBottom=this.clientManagerInstance.checkboxPaddding+"px",o.style.paddingTop=this.clientManagerInstance.checkboxPaddding+"px"),this.clientManagerInstance&&this.clientManagerInstance.supportReverseRowForChoiceSet&&(o.style.flexDirection="row-reverse"),o.style.alignItems="center",n){var l=document.createElement("span");l.classList.add("required-asteriks"),l.innerHTML="*",o.appendChild(l)}return o.appendChild(r),o.appendChild(a),o.setAttribute("label",t.title),o.setAttribute("aria-label",t.title),o.setAttribute("role","checkbox"),r.checked?o.setAttribute("aria-checked","true"):o.setAttribute("aria-checked","false"),o.style.outline="none",o.onclick=function(){r.checked=!r.checked,i.valueChanged(),r.checked?o.setAttribute("aria-checked","true"):o.setAttribute("aria-checked","false")},r.onfocus=function(){a.classList.add("checkBoxFocus")},r.addEventListener("focusout",(function(){a.classList.remove("checkBoxFocus")})),a.onclick=function(t){t.stopPropagation(),r.checked=!r.checked,i.valueChanged(),r.checked?o.setAttribute("aria-checked","true"):o.setAttribute("aria-checked","false"),r.focus()},a.addEventListener("focusout",(function(){this.classList.remove("checkBoxFocus")})),o}getRadioElement(t){var e=this,n=document.createElement("input");n.type="radio",n.style.margin="0",n.style.display="inline-block",n.style.verticalAlign="middle",n.name=this.id,n.value=t.value,n.style.flex="0 0 auto",n.style.marginRight=this.clientManagerInstance.checkboxRightMargin+"px",n.style.marginTop="8px",n.style.marginBottom="8px",n.setAttribute("aria-hidden","true"),n.setAttribute("aria-label",t.title),n.onchange=n.onclick,n.onclick=function(t){t.stopPropagation(),e.valueChanged()},t.value==this.defaultValue&&(n.checked=!0),this._toggleInputs.push(n);var i=new AdaptiveCards.TextBlock;i.hostConfig=this.hostConfig,i.text=t.title,i.wrap=!0,i.useMarkdown=AdaptiveCards.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;var r=i.render();r.style.display="inline-block",r.style.flex="1 1 auto",r.style.verticalAlign="middle",r.style.marginRight="16px",r.style.marginLeft="10px",r.style.paddingLeft="2px",r.setAttribute("aria-hidden","true");var s=document.createElement("div");return s.style.display="flex",s.style.alignItems="center",s.appendChild(n),s.appendChild(r),s.setAttribute("label",t.title),s.setAttribute("aria-label",t.title),s.setAttribute("role","radio"),s.children[0].checked?s.setAttribute("aria-checked","true"):s.setAttribute("aria-checked","false"),s.style.outline="none",s.onclick=function(){this.children[0].checked=!0,e.valueChanged()},n.onfocus=function(){r.classList.add("checkBoxFocus")},n.addEventListener("focusout",(function(){r.classList.remove("checkBoxFocus")})),r.onclick=function(t){t.stopPropagation(),s.children[0].checked=!s.children[0].checked,e.valueChanged(),s.children[0].checked?s.setAttribute("aria-checked","true"):s.setAttribute("aria-checked","false"),n.focus()},r.addEventListener("focusout",(function(){this.classList.remove("checkBoxFocus")})),s}}e.ChoiceSetInput=i},function(t,e,n){var i=n(93);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(106)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(94)(!1);var i=n(95),r=i(n(96)),s=i(n(97)),a=i(n(98)),o=i(n(99)),l=i(n(100)),c=i(n(101)),u=i(n(102)),p=i(n(103)),h=i(n(104)),d=i(n(105));e.push([t.i,'.ac-image.ac-selectable {\n    cursor: pointer;\n  }\n\n  #actionable-message {\n    border-radius: 4px;\n    border: 1px solid #e1e1e1;\n    background-color: #ffffff;\n    overflow: hidden;\n    margin: 12px 12px 20px 8px;\n  }\n\n  a.ac-anchor {\n    text-decoration: underline;\n  }\n  \n  a.ac-anchor:link {\n    color: #0078d7;\n  }\n  \n  a.ac-anchor:visited {\n    color: #0078d7;\n  }\n  \n  a.ac-anchor:link:active {\n    color: #0078d7;\n  }\n  \n  a.ac-anchor:visited:active {\n    color: #0078d7;\n  }\n\n  a.ac-anchor:focus {\n    outline: 1px dashed #0078d7;\n  }\n\n  .ac-container{\n      outline: none;\n  }\n  .ac-container.ac-selectable, .ac-columnSet.ac-selectable {\n    padding: 0px;\n    outline: none;\n    border: none;\n  }\n  \n  .ac-container.ac-selectable:hover, .ac-columnSet.ac-selectable:hover,\n  .ac-container.ac-selectable:focus, .ac-columnSet.ac-selectable:focus {\n    background-color: rgba(0, 0, 0, 0.1);\n      outline: none;\n      border: none;\n  }\n  \n  .ac-container.ac-selectable:active, .ac-columnSet.ac-selectable:active {\n    background-color: rgba(0, 0, 0, 0.15);\n      outline: none;\n      border: none;\n  }\n  \n  .ac-pushButton { /*default active*/\n    vertical-align: middle;\n    cursor: default;\n    overflow: hidden;\n    font-family: "Segoe UI";\n    font-size: 14px;\n    line-height: 20px;\n    letter-spacing: -0.15px;\n    font-weight: 500;\n    padding: 6px 8px 6px 8px;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    background-color: #ffffff;\n    color: #3b3a39;\n    border-radius: 4px;\n    outline: none;\n    border: 1px solid #0078D4;\n    margin: 2px; /* needed for box-shadow */\n  }\n\n  .ac-pushButton.primary:enabled { /*primary active*/\n    background-color: #0078d7;\n    color: #ffffff;\n    border: none;\n  }\n\n  .ac-pushButton.primary:hover:enabled { /*primary hover*/\n    background-color: #106ebe;\n    color: #ffffff;\n    border: none;\n  }\n\n  .ac-pushButton.primary:active:enabled { /*primary press*/\n    background-color: #005a9e;;\n    color: #ffffff;\n    border: none;\n  }\n\n  .ac-pushButton.primary:focus:enabled { /*primary focus*/\n    background-color: #005a9e;\n    color: #ffffff;\n    border: none;\n    box-shadow: 0 0 0 2px #E3EFF9;\n  }\n  \n  .ac-pushButton.primary:disabled { /*primary disabled*/\n    background-color: #d2d0ce;\n    color: #ffffff;\n    border: none;\n  }\n  \n  .ac-pushButton:hover:enabled { /*default hover*/\n    background-color: #eef6fc;\n    color: #3b3a39;\n    border: 1px solid #0078d4;\n  }\n\n  .ac-pushButton:active:enabled { /*default press*/\n    background-color: #deecf9;\n    color: #3b3a39;\n    border: 1px solid #0078d4;\n  }\n\n  .ac-pushButton:focus:enabled { /*default focus*/\n    border: 1px solid #0078d4;\n    background-color: #c7e0f4;\n    box-shadow: 0 0 0 2px #E3EFF9;\n    color: #3b3a39;\n  }\n  \n  .ac-pushButton:disabled { /*default focus*/\n    background-color: #ffffff;\n    color: #979593;\n    border: 1px solid #edebe9;\n  }\n  \n  .ac-input { /*rest single line*/\n    font-family: "Segoe UI";\n    font-size: 14px;\n    line-height: 20px;\n    color: #212121;\n    background-color: inherit;\n    border: 1px solid #c8c6c4;\n    border-radius: 4px;\n    padding: 4px 0px 4px 8px;\n  }\n\n  .ac-toggleinput { \n    font-family: "Segoe UI";\n    font-size: 14px;\n    line-height: 20px;\n    color: #212121;\n    background-color: inherit;\n    padding: 4px 0px 4px 8px;\n  }\n\n  .ac-dateInput {\n    padding-bottom: 4px;\n    padding-top: 4px;\n    padding-right: 4px;\n    font-family: "Segoe UI";\n    font-size: 14px;\n    line-height: 20px;\n    letter-spacing: -0.15px;\n}\n  \n  .ac-input.ac-textInput, .ac-input.ac-numberInput {\n    resize: none;\n    background-color: #ffffff;\n  }\n\n  .ac-numberInputError\n  {\n    border: 1px solid #c8191f;\n    box-shadow: 0 0 0 2px #fbd6d7;\n  }\n\n  .ac-input.ac-textInput:focus, .ac-input.ac-textInput.ac-multiline:focus, .ac-input.ac-numberInput:focus,\n  .ac-input.ac-textInput:hover, .ac-input.ac-textInput.ac-multiline:hover, .ac-input.ac-numberInput:hover{\n    border: 1px solid #0078d4;\n  }\n\n  .checkBoxFocus\n  {  border: 1px solid #0767B7;\n    box-shadow: 0 0 0 2px #E3EFF9;\n  }\n  \n  .ac-multiline\n  {\n    min-height: 72px;\n  }\n\n  .ac-input.ac-textInput:focus::placeholder,\n  .ac-input.ac-textInput.ac-multiline:focus::placeholder,\n  .ac-input.ac-numberInput:focus::placeholder {\n    color: #797775;\n  }\n\n  .ac-input.ac-textInput::placeholder, \n  .ac-input.ac-textInput.ac-multiline::placeholder, \n  .ac-input.ac-numberInput::placeholder {\n    color: #797775;\n  }\n\n  .ac-input, .ac-multichoiceInput {\n      -webkit-appearance: none;\n      outline: none;\n  }\n\n  .ac-multichoiceInput:focus, .ac-multichoiceInput:hover {\n    border: 1px solid #0078d4;\n  }\n\n  .ac-multiInput, .ac-singleInput\n  {\n    border:none;\n  }\n\n  .ac-openUrlIconNonPrimary {\n    background-position: right center;\n    background-repeat:no-repeat;\n    background-size: 14px 14px;\n    width: 22px;\n    height: 22px;\n    margin-left: 10px;\n    flex-shrink: 0;\n    background-image: url('+r+");\n  }\n  \n  .ac-openUrlIconPrimary {\n    background-position: right center;\n    background-repeat:no-repeat;\n    background-size: 14px 14px;\n    width: 22px;\n    height: 22px;\n    margin-left: 10px;\n    flex-shrink: 0;\n    background-image: url("+s+");\n  }\n\n  .ac-openUrlIconDisabled\n  {\n    background-position: right center;\n    background-repeat:no-repeat;\n    background-size: 14px 14px;\n    width: 22px;\n    height: 22px;\n    margin-left: 10px;\n    flex-shrink: 0;\n    background-image: url("+a+");\n  }\n\n  .iconDummyOpenUrl {\n    width: 0px;\n    height: 0px;\n    flex-shrink: 0;\n  }\n\n  .ac-input.ac-dropdown {\n    padding-bottom: 4px;\n    padding-top: 4px;\n    padding-left: 8px;\n    padding-right: 8px;\n    background-color: #ffffff;\n  }\n\n  .ac-input.ac-dropdown:focus, .ac-input.ac-dropdown:hover {\n    border: 1px solid #0767b3;\n    box-shadow: 0 0 0 2px #E3EFF9;\n  }\n\n\n  input[type=radio] {\n    -webkit-appearance: none;\n    height: 16px;\n    width: 16px;\n    background-size: 16px;\n    background-image: url("+o+');\n    outline: none;\n  }\n\n  input[type="radio"]:checked {    \n    background-image: url('+l+');\n  }\n\n  input[type="checkbox"] {\n    -webkit-appearance: none;\n    height: 16px;\n    width: 16px;\n    background-size: 16px;\n    background-image: url('+c+');\n    outline: none;\n    background-color: #ffffff;\n  }\n\n  input[type="checkbox"]:checked {\n    background-image: url('+u+");\n  }\n\n  .ac-spinner {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    border: 2px solid;\n    border-radius: 50%;\n    border-top-color: transparent;\n    animation: spin 1s linear infinite;\n    -webkit-animation: spin 1s linear infinite;\n    }\n\n    .ac-pushButton .ac-spinner {\n      color: #0078D7;\n    }\n\n    .ac-pushButton.primary:enabled .ac-spinner {\n      color: #ffffff;\n    }\n    \n    @keyframes spin {\n    to { -webkit-transform: rotate(360deg); transform: rotate(360deg);}\n    }\n    @-webkit-keyframes spin {\n    to { -webkit-transform: rotate(360deg); transform: rotate(360deg);}\n    }\n\n #showHideOriginalMessage {\n     font-family: \"Segoe UI\";\n     font-size: 12px;\n     color: #0078d7;\n     text-align: end;\n     padding: 16px;\n }\n\n #originalBodyContainer {\n     margin: -16px;\n     margin-top: 0px;\n     background-color: white;\n }\n\n.ac-overlay-spinner {\n  display: inline-block;\n  border-top-color: transparent !important;\n  -webkit-animation: spin 1s linear infinite;\n  animation: spin 1s linear infinite;\n  border: 2px solid #0078d7;\n  border-radius: 50%;\n  width: 18px;\n  height: 18px;\n  left: 50%;\n  position: relative;\n  margin-top: 8px;\n  margin-bottom: 16px;\n}\n\n.input-placeholder, ::placeholder {\n  color: #777777;;\n}\n\n.inlineExpandedShowCard {\n  padding: 8px 16px 16px 16px;\n  box-shadow: 0 1px 10px  0 rgba(0,0,0,0.2);\n  border-radius: 4px;\n}\n\n.showCardHeaderDiv {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  margin-bottom: 8px;\n  vertical-align: middle;\n  line-height: 20px;\n}\n\n.showCardHeaderTitle {\n  box-sizing: border-box;\n  min-width: 0px;\n  font-size: 14px;\n  line-height: 20px;\n  letter-spacing: -0.15px;\n  font-family: 'Segoe UI';\n  color: #212121;\n  text-transform: capitalize;\n}\n\n.showCardCloseButton {\n  margin-left: auto;\n  margin-top: 3px;\n  font-family: 'Segoe UI';\n  font-size: 12px;\n  max-height: 100%;\n  min-width: 0px;\n  width: 14px;\n  height: 14px;\n  background-repeat: no-repeat;\n  background-position: left center;\n  background-size: contain;\n  background-image: url("+p+");\n}\n\ninput[type='number']::-webkit-outer-spin-button,\ninput[type='number']::-webkit-inner-spin-button {    \n    -webkit-appearance: none;\n    margin: 0;\n}\n\n.noBorder {\n  border: none;\n  outline: none;\n}\n\n.amsnackbarwrapper {\n  text-align: center;\n}\n\n.amsnackbar\n{\n  display: inline-block;\n  visibility: hidden;\n  max-width: 500px;\n  font-family: \"Segoe UI\";\n  font-size: 14px;\n  line-height: 20px;\n  background-color: #605D5A;\n  color: #ffffff;\n  border-radius: 5px;\n  text-align: center;\n  padding: 10px;\n  position: fixed;\n  z-index: 1;\n  top: 20px; \n  left: 50%;\n  transform: translate(-50%);\n  transform-origin: left center;\n  box-shadow: 0 2px 8px  0 rgba(0,0,0,0.3);\n}\n\n.ac-input.ac-numberInput.error, .ac-input.ac-numberInput.error:focus {\n  border: 1px solid rgb(200, 25, 31);\n  box-shadow: 0 0 0 2px rgb(251, 214, 215);\n}\n\n.numberErrorElement {\n  padding: 4px 0px 4px 8px;\n  color: rgb(200, 25, 31);\n  font-size: 12px;\n}\n\n.required-asteriks{\n  color: rgb(228, 37, 43);\n  padding-right: 4px;\n}\n\n.required-text{\n  color: rgb(142, 142, 147);\n}\n\n.error-icon {\n  width: 16px;\n  height: 16px;\n  padding: 8px;\n  background-position: right center;\n  background-repeat:no-repeat;\n  background-size: 16px 16px;\n  background-image: url("+h+");\n}\n\n.success-icon {\n  width: 16px;\n  height: 16px;\n  padding: 8px;\n  background-position: right center;\n  background-repeat:no-repeat;\n  background-size: 16px 16px;\n  background-image: url("+d+');\n}\n\n.show{\n  visibility: visible;\n  -webkit-animation: fadein 0.5s;\n  animation: fadein 0.5s;\n}\n\n.fadeout-hide{\n  -webkit-animation: fadeout 0.5s;\n  animation: fadeout 0.5s;\n}\n\n.ac-requiredPlaceHolder {\n  font-size: 12px;\n  line-height: 20px;\n  font-family: "Segoe UI";\n  color: #212121;\n  background-color: inherit;\n}\n\n.am-wrapper {\n  margin: auto;\n  max-width: 640px;\n}\n\n.messageCardCompact-ac-image.ac-selectable {\n  cursor: pointer;\n}\n\na.messageCardCompact-ac-anchor {\n  text-decoration: none;\n}\n\na.messageCardCompact-ac-anchor:link {\n  color: #005A9E;\n}\n\na.messageCardCompact-ac-anchor:visited {\n  color: #005A9E;\n}\n\na.messageCardCompact-ac-anchor:link:active {\n  color: #004D84;\n}\n\na.messageCardCompact-ac-anchor:visited:active {\n  color: #004D84;\n}\n\n.messageCardCompact-ac-container.ac-selectable, .messageCardCompact-ac-columnSet.ac-selectable {\n  padding: 0px;\n}\n\n.messageCardCompact-ac-container.ac-selectable:hover, .messageCardCompact-ac-columnSet.ac-selectable:hover {\n  background-color: rgba(0, 0, 0, 0.1) !important;\n}\n\n.messageCardCompact-ac-container.ac-selectable:active, .messageCardCompact-ac-columnSet.ac-selectable:active {\n  background-color: rgba(0, 0, 0, 0.15) !important;\n}\n\n.messageCardCompact-ac-pushButton {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  text-align: center;\n  vertical-align: middle;\n  cursor: default;\n  font-family: "Segoe UI", sans-serif;\n  font-size: 12px;\n  font-weight: 600;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  color: #0078D7;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  margin: 0;\n}\n\n.messageCardCompact-ac-pushButton:hover {\n  cursor: pointer;\n}\n\n.messageCardCompact-ac-pushButton:active {\n  cursor: pointer;\n}\n\n.messageCardCompact-ac-pushButton.subdued {\n  color: #666666;\n}\n\n.messageCardCompact-ac-pushButton.subdued:hover {\n  color: #0078D7;\n}\n\n.messageCardCompact-ac-input {\n  font-family: "Segoe UI", sans-serif;\n  font-size: 12px;\n  color: black;\n}\n\n.messageCardCompact-ac-input.ac-textInput {\n  resize: none;\n}\n\n.messageCardCompact-ac-input.ac-textInput.ac-multiline {\n  height: 72px;\n}\n\n.messageCardCompact-ac-input.ac-textInput, .messageCardCompact-ac-input.ac-numberInput,\n.messageCardCompact-ac-input.ac-dateInput, .messageCardCompact-ac-input.ac-timeInput {\n  height: 31px;\n}\n\n.messageCardCompact-ac-input.ac-textInput, .messageCardCompact-ac-input.ac-numberInput, \n.messageCardCompact-ac-input.ac-dateInput, .messageCardCompact-ac-input.ac-timeInput, \n.messageCardCompact-ac-input.ac-multichoiceInput {\n  border: 1px solid #DDDDDD;\n  padding: 4px 8px 4px 8px;\n}',""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(a=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),s=i.sources.map((function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"}));return[n].concat(s).concat([r]).join("\n")}var a;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var s=this[r][0];null!=s&&(i[s]=!0)}for(r=0;r<t.length;r++){var a=t[r];null!=a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){"use strict";t.exports=function(t,e){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAAAXNSR0IArs4c6QAAA9tJREFUaAXtmj9oFEEUxu9iiIoKRiSgIilMISnELjbi5WLAIkELrSQ2mjT+SWOhIFyihY2dRK0UKwVFCwWFaBSFNNqoqFUQhVyhoEGjaDSev3dcjneT2012l525w33wcW/ezLz5vnl7u3t7m0rViRUKhYNgCgSydJ3oS6HqM1ybg/JtCDrB4fg3YdaeV0F2aiWJukAbWBUmaYA5k4y9mk6nZxaaA681jDkAVlcZK32HgXfBSJAGR8F3YNNGqhBedAiiLeCFF+FGyUSnVO0OyADb1h52QXivZ+5DsNk3BwMveu1AzPFJ8nf6kvPoZF4rmADa8jSu64BUL6sD+F/AAFjnkdt5GG5t4APQJm2J53RQBN5UgT/4Hc4V+BCAXzuQSmmTSrbKND5zukMCevBdn9zOu+C6FXzSAvDfAvkuFg0/B8omp9WWUp98vFR+TbkwliNrDKxVxITvDi4zeRWrcEXgEhVZ8HqkxlpzEbedxUaBvpN5TrsTcR/9iHhfGP1mWexDXDfL3Qf6pmOcdhfi5PbNtCkV+CrfQW1DqtO5C7Ee8FMTxB8DK7zI0dcMngK5GhyqWYGQ2wtmgLZ7NJZ5iasa17Pxh6oOshyERx+QS5a22zSaAlPRGfCdC4RDP5g1eF2jXbytrGuBiBg0hEnzMgh/MjQSOqsgPE4YXKQ5Aub9pAtURSOpE4FwOG3wkOa5QEK8BhuJrQsUIQYHaZ7x4hs4biS3JpB15Qe2HIKmnQwswm+Ckd2KQNZsAHLyMG3Qj2uoPmOF2AWyXiOQ0762vzQGQglgEnM7wSMgR0TltZKAtlgFslATkAu2Nrmg94UVJ/OYL08G5qxf5wp38dQZFumz+nKG3gK71JTf+Pu5ab6hYmHc8u9BJm/QCawIRJzcHMuP6Yxa/Bf+PsTJw67YzIpA2J8FGaXiB/4exI2qWCyuLYEbFftv+D2Ie6Jisbm2BJ5CgTylk9uuI4h7FpsiI7EVgQh6zbrbjLWtNMPfpVuhF32RRGD0PXSbIamg2/2PvnpSweh76DZDUkG3+x999aSC0ffQbYakgm73P/rqSQWj76HbDEkF3e5/9NX/iwpOq32q2bebFMcKl0eSJmd5qFU2qeBEuZVKdTNhqWrXg9trkNR6io+9hxGl7QqNuhAJzw4gb1PM2TSOvDlZNvkLS94/eQWK73qVet7xKQ9l86V2rX1IAbYA+RtAv8h0jCd45zXZ4t/DiMwSfACi/V2sM9v3H7NkFoEFvXTxLEpQ3gHbCd7rzjryL8G11xQn/CsqVjpcjxPfDTaBiuOZdq3YLETkHbVxcKFUoKrc/gG0MdOGYtdPIgAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAAAXNSR0IArs4c6QAABPBJREFUaAXtml1oHFUUx//nZs00psVapWilxI82u/ogvilCMKZW+9BqBYtKqVBEEBv8wIqZbZWhNpuUWsEPSqlC1YrYN0sUAq1VqxREH6RimdnWaimmkoe4tla7yWauZ3bdOzObpHG3zN1Z3IFlzz179tzzu+fOmZk7l9Aoh2k/DokdgLyimpAT1RjX1VbK7dx/VXBevKKuQVfTOdGxaszLtlMzaI3OxcTYMki5hI3mlQ0j+ZbiVxid78Gi8Vn9G+33I3/+MZCcP8VWigU8dTdwzFMSRspYSsImu5fn+SB/Llf6qAVBO5FJbai5G+vEQuQLBxju1ul8lDLoZc10htigezqjSHUubqnZv2UvYrjPGC41k49SSsfH+ASW3TMZRaenEa4CW2ryv+lkBy7gqxAc4QyI9gX9JbDZ7kFBPqmURDn+04sQbUPIXH9G6eMk9J1YAnf8ECdlsQqL6DRkogeYXMt6pU6ggKdUCzTJhXUFBju/8XUxk8zjPKUnDjLDtX5kdBKitQf9N55Cn+OrWRJcle70NXIYAzGGS2dvg5z8MgRHZGMOuopwPoiSBCQtDLSOKjlugpm9He6kNy2vVqERHYWRuAtWakTpKgSuorIloJv9ehQw1iaaThek+yn351+Xib6D0X4frMVjF4ujVEUvZlHv39LZ5YA7zInw4UBHYLQsmxZOyJwKmehsvAHN7Eq47lDoxoPoc1w1/15YS88qkKDgtr0P0Nd8ucjx5/mpt2pB43rKpv0QF5QPOYTLVBhEwzCMB/HCNReUrlIY7PidVV1ldTwBTWcdX4v3cJB+fSD6GEby4f9031qm4+/4TVHTeYLPt3dDxY/wEcOtqRbO44wXYNp+hqvlbs6eHxfRHhiptQxX8AKu9ojPFDWdPi4oAyEA70mjP9nLxcK/9woZzN7wR2p22+gs0vYWzlwYDmJH8THqEuC8gOsP2Oe8Cle+FBo9oq0YTG4M6Wps1G+KFh+wnbd4WgZu9j0KkcZAsiKbNdLx3+oDaHERSTvvcDFZHwpd0LPIJF8P6S6xoR/Qkgnk7b18d/KIH7tXRPiZNJPa7euqkNL23XDxMp9wx9CafC54OdELaMlW5J19DLfaD5+fQYnWYyC119dVKbn4gAdoEUN2I5/9nv/9dtmDviLz2uk2htvP0zIAhwkO5FE+52qHK5IwXPkg97qy6H3ryeD239oxmvuER7nb75zyaJFr0J/yFrsiO/QAjv3BVTEAR/gLJFajv/NAZGT/OtYDGFwcAp2DECsZ7nDUcJ5/PYCJls0oFHiRiIiXSHoZ7lsdcPoAX1n6I3d2hy6oYD/6qmiwV41yE1DjYEfSVTODkQyrRqfNDGoc7Ei6amYwkmHV6LSZQY2DHUlXzQxGMqwanTYzqHGwI+mqmcFIhlWj0/9BBgl/qgF1g5trlDbeQvqXwIagYqjnggF7+2R+Ugqi5XjjuKHajSC4f68KhSmFz8M/eDud9isDKW/AiLurYSC9zUFE21T8wHkYVx4MtEHYZs9DTv7A7ws61A9EP/MSOy/Kihl3ECnbegjCNfg9BO8PpRW8oOxvVBB4Gpmb3wyGVNoQW9xxCCbnTbENe9AX/I6jp/J1d6mKbk0d4iXgezifpxqST9AuzFmwqhLOYwlnrDRdN3IiH+Bz8yaetnPjCey9cpOjHOcRTsxOeAma4fgHjhdcXV83v2sAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAAAXNSR0IArs4c6QAABTRJREFUaAXtWm1oHEUYft/dS+I1iV+U2p5KEftDGmj9Z0hNyO3eXSq0fqCiULRIFUotfmBBEfVHEapoQVFCEaF+IUpBKkFt7nbvJKYHon9aiQhBQ/1IJIiWtpekyd28vnO4H3e5tLnL5nZPbjmY2Wdm555nnpmd2ZlBaJDLMIb3AOFhILqqGspKNZn9zIsCXqtWnOTbMAIB8MdaKjhU/lAmk+mgfF4XRJsQqbM83dt75Y/1kcj7XV1d85crN9zRcedsLvcwgLi6Qt5rieBxxhcZhlZmIsK0YewnEq8wtsbCVz1EZTAWj0tyNV0nTw6vm5uBFAvcUqmAooPSNdNIDXEb76+UaXUx2lxr+aPJZGQuRyYB3LJUGUVLRX5BduD+pTKtGo44CagcrKV80zQ3ziF8UyZuChA+dZcXMs1hjQq01wIR8Sz3vWdDreGhvr6+KQsPUsgtblNhYT7NnG508fpNbWnVRD6/i0DYcIgE7LPvAAqo0nZNG/jWhQUqahjGZhZnMKkNNjHEX1BRtWg0esZMpWxYRkJA0GMjiCc0LRFYcZlM8laRFylulmstzvyW/KmNQL9d1yctzB3Kl8w6GyA4bccDFkmnh28TC/QVi7vGooYIp69YA/Ft2xLTFlYeSoGqBXLfu+x4ZOWtZ8jNspcKhS9YnDMuI34fbu8Y6Onp+ftSXBYN9JfK7Ecai4uDKBxncfbYzM0y29555R3d3d3nyjnxeH7WhZ1bNPK7En2PZgxjB4sbYiKOOITM2usgUUmcJNwWDn8AiKPF0QDwmcA6yF8P9wkSHzPnFkm8eCGcUEKt92zdGp2zoPKwt7f3H8Z6LTyQAs1k8iESdJSAXO8HOL4+csMDy5m3WuJkGLgmyuPYYyzsPebmiAP8hJ27v1pxUmCgHDSSySd5sv+GJGZd3JeOarH4oxw60xMrcRlhYBxk554DoBJxPE8dZHF7ahUn9QdCIDt3kJ075DYEFTwsP6NYHI8QtV++CzSN5Ovs3ItuCYjKy3osccCN1Rr3rQ/KD2zTMN4mIdyTfVAUeJ6bZYmbtYqTz/kikMUpaSP1Ln+DPlJKHp/SYok3S7GV3dVdIH/LhdKp1Ic8FDxoUZf9jH97Wdw7FlZNyNO5KJB4SS5MbYhEnnYPJ3Xtg2NjY60iP3/MLY6FFPiTbbcWG6hJXLEiSHxUXJEgse/Pycnd7sqpm4PZbDY8Nfn7Zyxmu0WAnVvg+116InHMwmoKiSLOc+J6J16nYeLUqeH2mdyFL93imMRFUOjeFYtzq6kQr4uDf03DobJFrRlQ1Lt1PVa6vlCB4EqhughkkvbiEH+Fn+fpxQ4WN7JS8st5vi4CUW15AfJ5XiQiVFHd36/HvlsOOS/y1EWgpmljTLbbC8LVllHXYaJacl7kbwr0ohb9LKPpoJ+178V/Nx30ohb9LKPpoJ+178V/Nx30ohb9LKPpoJ+178V/Nx30ohb9LKPpoJ+178V///8d5LXJC1ZN8TaOc7jGAgMejoyMlHDmLY/zbsoKL+f9bAOE8fHx8Tb7vgEi+fnZnSU0FcXRwwkK78N97mSgm36dmDjSKCLl4SB27FWHP+ZUVZXHvOwLR0dHOy/OzvzAOz4bbRRwApBSCErF41FOPn9izLWNTxVu4dYntwGcvXxUntDj8bfcrIoHYuWJQxBoyD07d2JDxRG/1mNxrXxHuPgW1fWBNO8TxDjxTEOJ+o8s8z6ihlp2louTySWOyeY6PzdzgM+o3MWnhW5mRzsCKrjAvKaZfRYVGCwatATRfwHV6LKD2QTj4wAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAABFhJREFUWAnNmUtIVFEYx//njm/H1AolS4y0gmoTUUQtImhvSRFE1C7CatMTIcoiiOixKhftijZRGK7aFBE9iELaRFBpFJWWmFaOj9GZOX3/c8eZO+PNx+SdmQ90nHvnnO8359xzzvf/q5BqnPxQi3CkHtBroFEFpaukK/4wuqBVF5S8QrXDZ7Xh3NJO+9bMfqsZfby5owKjoYPQeptArXK2LchRWFCSYy51D4QwEtLO28KJN1DqHvJyrqK5rifx5r/fTQ+wucePkf4jUJGjAub3SauNNYWoX1GCLXVFWFSai7lFvoQsfUNhfP09hgcdQ2h7O4Bnn4cRJrNCANq6hILyy2iuCCQ0cnkzNWDT+wYg3CJglXPyLZzYNBf71pVhfrE9Wi59ul7qHQzh+stfuPC4D3+CEYL+AHyNOL+s1bVB9OK/AbVWaHp/Sp6x03k+rRrXl+Pk5vmYV5w4UpN17nbv52AY5x71ouVFP0bDSsZUnRHIszL9Sc+E3dod8MqXQvQM3hC4HZV+H1p3L8SGmiK3fClfe/55CA23vuFHICx9qDuoKN6Lw9XDyR1ayRdkAahxuNUL8vHqwOJZh2NOfmH2zRwcCJOTuZNi4nwFd52WBgfY8Mn+mhk/a0n9T/q2tMCH3atLcf9dAN8DoZV42Kfx9OpjZ6NEYi4IHblb6bcUv111Wa7zs579/eXXGNZe+yTTHdFQ1nbnwolPMbcSWa1cEHzm0gXHb81czMncZscwLPZ4xAG5z8lWwtU62wtiOkPPnMxNBrPnRhvZU8wTIjjWOSfP8n88VvvfW8l0gNw+wy1oycVO/BmNBJCfW8sTxx7BYOgQTwhuwv+7z7klnu415iYDWcyRKg2jU6y38vjiCZHpIANZzHlvAFmVyMHPs3Wmx5cXX4YMZCEThM2ySyaYg9+LhKn0ySLEhJRzMsVSz0mwKsmWiLPoNZYMpSky07nvTTUQMRZhs1gJs9gsL5x46k3VkVf3yUImsnEVV41Xwl4lTKXfKJMAavc6LJVOZ72NsHGKu6khsi0Mk7BxBLsocPqHWThmR1DPGNElbDKClIYAS55sCYotE8Imi0R0qwTVV7ZEnEW1W0ZUCxmlYbZEjEUEv2UUv4hq6lZKw0wHGchihL64EXY1I4qfopq6NdNBBlvgiwshYQPSjhDFT1HNojFTwdxkIIuxSGKA9ErEjqDip6jOVDC3cR1ojUT9G3sESUSvROwIKn6K6nQHczI3GQxLFCAOaIwcXyPtCCr+dO6LzMWcthUifo3DVIoDktgYOeoM7Yj6m18xOComj8fBHMwVtUDo0ySYSbaqc0IY0+jdbSlkd9BdaNuzyDONzJEj3OvuoBCIP3N++c5kEylxBAlKl4lGjjRgQyp+L55J9sm+Y3DM6eJwTRzB8dHMavttHJKvDgOzVAzM41ljYDohp7CAqSGSJQPLNz5j3lvACaC0SMSFgN5qdKvjXmZNdAdI7M80/RviL5eWC7SyM/fYAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA8JJREFUWAnFV0FoE0EUfbtNm0LRm1Jz8GI9mIAHQSiCBQWlVRQEPQmevCjSQw9iWpTQUgUPPRSkF689KQgVqSgoKGhB8KIbBOulh7bozSI0tc363uwm2djZTVpS+iHJZv78//78mfn/rYNmpeB1YM09BWxcRBlZOE6GpvpIFuH7i3BRBNpm0FF+i0JuLVAlfzvJamoLXjdKuMenqwTZS+AyfPyAQ1A4/Ej8DMcyHDvEOS7n/ObgNNIYZSDLZkrMV3wAk9/TWP47gnJ5iLZddPqSgE+R7niOQs9Pq7/C/H6U1i4woMsMpJ9z/sB1J9DdPo7BwyWbjT0ArXoVz+iol8Dv4Tq3MZ6dszmIHRsp9qLsP2QgJxn4HDpxyZaNzQEMfzuK8voLGh1gSofwIDcZC9KMIu8NcnsmuJgltLedw9iRL1Gz+gDMyv1PBN/DVV/B/ezr6ORtPw8XzzAbTxjECjqd49FMuFWn2nOTdq68leAC0ELkU1kVhrBCqQWgA2f2nGlv1corKPqVT22pMAxWoAy2IEj9PA/cZ+55X9Ru0/NdL4d1/zpXc5a6g6F+gY5fIeU8xljO22QTHch773gwj3ErerQVKaML7nmXOe3RydFnFaKSM0HwGzxUzJwf1Wb5J4t1DCJfnELaH6JzeyHSjdrwP4a15abDQkPH+EUHH7j6gajX6rPmrGKWoKerY4kPzhteu4HYIPIefeEEC9U+15RXVTgVmTjRypsGlxMGamziHBJLmCztTCVru8qrKpxNtOdg2rcstDG2FkNhCZPYrmksqu1x5VUHTvV9qyIbc1gthsISJptaipGoo4VNxTLZnPa6A2ebFDNmbopdFzSzjFbGACpdzTq3ctWsygaDCbYG0wTQwMcOqn2YvWX62c/jZSFe1VCTYEtMB0suDxjZTJXZWDyywm1bEmyFSWzX0CgxGZEJm6i8mitjUyaMyUa2NhGWMEnheAjJ4XRlDJOxzDa13ZmyaBoM0SauLwjLXO22GdcQSMPhSKPiRLUdLK9NC+camzgDYgmT5NUN6/U0I+qHaJRN1FhU2x33UeJ2KO2ak9QHhBHwxWlhB91Q7HUV1wyHA/psMYSB3mJ5nWLXi2nHYDvOJrdj8USRVWHWyXBxFHe++hCH2ymRb2EIKxQewlBEncVeRSDF4Vot8mnIKTEMVgBQC0C8XdRZ7FUEspVB1EjpksGIvCPUAlBAeotxU+cZxAqDmG3Jdijt8iWfouX/vSnV0/JK2nf1xaQSxK6+mlWC0K+ysSsvp9EggkB25PX8HxMGtXJNekL7AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAOVJREFUWAntmLENwlAMRO9HCLECC5Bh2IE1iChQRAF7MAOwCgoLsEKElHxim0h0pjIpzgUFLu7pfTc5YGKTlKfOc7TNASlvkLEMZUx4IqczFuUedXrNNFxgkLcDTPyogCG7bSS7MiAzA6RijVN5C6XaPdbou4u+zgBUaPj4TNEwEn5cXb8ZDEj/mcYPgbx3oCEa8gx4e94QDXkGvD1viIY8A96eN0RDngFvzxuiIc+At+cN0ZBnwNvbDUklIiMf/tEzZn4YrP2QfkbqGGkhqnssUt9ZnjIABiRlkfQz/y6sYlX8lvYG5l47/xbUu7kAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAehJREFUWAntmM1Kw0AQxydWbKmKHuxHwBZvtX69gL3oG+gD6KXFR7AnKZ58BfEmPoIerQf1EUR6k4KI9qy0osT9Z3chlGySrWnSQwZKQ/ZjfvOfmZAs0YSZYfO0rBnqd07JsA7IIjNSRoPeyDIuKVM5oZbxPW07BwxZxwwmerMFYL77HfhuTtkEUCZuEwwcKOo0uQUvGDiQ24SY7iVAfsInCk2UQrnZFD0clenmcFnJFVnKANOul2l7JUsLGbVb9YgyBv0BCbNRTNPT+4D2rl6Vm4wdaBhm56JLvc/feIB0YUA5NoVGgfEEumadcM86Ahvr2qgwnkCLrBNqrCPuGmXKa0AtZVN0Wy+RLGC/mhkOVpmyfdYJ6Ij1QjowFGDajRJtFjP2Wl0YT4U+WCfsso4A1JqAKsyp0xcGjCcQBt2gii5QYcH4Ag1DVfM8fU4oWTMyTVDV6zmDPb1MWUPORU6lVgWUOZ8iCbNl8poBDOb+x/hXR/M50Os9uq3Nug6F3ukNaPBjUZgwdFY1AikkI0b06BwUeiWXDhdGONECwhrUB6AeX77sXxhpkgHjn3+XOe8EuAZU7bwbYKb+FG2F9F3orUiA/PRKFAqmEI5E4jbBwFOG85m4TTDw5xAOi3A+E/eBVdyiuPn/A/Mu7sgeVfFlAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAW9JREFUSA29lrFuwjAQhu2C0h0G3oFH6MjeobxKpUrNAwQJqa9Ch+4Z2zfoOzDQnQhkfBdMHNk+n1OHDCE4//2fz8ldLMSdDwm897fXLynFTEwe11VV7XPOoSzLhTgfd0qJv8324/mhNZdzPfAkzk2NgkzEFtbU4I0JaV8EymnxIqX8VUotc0E7mFqCN6we5IFLCheuoFgNXV7K6wbMBaVgwOgB/wuNwbzAoVAOLAhMhXJhJJALTYFFgTFoKowFDEFhHGoWaretM14ZOW8pGnlOTjZakwoDWzYQxDYUg7GD8DIDPRzXXtr+uceZnaGdHT4zPbvRltSBTYoVrsYYL40PZpo6dS/0eMgl5RhyNDY8CEwxStF6gSkGZvbcGAfIDTQg+5cT2wNyAmyA7zrmcQPGhD7z0BjlhUBKEDKNjYc8sbWpU/M5pGtQUKxV3SC63eBxB/prL1UHvW/8Flpgipoy494zUP2N+IGNMDcuq+4CbIPjL/ptxfEAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAr5JREFUWAnNmEFO3EAQRe2QXRBilkEhSxacIBKbbFigoEgcg9yBO3CWCKIoRMCGA4QFBxgkZokUNqAsJv+1q6BNxqS7MfKU9Kfa7apff9x2u9t1lWnT6XSklE/CpvBeWDHIVVeGsfyRcFjX9bV8/yYhO8Kx8EdINWLJ2elNkcg2hDPB7U6N78IX4aOwJiwaaNPHOWKIdYNjo1iYkheEfWeTnwi7wlIqKbGWQ64bnAupHCFOCcvCD2O4ld8T3mSRRMHkGgdcGNzLUUh3k0DhQsD4Zx+6o/POwGWccqHG06IUxDD5lfml9ru8kv+PhlM4FzBqdQ+fTvo9w5XpXYzLhVvw+2rf+1teATxNGOPc2zC1ikQH1LBacjOePnX6o70X5SU1lXsIkoKjIOXwsGBnUXdVqYNJD+MyZj9NIVM/LdKEA2oJPnQPk6c6mU2x3QSef0Ka1HxBEFHT8o8DsQ5GAlM8s2rypBerUl6wuC+1rUQmT2qjYfRKidvCa+FEL8LfqUR9xVnNE9OwjSDe2tjXxg3y67U3EbRqEi4GkdIU9dqrCGI9g7GWGcq89gp3+Y2ALZaqadLLnjJqUts4brhCPn/UpYJ6yPPaUwRNjPBtD8SlFF57gqCH8Sulq6pvSs1+dUTl7u9j5p+xnViXP7V2ltNcwqL/OUZtbMwV+hmaVfXZ/BDOax9xhz/r1aH8LeHSsJX7b5TXenWEfHUWv1xNiFywywJB7ZcrBKIqXn4ol6vjliVISbOXHyaqaIEm0uIhU+7sBZoJmq8lrIman0W+CYq3QWxVet95wCmkbYNM1PxsFBGE6R8gyjeMbIuG20o3koIohs/vKTXD7oA5I3ndTaxAju8s1Ayc3btVF9DlRcDT51MChMN8jnksUEKYPF/8g5UvjB7X7zyWKD7psVNhc8B6fNYnPWZsPukd5H7S+wvedC/MfUPfOwAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAudJREFUWAnNmL9qFFEUxrMGhKCRbCdibIT4CkKaFbEQbdKbB1jfIb1lfISkt1IhqCRVKjuLQNoISSkkjcFi/f0m58KdMLM7M7vRPfDt/XfOd76dmXvnzu0ttLTRaNQn5BV4AR6BBwGKhdPACeVX8LnX6/2inL0hZAPsgz+gqelrzMbMFEG2Dg5Bsksqe+AtGIA1cDdg3T7H9NE3mRzrnYURvAi2ExvlGRiCe01J9Y0YY5PJudiUo/AjYAV8CYbflFvgTiuSzNnY4JBLk3slc6mv6giOgOY/e1rv3W5EruCkKHKMF4WTtyldmR/UH7ZLOdlbTiC3Zq7628dgema8MjMXk+TKDdJztZ36SyUOzibN+zyz21RKkjXMEbkoKmYfnWlqb2VxN1olp5NFOywlosNFT/Mydp5NJdIGDXNFTops8aThaqoNG/C0doF3CXwAPsy3cwLarm3aftFPpQ9c4l1VGy96Oem4OpyK+Qa0E3BdkIunudXQX+BnE2h744i7jMGZizml/aSKx9xA21TQblHl/VPl3LUPzkZi5MfXd5+2e4v2aiQ9inLqAuIlSD6C5+AMPGMbckxZZyn3quqOlYatVXnT/1hUjVX14dv4yqR4cwPtWEEXRZUtRHLIS8Z8EF0sX+b9VXV8WouRhzi3L9qFjfOiOhot1yR5F+NjReHTSUwIWo4c5xNvWQS8HydqGjHBX7plB5Fs4GCd4VMpalox5oNjEBoObOxEY+K0x68kinbn25T/cXjStN9RUKuF8Zqo77S12kUvT1xXJz4tjG8U1PrVQUy6UlSnFlN+daga0tYv1xA11ZWJ3EP/FXb1co3Ojau+dtsPYu4b39WIr95+SMjg/GzQQtB8bWFD1Pxs8kPQfH0Ghaj5+VBUkMYDrqj0wehL9f99Sl9JKkTNz2FDEhVXy9mXlgSqxYbcpf7fHsfkokKYi+eNH1j1riee1EaUR3qvgUd67serjvR+0u+R3qe2R3p/AUv8odLzw6w/AAAAAElFTkSuQmCC"},function(t,e,n){var i,r,s={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),o=function(t){return document.querySelector(t)},l=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var n=o.call(this,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,u=0,p=[],h=n(107);function d(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=s[i.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](i.parts[a]);for(;a<i.parts.length;a++)r.parts.push(v(i.parts[a],e))}else{var o=[];for(a=0;a<i.parts.length;a++)o.push(v(i.parts[a],e));s[i.id]={id:i.id,refs:1,parts:o}}}}function g(t,e){for(var n=[],i={},r=0;r<t.length;r++){var s=t[r],a=e.base?s[0]+e.base:s[0],o={css:s[1],media:s[2],sourceMap:s[3]};i[a]?i[a].parts.push(o):n.push(i[a]={id:a,parts:[o]})}return n}function f(t,e){var n=l(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=p[p.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),p.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=l(t.insertInto+" "+t.insertAt.before);n.insertBefore(e,r)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=p.indexOf(t);e>=0&&p.splice(e,1)}function y(t){var e=document.createElement("style");return t.attrs.type="text/css",C(e,t.attrs),f(t,e),e}function C(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function v(t,e){var n,i,r,s;if(e.transform&&t.css){if(!(s=e.transform(t.css)))return function(){};t.css=s}if(e.singleton){var a=u++;n=c||(c=y(e)),i=x.bind(null,n,a,!1),r=x.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",C(e,t.attrs),f(t,e),e}(e),i=S.bind(null,n,e),r=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=y(e),i=I.bind(null,n),r=function(){m(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=g(t,e);return d(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var a=n[r];(o=s[a.id]).refs--,i.push(o)}t&&d(g(t,e),e);for(r=0;r<i.length;r++){var o;if(0===(o=i[r]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete s[o.id]}}}};var A,b=(A=[],function(t,e){return A[t]=e,A.filter(Boolean).join("\n")});function x(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var s=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function I(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function S(t,e,n){var i=n.css,r=n.sourceMap,s=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||s)&&(i=h(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var r,s=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?t:(r=0===s.indexOf("//")?s:0===s.indexOf("/")?n+s:i+s.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(t,e,n){class i{constructor(t,e){if(null==t)throw new Error("null clientManagerInstance");this.clientManagerInstance=t,this.UtilsClass=e,this.constants=this.UtilsClass.Constants,this.themes=this.clientManagerInstance.getThemeConfigs(),this.summary="",this.themeColor="",this.style=this.constants.DefaultStyle}parseMessageCard(t){if(this.adaptiveCard=new AdaptiveCards.AdaptiveCard,this.adaptiveCard.imagesCount=0,this.adaptiveCard.hideOriginalBody=!1,this.adaptiveCard.enableBodyToggling=!1,this.adaptiveCard.isHttpPostActionAvailable=!1,this.summary=t[this.constants.SummaryProperty],this.themeColor=t[this.constants.ThemeColorProperty],null!=t[this.constants.MessageCardContextProperty]&&(this.adaptiveCard.messageCardContext=t[this.constants.MessageCardContextProperty]),null!=t[this.constants.OriginatorProperty]&&(this.adaptiveCard.originator=t[this.constants.OriginatorProperty]),t[this.constants.StyleProperty]&&(this.style=t[this.constants.StyleProperty]),null!=t[this.constants.HideOriginalBodyProperty]&&(this.adaptiveCard.hideOriginalBody=t[this.constants.HideOriginalBodyProperty]),this.theme=this.getThemeByStyle(this.style),this.adaptiveCard.hostConfig=new AdaptiveCards.HostConfig(this.theme.hostConfig),this.theme.cssPrefix&&(this.adaptiveCard.hostConfig.cssClassNamePrefix=this.theme.cssPrefix),this.theme.allowCardTitle&&null!=t[this.constants.TitleProperty]){const e=new AdaptiveCards.TextBlock;e.text=t[this.constants.TitleProperty],e.size=AdaptiveCards.TextSize.Large,e.wrap=!0,this.adaptiveCard.addItem(e)}if(null!=t[this.constants.TextProperty]){const e=new AdaptiveCards.TextBlock;e.text=t[this.constants.TextProperty],e.wrap=!0,this.adaptiveCard.addItem(e)}if(null!=t[this.constants.SectionsProperty]){const e=t[this.constants.SectionsProperty];for(let t=0;t<e.length;t++){const n=this.parseSection(e[t]);this.adaptiveCard.addItem(n)}}if(null!=t[this.constants.PotentialActionProperty]){const e=this.parseActionSet(t[this.constants.PotentialActionProperty]);this.adaptiveCard.addItem(e)}return this.theme.allowAutoInvokeAction&&null!=t[this.constants.AutoInvokeAction]&&(this.adaptiveCard.autoInvokeAction=this.parseHttpAction(t[this.constants.AutoInvokeAction]),this.adaptiveCard.autoInvokeAction.potentialAction=t[this.constants.AutoInvokeAction],this.adaptiveCard.autoInvokeAction.isAutoInvokeAction=!0),this.theme.allowAutoInvokeAction&&null!=t[this.constants.AutoInvokeOptions]&&(this.adaptiveCard.autoInvokeOptions=t[this.constants.AutoInvokeOptions]),this.adaptiveCard}parseSection(t){const e=new AdaptiveCards.Container;let n=!0;if(!1===t[this.constants.MarkdownProperty]&&(n=!1),"boolean"==typeof t[this.constants.StartGroupProperty]&&t[this.constants.StartGroupProperty]?(e.separator=!0,e.spacing=AdaptiveCards.Spacing.Large):e.spacing=AdaptiveCards.Spacing.Medium,null!=t[this.constants.TitleProperty]){const n=new AdaptiveCards.TextBlock;n.text=t[this.constants.TitleProperty],n.size=AdaptiveCards.TextSize.Medium,n.wrap=!0,e.addItem(n)}if(e.style="emphasis"==t[this.constants.StyleProperty]?AdaptiveCards.ContainerStyle.Emphasis:AdaptiveCards.ContainerStyle.Default,null!=t[this.constants.ActivityTitleProperty]||null!=t[this.constants.ActivitySubtitleProperty]||null!=t[this.constants.ActivityTextProperty]||null!=t[this.constants.ActivityImageProperty]){const n=new AdaptiveCards.ColumnSet;let i;if(null!=t[this.constants.ActivityImageProperty]&&""!=t[this.constants.ActivityImageProperty]){i=new AdaptiveCards.Column;const e=new AdaptiveCards.Image;this.adaptiveCard.imagesCount++,e.size=t[this.constants.SizeProperty]?t[this.constants.SizeProperty]:AdaptiveCards.Size.Small,t[this.constants.ActivityImageTypeProperty]&&"article"===t[this.constants.ActivityImageTypeProperty]?(e.style=AdaptiveCards.ImageStyle.Default,e.size=AdaptiveCards.Size.Medium,i.width=new AdaptiveCards.SizeAndUnit(80,AdaptiveCards.SizeUnit.Pixel)):e.style=t[this.constants.ActivityImageStyleProperty]?t[this.constants.ActivityImageStyleProperty]:AdaptiveCards.ImageStyle.Person,e.url=this.UtilsClass.getImageProxyUrl(t[this.constants.ActivityImageProperty],this.clientManagerInstance.supportImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.getImageProxyUrl()),e.url=this.UtilsClass.getAttachmentImageProxyUrl(t[this.constants.ActivityImageProperty],this.clientManagerInstance.supportAttachmentImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.imageAttachmentProxyUrl),i.addItem(e),n.addColumn(i)}if(i=new AdaptiveCards.Column,null!=t[this.constants.ActivityTitleProperty]){const e=new AdaptiveCards.TextBlock;e.text=t[this.constants.ActivityTitleProperty],e.wrap=!0,e.spacing=AdaptiveCards.Spacing.None,i.addItem(e)}if(null!=t[this.constants.ActivitySubtitleProperty]){const e=new AdaptiveCards.TextBlock;e.text=t[this.constants.ActivitySubtitleProperty],e.weight=AdaptiveCards.TextWeight.Lighter,e.isSubtle=!0,e.wrap=!0,e.spacing=AdaptiveCards.Spacing.None,i.addItem(e)}if(null!=t[this.constants.ActivityTextProperty]){const e=new AdaptiveCards.TextBlock;e.text=t[this.constants.ActivityTextProperty],e.wrap=!0,e.spacing=AdaptiveCards.Spacing.None,i.addItem(e)}n.addColumn(i),e.addItem(n)}if(this.theme.allowHeroImage&&null!=t[this.constants.HeroImageProperty]){var i=this.parseImage(t[this.constants.HeroImageProperty]);i.size=AdaptiveCards.Size.Auto,e.addItem(i)}if(null!=t[this.constants.TextProperty]){const n=new AdaptiveCards.TextBlock;n.text=t[this.constants.TextProperty],n.wrap=!0,e.addItem(n)}if(this.theme.allowFacts&&null!=t[this.constants.FactsProperty]){const n=this.parseFactSet(t[this.constants.FactsProperty]);e.addItem(n)}if(this.theme.allowImages&&null!=t[this.constants.ImagesProperty]){const n=this.parseImageSet(t[this.constants.ImagesProperty]);e.addItem(n)}if(null!=t[this.constants.PotentialActionProperty]){const n=this.parseActionSet(t[this.constants.PotentialActionProperty]);e.addItem(n)}return e}parseActionSet(t){const e=new AdaptiveCards.ActionSet;e.spacing=AdaptiveCards.Spacing.Medium;const n=t;1==n.length&&n[0][this.constants.TypeProperty]===this.constants.ActionCardAction?e.spacing=AdaptiveCards.Spacing.Default:e.spacing=AdaptiveCards.Spacing.Small;for(let t=0;t<n.length;t++){const i=n[t];let r=null;switch(i[this.constants.TypeProperty].toLowerCase()){case this.constants.OpenUriAction:r=this.parseOpenUrlAction(i);break;case this.constants.ViewAction:r=this.parseViewAction(i);break;case this.constants.HttpPostAction:r=this.parseHttpAction(i);break;case this.constants.ActionCardAction:this.theme.allowActionCard&&(r=this.parseShowCardAction(i));break;case this.constants.InvokeAddinCommandAction:r=this.parseInvokeAddinCommandAction(i);break;case this.constants.DisplayAppointmentFormAction:r=this.parseDisplayAppointmentFormAction(i);break;case this.constants.DisplayMessageFormAction:r=this.parseDisplayMessageFormAction(i)}r&&(r.potentialAction=i,r.isAutoInvokeAction=!1,e.addAction(r))}return e}parseOpenUrlAction(t){const e=new AdaptiveCards.OpenUrlAction;return e.title=t[this.constants.NameProperty],e.id=t[this.constants.IdProperty],e.isPrimary=t[this.constants.IsPrimaryAction]||!1,null!=t[this.constants.TargetsProperty]&&(e.url=this.getClientSpecificUri(t[this.constants.TargetsProperty])),e}parseViewAction(t){const e=new AdaptiveCards.OpenUrlAction;return e.title=t[this.constants.NameProperty],e.id=t[this.constants.IdProperty],e.isPrimary=t[this.constants.IsPrimaryAction]||!1,null!=t[this.constants.TargetProperty]&&(e.url=this.getClientSpecificUri(t[this.constants.TargetProperty])),e}parseHttpAction(t){const e=this.clientManagerInstance.getElementInstance(this.constants.HttpAction);return this.adaptiveCard.isHttpPostActionAvailable=!0,e.parseMessageCardAction(t),e}parseShowCardAction(t){const e=new AdaptiveCards.ShowCardAction;e.id=t[this.constants.IdProperty],e.title=t[this.constants.NameProperty],e.isPrimary=t[this.constants.IsPrimaryAction]||!1;const n=t[this.constants.InputsProperty];if(n)for(let t=0;t<n.length;t++){const i=n[t];let r=null;switch(i[this.constants.TypeProperty]?i[this.constants.TypeProperty].toLowerCase():""){case this.constants.TextInput:r=this.parseTextInput(i);break;case this.constants.DateInput:r=this.parseDateInput(i);break;case this.constants.MultiChoiceInput:r=this.parseChoiceSetInput(i)}r&&e.card.addItem(r)}const i=t[this.constants.ActionsProperty];return i&&e.card.addItem(this.parseActionSet(i)),e}parseInvokeAddinCommandAction(t){const e=this.clientManagerInstance.getElementInstance(this.constants.InvokeAddinCommandAction);return e.title=t[this.constants.NameProperty],e.addInId=t[this.constants.AddInId],e.desktopCommandId=t[this.constants.DesktopCommandId],e.initializationContext=t[this.constants.InitializationContext],e}parseDisplayAppointmentFormAction(t){const e=this.clientManagerInstance.getElementInstance(this.constants.DisplayAppointmentFormAction);return e.itemId=t[this.constants.itemId],e.id=t[this.constants.IdProperty],e.title=t[this.constants.NameProperty],e}parseDisplayMessageFormAction(t){const e=this.clientManagerInstance.getElementInstance(this.constants.DisplayMessageFormAction);return e.itemId=t[this.constants.itemId],e.id=t[this.constants.IdProperty],e.title=t[this.constants.NameProperty],e}parseTextInput(t){var e=new AdaptiveCards.TextInput;return this.parseInput(e,t),e.isMultiline=t[this.constants.IsMultilineProperty],e.maxLength=t[this.constants.MaxLengthProperty],e}parseDateInput(t){var e=this.clientManagerInstance.getElementInstance(this.constants.DateInput);return this.parseInput(e,t),e.includeTime=!1,t[this.constants.IncludeTimeProperty]&&(e.includeTime=!0),e}parseChoiceSetInput(t){var e=new AdaptiveCards.ChoiceSetInput;this.parseInput(e,t);var n=t[this.constants.ChoicesProperty];if(e.choiceList=n,n)for(var i=0;i<n.length;i++){var r=new AdaptiveCards.Choice;r.display=n[i][this.constants.DisplayProperty],r.title=n[i][this.constants.DisplayProperty],r.value=n[i][this.constants.ValueProperty],e.choices.push(r)}return e.isMultiSelect=t[this.constants.IsMultiSelectProperty],e.isCompact=!(t[this.constants.StyleProperty]===this.constants.Expanded),e}parseInput(t,e){t.id=e[this.constants.InputIdProperty],t.defaultValue=e[this.constants.ValueProperty],t.placeholder=e[this.constants.TitleProperty],t.isRequired=e[this.constants.IsRequiredProperty]||!1}parseImage(t,e=AdaptiveCards.Size.Medium,n=AdaptiveCards.ImageStyle.Default){const i=new AdaptiveCards.Image;return this.adaptiveCard.imagesCount++,i.url=this.UtilsClass.getImageProxyUrl(t[this.constants.ImageProperty],this.clientManagerInstance.supportImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.getImageProxyUrl()),i.url=this.UtilsClass.getAttachmentImageProxyUrl(t[this.constants.ImageProperty],this.clientManagerInstance.supportAttachmentImageProxy,this.clientManagerInstance.imageAttachmentBaseUrl,this.clientManagerInstance.imageAttachmentProxyUrl),i.size=t[this.constants.SizeProperty]?t[this.constants.SizeProperty]:e,i}parseImageSet(t){const e=new AdaptiveCards.ImageSet,n=t;for(let t=0;t<n.length;t++){const i=parseImage(n[t],AdaptiveCards.Size.Large);e.addImage(i)}return e}parseFactSet(t){const e=new AdaptiveCards.FactSet,n=t;for(let t=0;t<n.length;t++){const i=new AdaptiveCards.Fact;i.name=n[t][this.constants.NameProperty],i.value=n[t][this.constants.ValueProperty],e.facts.push(i)}return e}getThemeByStyle(t){for(var e=0;e<this.themes.length;e++)if(this.themes[e].style==t)return this.themes[e];for(e=0;e<this.themes.length;e++)if(this.themes[e].style==this.constants.DefaultStyle)return this.themes[e]}getClientSpecificUri(t){for(var e=0;e<t.length;e++)if(t[e].os==this.theme.client)return t[e].uri;for(e=0;e<t.length;e++)if(t[e].os==this.constants.DefaultStyle)return t[e].uri}applyMessageCardStyling(t,e){t.style.borderWidth="1px 1px 1px 3px",t.style.borderStyle="solid",e.themeColor?t.style.borderLeftColor=this.normalizeHexColor(e.themeColor):(t.style.borderLeftColor="#eeeeee",t.style.borderLeftWidth="1px"),t.style.borderTopColor="#eeeeee",t.style.borderRightColor="#eeeeee",t.style.borderBottomColor="#eeeeee"}normalizeHexColor(t){return"#"+t.replace(/[^0-9A-F]/gi,"")}}e.MessageCardConverter=i}]);